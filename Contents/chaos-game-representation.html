
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chaos Game Representation &#8212; Computational Discovery on Jupyter</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.jpg"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Bare Minimum about Floating-Point" href="../Appendix/floating-point.html" />
    <link rel="prev" title="Mandelbrot Polynomials and Matrices" href="mandelbrot.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Discovery on Jupyter</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to Computational Discovery on Jupyter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preamble.html">
   Preamble
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="continued-fractions.html">
   Continued Fractions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rootfinding.html">
   Rootfinding, Newton’s Method, and Dynamical Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fractals-and-julia-sets.html">
   Fractals and Julia Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bohemian-matrices.html">
   Bounded Height Matrices of Integers (Bohemian Matrices)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mandelbrot.html">
   Mandelbrot Polynomials and Matrices
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chaos Game Representation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/floating-point.html">
   The Bare Minimum about Floating-Point
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/binomials-factorials-combinatorics.html">
   Binomials, Factorials, and other Combinatorial Things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/complex-numbers.html">
   Complex Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/symbolic-computation.html">
   Symbolic Computation: The Pitfalls
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Continued%20Fraction%20Exercises.html">
   Solutions to Continued Fractions Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20the%20Rootfinding%20Chapter%20Exercises.html">
   Solutions to the Rootfinding Chapter Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20the%20Julia%20Set%20Exercises.html">
   Solutions to the Julia Set Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Exercises%20%28not%20Activities%29%20in%20the%20Bohemian%20Unit.html">
   Solutions to Exercises (not Activities) in the Bohemian Unit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Mandelbrot%20Exercises.html">
   Solutions to Mandelbrot Polynomials and Matrices Exercises
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Back Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about.html">
   About the authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Contents/chaos-game-representation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Computational-Discovery-on-Jupyter/Computational-Discovery-on-Jupyter"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-fractals-using-iterated-function-systems-ifs">
   Creating Fractals using Iterated Function Systems (IFS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#affine-transformation-in-the-euclidean-plane">
     Affine Transformation in the Euclidean Plane
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterated-function-system">
     Iterated Function System
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chaos-game">
   Chaos Game
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalization-of-cgr">
     Generalization of CGR
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#different-polygons">
       Different Polygons
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dividing-rate">
       Dividing Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sec-generalization">
       Generalization of CGR
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cgr-of-biological-sequences">
   CGR of Biological Sequences
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nucleotide-sequences">
     Nucleotide Sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#map-of-life">
     Map of Life
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#protein-visualization">
     Protein Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cgr-of-mathematical-sequences">
   CGR of Mathematical Sequences
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#digits-of-pi">
     Digits of Pi
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fibonacci-sequence">
     Fibonacci Sequence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prime-numbers">
     Prime Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partial-quotients-of-continued-fractions">
     Partial Quotients of Continued Fractions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-vs-pseudorandom">
   Random vs Pseudorandom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concluding-remarks">
   Concluding Remarks
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chaos Game Representation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-fractals-using-iterated-function-systems-ifs">
   Creating Fractals using Iterated Function Systems (IFS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#affine-transformation-in-the-euclidean-plane">
     Affine Transformation in the Euclidean Plane
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterated-function-system">
     Iterated Function System
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chaos-game">
   Chaos Game
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalization-of-cgr">
     Generalization of CGR
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#different-polygons">
       Different Polygons
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dividing-rate">
       Dividing Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sec-generalization">
       Generalization of CGR
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cgr-of-biological-sequences">
   CGR of Biological Sequences
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nucleotide-sequences">
     Nucleotide Sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#map-of-life">
     Map of Life
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#protein-visualization">
     Protein Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cgr-of-mathematical-sequences">
   CGR of Mathematical Sequences
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#digits-of-pi">
     Digits of Pi
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fibonacci-sequence">
     Fibonacci Sequence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prime-numbers">
     Prime Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partial-quotients-of-continued-fractions">
     Partial Quotients of Continued Fractions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-vs-pseudorandom">
   Random vs Pseudorandom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concluding-remarks">
   Concluding Remarks
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="chaos-game-representation">
<h1>Chaos Game Representation<a class="headerlink" href="#chaos-game-representation" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run this code block before executing the rest of the notebook</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="kn">import</span> <span class="n">continued_fraction_iterator</span>
<span class="kn">import</span> <span class="nn">skimage.io</span>
<span class="kn">from</span> <span class="nn">skimage.metrics</span> <span class="kn">import</span> <span class="n">structural_similarity</span> <span class="k">as</span> <span class="n">ssim</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>A heavy warning used to be given [by lecturers] that pictures are not rigorous; this has never had its bluff called and has permanently frightened its victims into playing for safety. Some pictures, of course, are not rigorous, but I should say most are (and I use them whenever possible myself).</p>
<p class="attribution">—<a class="reference external" href="https://mathshistory.st-andrews.ac.uk/Biographies/Littlewood/">J.E. Littlewood</a>,  <span id="id1">[<a class="reference internal" href="../references.html#id11">Littlewood, 1986</a>]</span>(p. 53) </p>
</div></blockquote>
<p>Finding hidden patterns in long sequences can be both difficult and valuable. Representing these sequences in a visual way can often help. The human brain is very adept at detecting patterns visually. Indeed, sometimes <em>too</em> adept: when humans detect spurious patterns that <em>aren’t</em> really there, it’s called <em>pareidolia</em>. That human tendency is what originally provoked the “heavy warning” against pictures that Littlewood complained about above. Nonetheless, pictures can help a lot, to generate conjectures, and sometimes even indicate a path towards a proof, even if sometimes “only” an experimental proof using comparison with data.</p>
<p>The so-called chaos game representation (CGR) of a sequence of integers is a particularly useful technique for pattern detection, which visualizes a one-dimensional sequence in a two-dimensional space. The CGR is presented as a scatter plot, most frequently on a square in which each corner represents an element that appears in the sequence. The results of these CGRs can look like fractals, but even so can be visually recognizable and distinguishable from each other. Interestingly, the distinguishing characteristics can sometimes be made <em>quantitative</em>, with a good notion of “distance between images.” This is an indirect way of constructing an equivalent notion of “distance between sequences,” but it turns out to be simpler to think about.</p>
<p>There is an excellent <a class="reference external" href="https://youtu.be/5nuYD2M2AX8">video by Robin Truax on CGR and Sierpinksi’s triangle</a>; worth watching now, or you can save it for later.  Now back to our unit.</p>
<p>Many applications, such as analysis of DNA sequences <span id="id2">[<a class="reference internal" href="../references.html#id24">Goldman, 1993</a>, <a class="reference internal" href="../references.html#id27">Jeffrey, 1990</a>, <a class="reference internal" href="../references.html#id28">Jeffrey, 1992</a>, <a class="reference internal" href="../references.html#id30">Karamichalis <em>et al.</em>, 2015</a>]</span> and protein structure <span id="id3">[<a class="reference internal" href="../references.html#id15">Basu <em>et al.</em>, 1997</a>, <a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span>, have shown the usefulness of CGR and the notion of “distance between images”; we will discuss these applications briefly in <a class="reference internal" href="#sec-dna"><span class="std std-ref">CGR of Biological Sequences</span></a>. Before that, in <a class="reference internal" href="#sec-ifs"><span class="std std-ref">Creating Fractals using Iterated Function Systems (IFS)</span></a>, we will look at a random iteration algorithm for creating fractals. In <a class="reference internal" href="#sec-math"><span class="std std-ref">CGR of Mathematical Sequences</span></a>, we will apply CGR to simple abstract mathematical sequences, including the digits of <span class="math notranslate nohighlight">\(\pi\)</span> and the partial quotients of continued fractions. Additionally, we will look at certain “distances between images” that are produced. Finally, we will explain how some of the patterns arise, and what these depictions can indicate to us, or sometimes even tell us rigorously, about the sequences.</p>
<p>One important pedagogical purpose of this module is to provoke a discussion about randomness, or what it means to be random. In this paper, we at first use the word “random” very loosely, on purpose.  Indeed, we will use several words loosely, such as “fractal” and “attractor” or “attracting set”. We promise to provide references at the end that will provide more careful definitions, and tighten up the discussion.</p>
<blockquote class="epigraph">
<div><p>What is probability? I asked myself this question many years ago, and found that various authors gave different answers. I found that there were several main schools of thought with many variations.</p>
<p class="attribution">—<a class="reference external" href="http://mathshistory.st-andrews.ac.uk/Biographies/Hamming.html">Richard W. Hamming</a>, <span id="id4">[<a class="reference internal" href="../references.html#id25">Hamming, 1991</a>]</span></p>
</div></blockquote>
<div class="figure align-default" id="cgr-globin">
<a class="reference internal image-reference" href="../_images/HUMHBB_crop.png"><img alt="../_images/HUMHBB_crop.png" src="../_images/HUMHBB_crop.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">DNA of human beta globin region on chromosome 11 (HUMHBB)—73308 bps</span><a class="headerlink" href="#cgr-globin" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="creating-fractals-using-iterated-function-systems-ifs">
<span id="sec-ifs"></span><h2>Creating Fractals using Iterated Function Systems (IFS)<a class="headerlink" href="#creating-fractals-using-iterated-function-systems-ifs" title="Permalink to this headline">¶</a></h2>
<p>One random iteration algorithm for creating pictures of fractals uses the fixed attracting set of an <em>iterated function system</em> (IFS). Before defining IFS, we will first define some necessary preliminaries.</p>
<div class="section" id="affine-transformation-in-the-euclidean-plane">
<h3>Affine Transformation in the Euclidean Plane<a class="headerlink" href="#affine-transformation-in-the-euclidean-plane" title="Permalink to this headline">¶</a></h3>
<p>We write a two dimensional <em>affine</em> transformation in the Euclidean plane <span class="math notranslate nohighlight">\(w: \mathbb{R}^{2} \to \mathbb{R}^{2}\)</span> in the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	w(x_{1}, x_{2}) = \left(ax_{1} + bx_{2} + e, cx_{1} + dx_{2} + f \right)
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(e\)</span>, and <span class="math notranslate nohighlight">\(f\)</span> are real numbers <span id="id5">[<a class="reference internal" href="../references.html#id14">Barnsley, 2014</a>]</span>. We will use the following more compact notation:</p>
<div class="math notranslate nohighlight" id="equation-eqn-ifs">
<span class="eqno">(69)<a class="headerlink" href="#equation-eqn-ifs" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align}
	w(x) &amp;= 
	w
	\begin{pmatrix}
		x_{1} \\
		x_{2}
	\end{pmatrix}
	=
	\begin{bmatrix}
		a &amp; b \\
		c &amp; d
	\end{bmatrix}
	\begin{bmatrix}
		x_{1} \\
		x_{2}
	\end{bmatrix}
	+
	\begin{bmatrix}
		e \\
		f
	\end{bmatrix} \nonumber \\ 
	&amp;= Ax + t .
	\label{eqn:ifs} 
\end{align}
\end{split}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(2 \times 2\)</span> real matrix and can always be written in the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
	\begin{bmatrix}
		a &amp; b \\
		c &amp; d
	\end{bmatrix}
	=
	\begin{bmatrix}
		r_{1}\cos\theta_{1} &amp; -r_{2}\sin\theta_{2} \\
		r_{1}\sin\theta_{1} &amp; \phantom{-}r_{2}\cos\theta_{2}
	\end{bmatrix} ,
	\label{eqn:tmatrix}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\left(r_{1}, \theta_{1}\right)\)</span> are the polar coordinates of the point <span class="math notranslate nohighlight">\(\left(a, c\right)\)</span> and <span class="math notranslate nohighlight">\(\left(r_{2}, \left(\theta_{2} + \frac{\pi}{2}\right)\right)\)</span> are the polar coordinates of the point <span class="math notranslate nohighlight">\(\left(b, d\right)\)</span>. An example of a <em>linear</em> transformation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\begin{bmatrix}
		x_{1} \\
		x_{2}
	\end{bmatrix}
	\to
	A
	\begin{bmatrix}
		x_{1} \\
		x_{2}
	\end{bmatrix}
\end{equation*}\]</div>
<p>in <span class="math notranslate nohighlight">\(\mathbb{R}^{2}\)</span> is shown in in the following figure. We can see from this figure that the original shape remains as a parallelogram, but now has changed in size and in rotation. This is what we mean by <em>linear</em> transformation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)],</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)]])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Affine Transformation Example&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_6_0.png" src="../_images/chaos-game-representation_6_0.png" />
</div>
</div>
</div>
<div class="section" id="iterated-function-system">
<h3>Iterated Function System<a class="headerlink" href="#iterated-function-system" title="Permalink to this headline">¶</a></h3>
<p>An <em>iterated function system</em> (IFS)<a class="footnote-reference brackets" href="#id64" id="id6">1</a> is a finite set of contraction mappings on a metric space.  These can be used to create pictures of fractals. These pictures essentially show what is called the attractor of the IFS. We will be defining what an attractor is in <a class="reference internal" href="#sec-chaos"><span class="std std-ref">Chaos Game</span></a>. In this paper, we will only be looking at the form where each contraction mapping is an affine transformation on the metric space <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>.</p>
<p>We will illustrate the algorithms for an IFS as an example. Consider the following maps:</p>
<div class="math notranslate nohighlight" id="equation-eqn-sierpinski">
<span class="eqno">(70)<a class="headerlink" href="#equation-eqn-sierpinski" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align}
	w_1(x, y) &amp;=
	\left[
		\begin{array}{cc}
			\frac{1}{2} &amp; 0 \\
			0 &amp; \frac{1}{2}
		\end{array}
	\right]
	\left[
		\begin{array}{c}
			x \\
			y
		\end{array}
	\right] 
	+
	\left[
		\begin{array}{c}
			0 \\
			0
		\end{array}
	\right] , \nonumber \\
	w_2(x, y) &amp;=
	\left[
		\begin{array}{cc}
			\frac{1}{2} &amp; 0 \\
			0 &amp; \frac{1}{2}
		\end{array}
	\right]
	\left[
		\begin{array}{c}
			x \\
			y
		\end{array}
	\right]
	+
	\left[
		\begin{array}{c}
			0 \\
			\frac{1}{2}
		\end{array}
	\right] , \nonumber \\
	w_3(x, y) &amp;=
	\left[
		\begin{array}{cc}
			\frac{1}{2} &amp; 0 \\
			0 &amp; \frac{1}{2}
		\end{array}
	\right]
	\left[
		\begin{array}{c}
			x \\
			y
		\end{array}
	\right]
	+
	\left[
		\begin{array}{c}
			\frac{1}{2} \\
			\frac{1}{2}
		\end{array}
	\right] ,
	\label{eqn:sierpinski}
\end{align}
\end{split}\]</div>
<p>each with the <em>probability factor</em> of <span class="math notranslate nohighlight">\(\frac{1}{3}\)</span>. These values can also be displayed as a table, where the order of the coefficients <span class="math notranslate nohighlight">\(a\)</span> through <span class="math notranslate nohighlight">\(f\)</span> corresponds to the order presented in Equation <a class="reference internal" href="#equation-eqn-ifs">(69)</a> and <span class="math notranslate nohighlight">\(p\)</span> represents the probability factor. The corresponding table for Equation <a class="reference internal" href="#equation-eqn-sierpinski">(70)</a> can be found in <a class="reference internal" href="#ifs-sierpinski"><span class="std std-numref">Table 1</span></a>.</p>
<table class="table" id="ifs-sierpinski">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Table representing the IFS from the equation above</span><a class="headerlink" href="#ifs-sierpinski" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>w</p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>b</p></th>
<th class="head"><p>c</p></th>
<th class="head"><p>d</p></th>
<th class="head"><p>e</p></th>
<th class="head"><p>f</p></th>
<th class="head"><p>p</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{3}\)</span></p></td>
</tr>
</tbody>
</table>
<p>To create a fractal picture using IFS, we first choose a starting point <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>. We then <em>randomly</em> choose a map from our IFS and evaluate it at our starting point <span class="math notranslate nohighlight">\((x_0, y_0)\)</span> to get our next point <span class="math notranslate nohighlight">\((x_1, y_1)\)</span>. We do this again many times (determined by the user) until we see a pattern. The Python code shown below computes and plots 50000 points corresponding to the IFS from <a class="reference internal" href="#ifs-sierpinski"><span class="std std-numref">Table 1</span></a>. To choose which map to use for each iteration, we used a uniform random number generator <code class="docutils literal notranslate"><span class="pre">random.randint</span></code> to choose a number between (and including) 0 and 2. Each value corresponds to a map in our IFS. It is clear that the resulting figure shows a fractal, which appears to be<a class="footnote-reference brackets" href="#id66" id="id7">2</a> the Sierpinski triangle <span id="id8">[<a class="reference internal" href="../references.html#id14">Barnsley, 2014</a>, <a class="reference internal" href="../references.html#id21">Feldman, 2012</a>]</span>, where its three vertices are located at <span class="math notranslate nohighlight">\((0, 0)\)</span>, <span class="math notranslate nohighlight">\((0, 1)\)</span> and <span class="math notranslate nohighlight">\((1, 1)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">rseq</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">rseq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">rseq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_10_0.png" src="../_images/chaos-game-representation_10_0.png" />
</div>
</div>
<p>Iterated function systems can be quite versatile; a set of several attractors can be used to create different shapes and even can resemble real-life objects. An example of this is Barnsley’s fern, which resembles the Black Spleenwort <span id="id9">[<a class="reference internal" href="../references.html#id14">Barnsley, 2014</a>]</span> (see <a class="reference internal" href="#black-spleenwort"><span class="std std-numref">Fig. 9</span></a>). The map is displayed in the following table:</p>
<table class="table">
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>w</p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>b</p></th>
<th class="head"><p>c</p></th>
<th class="head"><p>d</p></th>
<th class="head"><p>e</p></th>
<th class="head"><p>f</p></th>
<th class="head"><p>p</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
<td><p>0.16</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
<td><p>0.01</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>0.85</p></td>
<td><p>0.04</p></td>
<td><p>-0.04</p></td>
<td><p>0.85</p></td>
<td><p>0.00</p></td>
<td><p>1.60</p></td>
<td><p>0.85</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>0.20</p></td>
<td><p>-0.26</p></td>
<td><p>0.23</p></td>
<td><p>0.22</p></td>
<td><p>0.00</p></td>
<td><p>1.60</p></td>
<td><p>0.07</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>-0.15</p></td>
<td><p>0.28</p></td>
<td><p>0.26</p></td>
<td><p>0.24</p></td>
<td><p>0.00</p></td>
<td><p>0.44</p></td>
<td><p>0.07</p></td>
</tr>
</tbody>
</table>
<p>The plot produced by this IFS is shown in below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">50000</span>

<span class="n">fern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mf">0.86</span><span class="p">:</span>
        <span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mf">0.93</span><span class="p">:</span>
        <span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">]])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fern</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fern</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">fern</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;g.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_14_0.png" src="../_images/chaos-game-representation_14_0.png" />
</div>
</div>
<div class="figure align-default" id="black-spleenwort">
<a class="reference internal image-reference" href="../_images/black_spleenwort.jpg"><img alt="../_images/black_spleenwort.jpg" src="../_images/black_spleenwort.jpg" style="height: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">Comparison of Barnsley’s Fern to the black spleenwort, which is what the IFS was based on.</span><a class="headerlink" href="#black-spleenwort" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="chaos-game">
<span id="sec-chaos"></span><h2>Chaos Game<a class="headerlink" href="#chaos-game" title="Permalink to this headline">¶</a></h2>
<p>CGR is based on a technique from chaotic dynamics called the “chaos game”<a class="footnote-reference brackets" href="#id68" id="id10">3</a>, popularized by Barnsley <span id="id11">[<a class="reference internal" href="../references.html#id14">Barnsley, 2014</a>]</span> in 1988. The chaos game is an algorithm which allows one to produce pictures of fractal structures <span id="id12">[<a class="reference internal" href="../references.html#id27">Jeffrey, 1990</a>]</span>. In its simplest form, this can be demonstrated with a piece of paper and pencil using the following steps (adapted from <span id="id13">[<a class="reference internal" href="../references.html#id27">Jeffrey, 1990</a>]</span>):</p>
<ol class="simple">
<li><p>On a piece of paper, draw three points spaced out across the page; they do not necessarily need to be spaced out evenly to form an equilateral triangle though they might be.  These will determine the “<em>gameboard</em>”, where the picture will ultimately lie.</p></li>
<li><p>Label one of the points with “1, 2”, the other point with “3, 4”, and the last point with “5, 6”.</p></li>
<li><p>Draw a point anywhere on the page: this will be the starting point.</p></li>
<li><p>Roll a six-sided die. Draw an imaginary line from the current dot towards to the point with the corresponding number, and put a dot half way on the line. This becomes the new “current dot”.</p></li>
<li><p>Repeat step 4 (until you get bored).</p></li>
</ol>
<p>Obviously, one would not want to plot a large number of points by hand<a class="footnote-reference brackets" href="#id69" id="id14">4</a>; instead, this can be done by computer; the code is shown below. For this algorithm, we assigned <span class="math notranslate nohighlight">\((0, 0)\)</span>, <span class="math notranslate nohighlight">\((0, 1)\)</span> and <span class="math notranslate nohighlight">\((1, 1)\)</span> as the vertices of the triangle; they each are labelled with the value <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(1\)</span>, and <span class="math notranslate nohighlight">\(2\)</span>, respectively. Instead of using a die to decide which vertex to choose, similarly to the above code, we use the built-in function <code class="docutils literal notranslate"><span class="pre">random.randint</span></code>, which picks from the set <span class="math notranslate nohighlight">\(\{0, 1, 2\}\)</span>.</p>
<p>To calculate the new point, we take the average between the previous point and the corresponding vertex. For example, if the first random number generated was <span class="math notranslate nohighlight">\(2\)</span>, then we would take the average between our initial point (0, 0) and the vertex that corresponds to <span class="math notranslate nohighlight">\(2\)</span>, which is in our case is <span class="math notranslate nohighlight">\((1, 1)\)</span>. Our new point would be <span class="math notranslate nohighlight">\((0.5, 0.5)\)</span>. We then would repeat this process until one decides to stop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">rseq</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">rseq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span> 
    <span class="k">elif</span> <span class="n">rseq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_17_0.png" src="../_images/chaos-game-representation_17_0.png" />
</div>
</div>
<p>One would expect that the outcome above would show that the dots would appear randomly across the gameboard; however, this is not the case: the figure shows the result of the chaos game if the game was played 50000 times. We can see that this figure shows a fractal-like pattern (such as one of a Sierpinski triangle), and looks almost (if not) identical to the figure which resulted from the IFS.</p>
<p>It is quite interesting that a sequence of random numbers could produce such a distinct pattern. Indeed, some bad <em>pseudorandom number generators</em> were identified as being bad precisely because they failed a similar-in-spirit visualization test <span id="id15">[<a class="reference internal" href="../references.html#id35">Knuth, 1997</a>]</span>. We will discuss this issue further in <a class="reference internal" href="#sec-random"><span class="std std-ref">Random vs Pseudorandom</span></a>. However, what has happened here is that the <em>randomness</em> of the sequence has translated into a <em>uniform</em> distribution <em>on the fractal</em>. So, really, here the gameboard is the fractal! We will return to this point in the next section.</p>
<p><a class="reference internal" href="#sierpinski-steps"><span class="std std-numref">Fig. 10</span></a> shows an example of the first five steps of the chaos game (overlaid on top of a CGR with 10000 points), which corresponds to the following values that were randomly generated: 2, 1, 0, 0, 2. Displaying the CGR in this manner can give us some insight as to why this particular chaos game with three vertices gives us such a striking fractal: we can see from the figure that each of the points from the first five steps is located at a vertex (in this case the right-angled one) of one of the many triangles within the fractal. A careful observer would notice that the triangle at which the point is located becomes smaller each iteration. This implies that within the next few iterations, the triangle associated with the computed point would be too small to be seen in this illustration. [Note: if we zoom into that microscopic level, the dots would look random. Indeed, the random dots are ultimately dense on the Sierpinski triangle.] This sequence of points generated by the chaos game is called the <em>orbit</em> of the seed and it is attracted to the Sierpinski triangle. For another description of why this chaos game creates the Sierpinski triangle, see <span id="id16">[<a class="reference internal" href="../references.html#id23">Fisher <em>et al.</em>, 2012</a>]</span>.</p>
<div class="figure align-default" id="sierpinski-steps">
<a class="reference internal image-reference" href="../_images/sierpinski_steps.png"><img alt="../_images/sierpinski_steps.png" src="../_images/sierpinski_steps.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 10 </span><span class="caption-text">First 5 steps of chaos game with three vertices. In this example, the first 5 random integers generated are 2, 1, 0, 0, 2.</span><a class="headerlink" href="#sierpinski-steps" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="generalization-of-cgr">
<h3>Generalization of CGR<a class="headerlink" href="#generalization-of-cgr" title="Permalink to this headline">¶</a></h3>
<p>We have already seen that a fractal pattern can appear when we follow the chaos game described above for a polygon with three vertices (triangle) using a random number generator, but we are not limited to only this. There are many variations for CGR, and some are more useful than others. In this section, we will look into what patterns arise when we perform CGR on different polygons, changing the placement of the <span class="math notranslate nohighlight">\(i\)</span>-th point relative to the <span class="math notranslate nohighlight">\((i-1)\)</span>-th and its corresponding vertex, and explore which of these could potentially be useful for some applications presented in <a class="reference internal" href="#sec-dna"><span class="std std-ref">CGR of Biological Sequences</span></a>.</p>
<div class="section" id="different-polygons">
<span id="sec-polygons"></span><h4>Different Polygons<a class="headerlink" href="#different-polygons" title="Permalink to this headline">¶</a></h4>
<p>The following figure shows the chaos game representation, where the <span class="math notranslate nohighlight">\(i\)</span>-th point is placed halfway between the <span class="math notranslate nohighlight">\((i-1)\)</span>-th point and the vertex corresponding to the <span class="math notranslate nohighlight">\(i\)</span>-th base, for various polygons, using a sequence of 50,000 uniformly generated (pseudo)random integers. As we can see below, when the CGR is a square, there is no apparent pattern: the chaos game produced a square uniformly (to the eye) filled with points. This particularly conforms to our intuition: a random sequence should <em>look</em> random.  The other polygons appear, in contrast, to exhibit some patterns. These patterns are due to several parts of their attractors overlapping<a class="footnote-reference brackets" href="#id70" id="id17">5</a>, or failing to overlap at all, indicated by the the uneven distribution of points (where points do appear); i.e. we can see some darker areas and some lighter areas and even gaps in the figures. Therefore, for this particular chaos game (in which we say that the <em>dividing rate</em> <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(0.5\)</span>—we will talk about this in <a class="reference internal" href="#sec-dividingrate"><span class="std std-ref">Dividing Rate</span></a>), the square is the best choice to visualize one-dimensional sequences. We will see in <a class="reference internal" href="#sec-generalization"><span class="std std-ref">Generalization of CGR</span></a> that we can use other polygons (we will be referring to them as <span class="math notranslate nohighlight">\(m\)</span>-gons) for CGR to uncover patterns in sequences not with 4 elements by using the appropriate dividing rate <span class="math notranslate nohighlight">\(r\)</span>: that is, instead of placing a point half-way to the target vertex, we will place it at some other position along the line, with <span class="math notranslate nohighlight">\(0 &lt; r &lt; 1\)</span>.  A proper choice of <span class="math notranslate nohighlight">\(r\)</span> will ensure that a random sequence will generate a uniform density of points, possibly on a fractal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">n_gon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">360</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">deg</span> <span class="o">=</span> <span class="n">deg</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">deg</span><span class="p">:</span>
        <span class="n">rad</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d</span><span class="o">/</span><span class="mi">360</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">cor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rad</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
        <span class="n">cor</span><span class="p">[:,</span> <span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
    <span class="n">cor</span><span class="p">[:,</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">cor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cor</span>

<span class="k">def</span> <span class="nf">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">shape_coord</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shape_coord</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">shape_coord</span><span class="p">[:,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">)])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">shape_coord</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">),</span> <span class="p">(</span><span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Chaos game of polygons with different number of vertices&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Square&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pentagon&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hexagon&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Heptagon&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Octagon&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">polyCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Nonagon&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_23_0.png" src="../_images/chaos-game-representation_23_0.png" />
</div>
</div>
</div>
<div class="section" id="dividing-rate">
<span id="sec-dividingrate"></span><h4>Dividing Rate<a class="headerlink" href="#dividing-rate" title="Permalink to this headline">¶</a></h4>
<p>In the previous subsection, we saw different patterns appear for different shapes. We saw that shapes with more than <span class="math notranslate nohighlight">\(4\)</span> vertices seemed to have several parts of the attractor overlapping, producing visibly nonuniform density (some areas were visibly darker than others). Here we will show that this attractor overlapping also happens when choosing a <em>small enough</em> dividing rate <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>To be explicit, the chaos game is not restricted to the “rule” in which the new point has to be placed halfway between the current point and the corresponding vertex as depicted in the previous examples. The new point can be placed anywhere within the line segment created by the two points of reference (or even outside, if you are willing to let the points land outside the convex hull of the vertices). The placement of the new point affects how the attractor of the CGR looks. We will see this in the following example. To quantify the placement of the point, we take the proportion of which the distance between the new point and current point is from the distance between the current point and the corresponding vertex. This is called the <em>dividing rate</em>, <span class="math notranslate nohighlight">\(r\)</span>. The new point <span class="math notranslate nohighlight">\(p_{i+1}\)</span> is thus <span class="math notranslate nohighlight">\(p_{i+1} = p_i + r(V-p_i)\)</span>. Therefore, when the new point is placed halfway between the current point and the vertex, the dividing rate is <span class="math notranslate nohighlight">\(r = 0.5\)</span>, and if the new point is placed closer to the location of the current point, then the dividing rate <span class="math notranslate nohighlight">\(r &lt; 0.5\)</span>, whereas if the point is closer to the vertex, then the dividing rate <span class="math notranslate nohighlight">\(r &gt; 0.5\)</span>.</p>
<p>To continue this discussion, let us vary <span class="math notranslate nohighlight">\(r\)</span> for the square-shaped CGR of a sequence of random integers. As we have seen in the previous subsection, the square-shaped CGR did not exhibit any fractal patterns when <span class="math notranslate nohighlight">\(r = 0.5\)</span>, so we wondered if we varied <span class="math notranslate nohighlight">\(r\)</span>, would this change? The following code gives the square CGRs for <span class="math notranslate nohighlight">\(r = 0.1, 0.25, 0.4, 0.6, 0.75,\)</span> and <span class="math notranslate nohighlight">\(0.9\)</span>. From these figures, we see how <span class="math notranslate nohighlight">\(r\)</span> affects the visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">shape_coord</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">shape_coord</span><span class="p">[:,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">rand</span><span class="p">)]</span> <span class="o">-</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">r</span>
    <span class="k">return</span><span class="p">(</span><span class="n">shape_coord</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">),</span> <span class="p">(</span><span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Illustration of different dividing rates on a square CGR&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.1&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.25&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.4&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.6&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.75&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">dividingRateCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = 0.9&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_26_0.png" src="../_images/chaos-game-representation_26_0.png" />
</div>
</div>
<p>For <span class="math notranslate nohighlight">\(r &lt; 0.5\)</span>, we can see that some patterns appear, especially those with a dividing rate close to <span class="math notranslate nohighlight">\(r = 0.5\)</span>. More importantly, we see a nonuniformity of distribution in the square.  In contrast, we can see for <span class="math notranslate nohighlight">\(r = 0.6\)</span> that the points fill the corners of the plot area, but they are unevenly-spaced (in comparison to what we have seen for <span class="math notranslate nohighlight">\(r = 0.5\)</span>). This suggests that when <span class="math notranslate nohighlight">\(r &lt; 0.5\)</span>, the attractors are overlapping, indicated by the darker regions of the plot due to the points being more densely packed, and that when <span class="math notranslate nohighlight">\(r&gt;0.5\)</span> the attractor lies on a fractal and is apparently uniformly distributed thereon. For <span class="math notranslate nohighlight">\(r\)</span> significantly less than <span class="math notranslate nohighlight">\(1/2\)</span>, we can see that the CGR becomes more circular with the points spaced more closely together. From this, it infers that as <span class="math notranslate nohighlight">\(r\)</span> decreases, more of the attractors overlap.</p>
<p>For <span class="math notranslate nohighlight">\(r &gt; 0.5\)</span>, we can see that a different pattern appears (compared to those with a dividing rate <span class="math notranslate nohighlight">\(r &lt; 0.5\)</span>). The patterns shown for the CGRs with a dividing ratio <span class="math notranslate nohighlight">\(r &gt; 0.5\)</span> visibly resemble each other. The <span class="math notranslate nohighlight">\(r = 0.9\)</span> case looks like a smaller version of the <span class="math notranslate nohighlight">\(r = 0.75\)</span> case, which similarly, looks like a sparser version of the <span class="math notranslate nohighlight">\(r = 0.6\)</span> case. In contrast to the CGR with the dividing rate <span class="math notranslate nohighlight">\(r = 0.5\)</span>, we can see that the points are spread apart from each other. This can possibly indicate that the attractors do not overlap, and even do not touch each other. Although this can be used to distinguish any nonrandomness, it would be much more difficult to see with the human eye than using the dividing rate <span class="math notranslate nohighlight">\(r = 0.5\)</span>.</p>
<p>For applications which need a different number of vertices than <span class="math notranslate nohighlight">\(m=4\)</span>, it turns out to be optimal to find a dividing rate <span class="math notranslate nohighlight">\(r\)</span> for different polygons that can offer maximum packing of nested, non-overlapping attractors, in order to help find a pattern in a given sequence. In the next subsection, we look at this optimal value of <span class="math notranslate nohighlight">\(r\)</span> as reported in the literature.</p>
</div>
<div class="section" id="sec-generalization">
<span id="id18"></span><h4>Generalization of CGR<a class="headerlink" href="#sec-generalization" title="Permalink to this headline">¶</a></h4>
<p>In <span id="id19">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span>, Fiser et al. generalized CGR to be applicable for sequences of any number of elements <span class="math notranslate nohighlight">\(m &gt; 2\)</span>. There are many ways of generalizing CGR, some of which are highlighted in <span id="id20">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span>, but the generalization the authors of the earlier article chose was to use an <span class="math notranslate nohighlight">\(m\)</span>-sided polygon (which they refer to as an <span class="math notranslate nohighlight">\(m\)</span>-gon), where <span class="math notranslate nohighlight">\(m\)</span> was the number of elements in a sequence that should be represented <span id="id21">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span>. As we saw previously in <a class="reference internal" href="#sec-polygons"><span class="std std-ref">Different Polygons</span></a>, the attractors of the <span class="math notranslate nohighlight">\(m\)</span>-gons for when <span class="math notranslate nohighlight">\(m &gt; 4\)</span> and <span class="math notranslate nohighlight">\(r=0.5\)</span> overlapped as shown by the uneven distribution of the points. Because of this, the picture is ambiguous and is not as useful to serve as a way to identity patterns in sequences. To combat this, Fiser et al. introduced a formula to calculate the dividing rate for <span class="math notranslate nohighlight">\(m\)</span>-gons for different values of <span class="math notranslate nohighlight">\(m\)</span>: by putting each attractor piece inside a non-overlapping circle, they derived</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    r = \left(1 + \sin\left(\frac{\pi}{m}\right)\right)^{-1} .
\end{equation*}\]</div>
<p>Although the dividing rate calculated from this formula does prevent attractors from overlapping, Almeida and Vinga noticed in <span id="id22">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span> that the resulting attractors are not optimally packed. For example, for <span class="math notranslate nohighlight">\(m = 4\)</span>, the solution gives a dividing rate <span class="math notranslate nohighlight">\(r = 0.585786\)</span> instead of <span class="math notranslate nohighlight">\(r = 0.5\)</span>, which works perfectly well (and indeed is maybe better). In <span id="id23">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span>, the authors gave a more complicated formula for the dividing rate, which they say they derived by using basic trigonometry to pack polygons (instead of circles) into the outer <span class="math notranslate nohighlight">\(m\)</span>-gon.
We have simplified their formula considerably</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
r = 
\frac{\sin \! \left(\frac{(2  k -1)\pi}{m}\right)}{\sin \! \left(\frac{(2 k -1)\pi}{m}\right)+\sin \! \left(\frac{\pi}{m}\right)}
\end{equation*}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    k = \mathrm{round}\left(\frac{m+2}{4}\right) .
\end{equation*}\]</div>
<p>If we use <span class="math notranslate nohighlight">\(k= (m+2)/4\)</span> without rounding to an integer, this formula simplifies to the previous one. This fact was not noted in <span id="id24">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span>.
We note some special values: when <span class="math notranslate nohighlight">\(m=3\)</span> or <span class="math notranslate nohighlight">\(m=4\)</span>, this formula gives <span class="math notranslate nohighlight">\(r=0.5\)</span>.  When <span class="math notranslate nohighlight">\(m=5\)</span>, this formula gives <span class="math notranslate nohighlight">\(r = (\sqrt{5}-1)/2 = 0.618\ldots\)</span>. Various other <span class="math notranslate nohighlight">\(m\)</span> give algebraic values. When <span class="math notranslate nohighlight">\((m+2)/4\)</span> is half-way between integers, either choice of rounding for <span class="math notranslate nohighlight">\(k\)</span> gives the same <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>The following figure shows the generalized CGRs for various <span class="math notranslate nohighlight">\(m\)</span>-gons using the division formula from <span id="id25">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span> (left) and <span id="id26">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span> (right).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dividingRateFiser</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dividingRateAlmeida</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mf">2.</span><span class="p">)</span><span class="o">/</span><span class="mf">4.</span><span class="p">)</span>
    <span class="n">s_num</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))))</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))))))</span>
    <span class="n">s_den</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">s_num</span><span class="o">/</span><span class="n">s_den</span>

<span class="k">def</span> <span class="nf">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">divide_func</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">shape_coord</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shape_coord</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">divide_func</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">shape_coord</span><span class="p">[:,</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">rand</span><span class="p">)]</span> <span class="o">-</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">r</span>
    <span class="k">return</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">shape_coord</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">),</span> <span class="p">(</span><span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Graphical comparison of proposed CGR generalization (Fiser 1994 (left) vs. Almeida 2009 (right))&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateFiser</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateAlmeida</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateFiser</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateAlmeida</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateFiser</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">generalizedCGR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dividingRateAlmeida</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;r = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_30_0.png" src="../_images/chaos-game-representation_30_0.png" />
</div>
</div>
<p>In the next section, we will look at applications of CGR, mainly biological and mathematical. For the following examples, unless otherwise specified, assume that <span class="math notranslate nohighlight">\(r = 0.5\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="cgr-of-biological-sequences">
<span id="sec-dna"></span><h2>CGR of Biological Sequences<a class="headerlink" href="#cgr-of-biological-sequences" title="Permalink to this headline">¶</a></h2>
<p>The chaos game representation has been applied to biological areas. In this section, we will look at how the chaos game has been applied the DNA and protein (amino acids) sequencing and visualizations. We also will give a brief overview of the <em>Map of Life</em>, an extension of the visualization of DNA sequences. The Map of Life shows potential in allowing researchers to quantitatively classify species that was once unclear in its taxonomy.</p>
<div class="section" id="nucleotide-sequences">
<h3>Nucleotide Sequences<a class="headerlink" href="#nucleotide-sequences" title="Permalink to this headline">¶</a></h3>
<p>H. J. Jeffrey was the first to propose using the chaos game representation as a novel way of visualizing nucleotide sequences. This revealed previously unknown patterns in certain proteins <span id="id27">[<a class="reference internal" href="../references.html#id27">Jeffrey, 1990</a>, <a class="reference internal" href="../references.html#id28">Jeffrey, 1992</a>]</span>. The genetic sequence is made up of four bases: adenine (A), guanine (G), cytosine (C), and either thymine (T) or uracil (U) for DNA or RNA, respectively. Using a square-shaped CGR, we label the four corners with the name of each base. In this paper, A is in the bottom-left corner, C in the top-left, G in the top-right, and U/T in the bottom right. Rather than use a random number generator to determine which map to use for each iteration as we did in <a class="reference internal" href="#sec-chaos"><span class="std std-ref">Chaos Game</span></a>, we follow the genetic sequence that we want to create a CGR for.</p>
<p>To demonstrate the chaos game for DNA sequences, let us walk through plotting the first five bases of the DNA sequence <a class="reference external" href="https://www.ncbi.nlm.nih.gov/nuccore/U01317.1?report=fasta">HUMHBB</a> (human beta globin region, chromosome 11), “GAATT”, shown in <a class="reference internal" href="#cgr-globin"><span class="std std-numref">Fig. 8</span></a>. We first mark the center as our initial point. The first base in the sequence is “G” so, we plot a point half way between our initial point and the “G” corner. The next base in the sequence is “A” so we plot a point half way between the point that we just plotted and the “A” corner. The following is the code to recreate the CGR.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_sequence</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">inputfile</span><span class="p">:</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">inputfile</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">inputfile</span><span class="p">))</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">seq</span>

<span class="k">def</span> <span class="nf">dna_cgr</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">dataPoints</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="n">corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>
            <span class="n">corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">corner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">corner</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">humhbb_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/HUMHBB.fasta&#39;</span><span class="p">)</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">humhbb_dna</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">),</span> <span class="p">(</span><span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;First five steps of producing CGR using HUMHBB Data&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Initial Point&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GA&#39;</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GAA&#39;</span><span class="p">)</span>

<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GAAT&#39;</span><span class="p">)</span>

<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GAATT&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_35_0.png" src="../_images/chaos-game-representation_35_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">humhbb_dna</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_36_0.png" src="../_images/chaos-game-representation_36_0.png" />
</div>
</div>
<p>The finished CGR is shown in <a class="reference internal" href="#cgr-globin"><span class="std std-numref">Fig. 8</span></a>, which certainly has an identifiable fractal pattern. The most prominent pattern is what is referred to as the “double scoop”, which actually appears in almost all vertebrate DNA sequences. This pattern is due to the fact that there is a comparative sparseness of guanine following cytosine in the gene sequence since CG dinucleotides are prone to methylation and subsequently mutation.</p>
<p>To fully understand the double scoop pattern, we must understand the biological meaning of the CGR. Each point plotted in the CGR corresponds to a base, and depending on where it is placed, we can trace back and figure out parts of the sequence we are examining <span id="id28">[<a class="reference internal" href="../references.html#id24">Goldman, 1993</a>]</span>. Figure <a class="reference internal" href="#cgr-quadrants"><span class="std std-numref">Fig. 11</span></a> shows the relationship corresponding area of the CGR and the DNA sequence. In reference to this figure, we can see that for any point that corresponds with base G, it will be located in the upper right quadrant of the CGR plot. To see what the previous base is, we can divide the quadrant into sub-quadrants (labeling them in the same order as the quadrants), and depending on where the point is, we can determine what the previous base of the sequence is. We can repeat this step again and again to find the order in which the bases appear in the sequence.  Figure <a class="reference internal" href="#cgr-no-cg"><span class="std std-numref">Fig. 12</span></a> shows a CGR square where all the CG quadrants are unfilled. We can see from this figure that even though it is not a real CGR (since we did not use a sequence to produce it), we still get the same double scoop pattern found in Figure <a class="reference internal" href="#cgr-globin"><span class="std std-numref">Fig. 8</span></a>. By identifying regions of the CGR square in this way, it is possible to identify features of DNA sequences that correspond to patterns of the CGR.</p>
<div class="figure align-default" id="cgr-quadrants">
<a class="reference internal image-reference" href="../_images/Generalized_CGR.png"><img alt="../_images/Generalized_CGR.png" src="../_images/Generalized_CGR.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 11 </span><span class="caption-text">Correspondence between DNA sequences and areas of the CGR of DNA sequences</span><a class="headerlink" href="#cgr-quadrants" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="cgr-no-cg">
<a class="reference internal image-reference" href="../_images/HUMHBB_CGR.png"><img alt="../_images/HUMHBB_CGR.png" src="../_images/HUMHBB_CGR.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 12 </span><span class="caption-text">Explanation of the double scoop pattern—plot of CGR square with all CG quadrants unfilled.</span><a class="headerlink" href="#cgr-no-cg" title="Permalink to this image">¶</a></p>
</div>
<p>The following shows other examples of CGRs for DNA sequences. We can see that the CGR of DNA sequence of human herpesvirus strain also exhibit the double scoop pattern that we have seen for HUMHBB. This agrees with what was mentioned earlier in that it is common to see the lack of C and G dinucleotides together within the human genome. The CGR of the DNA sequence of the chloroplast of quinoa plant, on the other hand, does not show a double scoop pattern. We can see from using the CGR of DNA sequences, we are able to distinguish between different species very easily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">herpesvirus_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/KF021605.fasta&#39;</span><span class="p">)</span>
<span class="n">herpesvirus_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">herpesvirus_dna</span><span class="p">)</span>

<span class="n">chloroplast_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/CM008430.fasta&#39;</span><span class="p">)</span>
<span class="n">chloroplast_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">chloroplast_dna</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;More example of CGRs of DNA sequences&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">herpesvirus_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">herpesvirus_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Human herpesvirus 5 strain TR, complete genome&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chloroplast_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">chloroplast_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chenopodium quinoa cultivar Real Blanca cholorplast, complete sequence&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_40_0.png" src="../_images/chaos-game-representation_40_0.png" />
</div>
</div>
</div>
<div class="section" id="map-of-life">
<h3>Map of Life<a class="headerlink" href="#map-of-life" title="Permalink to this headline">¶</a></h3>
<p>Taking DNA sequence visualization one step further, the authors of <span id="id29">[<a class="reference internal" href="../references.html#id32">Kari <em>et al.</em>, 2013</a>]</span> proposed a novel combination of methods to create <em>Molecular Distance Maps</em>. Molecular distance maps visually illustrate the quantitative relationships and patterns of proximities among the given genetic sequences and among the species they represent. To compute and visually display relationships between DNA sequences, the three techniques that were used include chaos game representation, structural dissimilarity index (DSSIM), and multi-dimensional scaling. In the paper <span id="id30">[<a class="reference internal" href="../references.html#id32">Kari <em>et al.</em>, 2013</a>]</span>, this method was applied to a variety of cases that have been historically controversial and was there demonstrated to have the potential for taxonomical clarification. In the following, we will discuss the methods used from this paper, more particularly the structural dissimilarity index and the multi-dimensional scaling as we have already looked into the chaos game representation for nucleotides.</p>
<p>To understand the structural dissimilarity index, we will first have to explain what the structural similarity index is. The structural similarity (SSIM) index is a method for measuring the similarity between two images based on the computation of three terms, namely luminance distortion, contrast distortion, and linear correlation <span id="id31">[<a class="reference internal" href="../references.html#id45">Wang <em>et al.</em>, 2004</a>]</span>. It was designed to perform similarly to the human visual system, which is highly adapted to extract structural information. The overall index is a multiplicative combination of the three terms:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\operatorname{SSIM}(x, y) = [l(x, y)]^\alpha\cdot[c(x, y)]^\beta\cdot[s(x, y)]^\gamma ,
\end{equation*}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	l(x, y) &amp;= \dfrac{2\mu_{x}\mu_{y}+C_1}{\mu_{x}^{2} + \mu_{y}^{2} + C_1} \\
	c(x, y) &amp;= \dfrac{2\sigma_{x}\sigma_{y}+C_{2}}{\sigma_{x}^{2} + \sigma_{y}^{2} + C_2} \\
	s(x, y) &amp;= \dfrac{\sigma_{xy} + C_{3}}{\sigma_{x}\sigma_{y} + C_{3}} ,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_{x}\)</span>, <span class="math notranslate nohighlight">\(\mu_{y}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{x}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{y}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{xy}\)</span> are the local means, standard deviations, and cross-covariance for images <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. <span class="math notranslate nohighlight">\(C_{1}\)</span>, <span class="math notranslate nohighlight">\(C_{2}\)</span>, and <span class="math notranslate nohighlight">\(C_{3}\)</span> are the regularization constants for the luminance, contrast, and structural terms, respectively. If <span class="math notranslate nohighlight">\(\alpha = \beta = \gamma = 1\)</span>, and <span class="math notranslate nohighlight">\(C_{3} = \frac{C_{2}}{2}\)</span>, the index simplifies to:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\operatorname{SSIM}(x, y) = \dfrac{(2\mu_{x}\mu_{y} + C_{1})(2\sigma_{xy} + C_{2})}{(\mu_{x}^{2} + \mu_{y}^{2} + C_{1})(\sigma_{x}^{2} + \sigma_{y}^{2} + C_{2})} .
\end{equation*}\]</div>
<p>The theoretical range of <span class="math notranslate nohighlight">\(\operatorname{SSIM}(x, y) \in [-1, 1]\)</span>, where the high value indicates high similarity. In <span id="id32">[<a class="reference internal" href="../references.html#id32">Kari <em>et al.</em>, 2013</a>]</span>, instead of calculating the overall SSIM, they computed the local SSIM value for each pixel in the image <span class="math notranslate nohighlight">\(x\)</span>. They refer to this as a distance matrix. The SSIM index can be computed in Python by using the function <code class="docutils literal notranslate"><span class="pre">structural_similarity</span></code> from the <code class="docutils literal notranslate"><span class="pre">skimage.metrics</span></code> library.</p>
<p>Now that we know how to compute the SSIM index, we are able to compute the structural dissimilarity (DSSIM) index:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\operatorname{DSSIM}(x, y) = 1 - \operatorname{SSIM}(x, y) ,
\end{equation*}\]</div>
<p>whose theoretical range is <span class="math notranslate nohighlight">\([0, 2]\)</span> with the distance being 0 between two identical images, and 2 if the two images are negatively correlated. An example of two images that are negatively correlated would be if one is completely white, while the other is completely black. Typically, the range that DSSIM falls with is <span class="math notranslate nohighlight">\([0, 1]\)</span>—the authors from <span id="id33">[<a class="reference internal" href="../references.html#id33">Kari <em>et al.</em>, 2015</a>]</span> noted that almost all (over 5 million) distances that found were between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, with only half a dozen exceptions of distances between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(1.0033\)</span>.</p>
<p>To demonstrate this, let us compare the “anatomically modern” human (Homo sapiens sapiens) mitochondrial DNA and the neanderthal (Homo sapiens neanderthalensis) mitochondrial DNA (mtDNA). As seen from their scientific classification, we can see that these two species are from the same genus, which suggests that their DNA should be similar. The following shows the CGRs of the “anatomically modern” human (left) and of the neanderthal (right). We can see that the two CGRs are quite similar (which is agrees with the fact that the two species are from the same genus) and therefore, we expect the the DSSIM to be small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">human_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NC_012920.fasta&#39;</span><span class="p">)</span>
<span class="n">human_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">human_dna</span><span class="p">)</span>

<span class="n">neanderthal_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NC_011137.fasta&#39;</span><span class="p">)</span>
<span class="n">neanderthal_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">neanderthal_dna</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;CGRs of human vs neanderthal mitochondrial DNA sequences&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">human_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">human_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Human (Homo sapiens) mitochondrial DNA&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">neanderthal_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">neanderthal_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Neanderthal (Homo sapiens neanderthalensis) mitochondrial DNA&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_42_0.png" src="../_images/chaos-game-representation_42_0.png" />
</div>
</div>
<p>Using Python’s <code class="docutils literal notranslate"><span class="pre">structural_similarity</span></code> function from the <code class="docutils literal notranslate"><span class="pre">skimage.metrics</span></code> library (aliased as <code class="docutils literal notranslate"><span class="pre">ssim</span></code> below), the structural similarity index between the two images above is:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In order to find SSIM, need to save figures as an image file. </span>
<span class="c1"># Below is an example of how you would save your figures as a png file.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">human_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">human_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/Output/human.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">human_CGR</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/Output/human.png&#39;</span><span class="p">,</span> <span class="n">as_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">neanderthal_CGR</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/Output/neanderthal.png&#39;</span><span class="p">,</span> <span class="n">as_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">human_neanderthal_ssim</span> <span class="o">=</span> <span class="n">ssim</span><span class="p">(</span><span class="n">human_CGR</span><span class="p">,</span> <span class="n">neanderthal_CGR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">human_neanderthal_ssim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8968926645376538
</pre></div>
</div>
</div>
</div>
<p>so the structural dissimilarity index is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">human_neanderthal_ssim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.10310733546234618
</pre></div>
</div>
</div>
</div>
<p>which agrees with our expectations.</p>
<p>In the following, we look at another example that compares the mtDNA of humans to other species, such as the great spotted kiwi (left) and pearlfish (right).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kiwi_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NC_002782.fasta&#39;</span><span class="p">)</span>
<span class="n">kiwi_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">kiwi_dna</span><span class="p">)</span>

<span class="n">pearlfish_dna</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NC_004373.fasta&#39;</span><span class="p">)</span>
<span class="n">pearlfish_coord</span> <span class="o">=</span> <span class="n">dna_cgr</span><span class="p">(</span><span class="n">pearlfish_dna</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;CGRs of Great Spotted Kiwi vs Pearlfish mitochondrial DNA sequences&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kiwi_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">kiwi_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Great spotted kiwi (Apteryx haastii) mitochondrial DNA&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pearlfish_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">pearlfish_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pearlfish (Carapus bermudensis) mitochondrial DNA&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_50_0.png" src="../_images/chaos-game-representation_50_0.png" />
</div>
</div>
<p>Just visually, the CGR of the mtDNA of the great spotted kiwi looks more similar to the CGRs of the human and neanderthal than the CGR of the pearlfish. Using all of the DSSIM, we can produce what is called a distance matrix, which is a square, real, symmetric matrix where each element is the structural dissimilarity index of two species with corresponds to the row and column. The distance matrix for the four species that we have already produced the CGR for is</p>
<!-- $$
    \mathrm{DSSIM}(x, y) =
    \begin{bmatrix}
        0 & 0.1223 & 0.7823 & 0.8541 \\
        0.1223 & 0 & 0.7821 & 0.8533 \\
        0.7823 & 0.7821 & 0 & 0.8519 \\
        0.8541 & 0.8533 & 0.8519 & 0
    \end{bmatrix} ,
$$ --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dist_matrix</span><span class="p">(</span><span class="n">cgr_list</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cgr_list</span><span class="p">)</span>
    <span class="n">dmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">dmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ssim</span><span class="p">(</span><span class="n">cgr_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cgr_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">dmat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">dmat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kiwi_CGR</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/Output/greatspottedkiwi.png&#39;</span><span class="p">,</span> <span class="n">as_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pearlfish_CGR</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/Output/pearlfish.png&#39;</span><span class="p">,</span> <span class="n">as_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">CGR_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">human_CGR</span><span class="p">,</span> <span class="n">neanderthal_CGR</span><span class="p">,</span> <span class="n">kiwi_CGR</span><span class="p">,</span> <span class="n">pearlfish_CGR</span><span class="p">]</span>

<span class="n">dist_matrix</span><span class="p">(</span><span class="n">CGR_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.10310734, 0.76524434, 0.85537312],
       [0.10310734, 0.        , 0.76727659, 0.85644889],
       [0.76524434, 0.76727659, 0.        , 0.85483255],
       [0.85537312, 0.85644889, 0.85483255, 0.        ]])
</pre></div>
</div>
</div>
</div>
<p>where the first row/column represents humans, the second row/column represents the neanderthals, the third row/column represents the great spotted kiwi, and lastly, the fourth row/column represents the pearlfish. Obviously, the diagonal of the matrix would be <span class="math notranslate nohighlight">\(0\)</span>, since the DSSIM of two of the same images would produce a result of 0. As we have seen previously, the <span class="math notranslate nohighlight">\(\mathrm{DSSIM}(\mathrm{human},\ \mathrm{neanderthal}) = 0.10310734\)</span>, and vice versa. From this matrix, we can see that the CGR of the mtDNA of pearlfish is most different than the rest—this agrees with what we have observed.</p>
<p>Multi-dimensional scaling (MDS) is a means of visualizing the level of similarity or dissimilarity of individual case of a dataset. It has been used in various fields such as cognitive science, information science, pychometrics, marketing, ecology, social science and other areas of study <span id="id34">[<a class="reference internal" href="../references.html#id16">Borg and Groenen, 2005</a>]</span>. The goal of MDS is to find a spatial configuration of objects when all that is known is some measure of their general similarity or dissimilarity <span id="id35">[<a class="reference internal" href="../references.html#id46">Wickelmaier, 2003</a>]</span>. In our case, MDS takes in the distance matrix and outputs a two-dimensional map, where each item is represented by a point. In <span id="id36">[<a class="reference internal" href="../references.html#id32">Kari <em>et al.</em>, 2013</a>]</span>, the authors used a classical MDS, which assumes that all the distances (from the distance matrix) are Euclidean. For the algorithm for classical MDS, refer to <span id="id37">[<a class="reference internal" href="../references.html#id46">Wickelmaier, 2003</a>]</span>(p. 10).</p>
<!-- Matlab has its own built-in function that does MDS, called `cmdscale`. -->
<p><a class="reference internal" href="#mdm"><span class="std std-numref">Fig. 13</span></a> shows an example of a molecular distance map (created in Matlab) of 4844 animals from various classes from the chordate phylum (meaning that all these animals have a vertebrate), coloured according to their class. The sequences were taken from NCBI Reference Sequence Database (RefSeq). We can see from this figure that this method (Map of Life) does quite a good job in sorting species into different categories. One particular aspect that we want to point out in this figure is where the points representing the lungfish are—they are in the area of where the bony fish, cartilage fish, and amphibians touch. This is truly remarkable as lung fish has qualities of all these classes.</p>
<div class="figure align-default" id="mdm">
<a class="reference internal image-reference" href="../_images/molecular_distance_map.png"><img alt="../_images/molecular_distance_map.png" src="../_images/molecular_distance_map.png" style="height: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">Molecular distance map of 4844 animals from various classes from the chordate phylum, coloured according to their class.</span><a class="headerlink" href="#mdm" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="protein-visualization">
<h3>Protein Visualization<a class="headerlink" href="#protein-visualization" title="Permalink to this headline">¶</a></h3>
<p>CGR has also been applied to visualizing and analyzing both the primary and secondary structures of proteins. The primary structure of a protein is simply an amino acid sequence. To analyze the primary structure of proteins, the authors from <span id="id38">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span> using an <span class="math notranslate nohighlight">\(20\)</span>-sided regular polygon, each representing an amino acid. <a class="reference internal" href="#amino-acid"><span class="std std-numref">Table 2</span></a> shows all 20 amino acids along with their 3-letter code, as well as their 1-letter code. To avoid the attractor from overlapping itself, we will use the dividing rate for a <span class="math notranslate nohighlight">\(20\)</span>-gon shown from <span id="id39">[<a class="reference internal" href="../references.html#id9">Almeida and Vinga, 2009</a>]</span>, <span class="math notranslate nohighlight">\(r = 0.863271\)</span>. Some CGRs for protein visualizations can be found in the following.</p>
<table class="table" id="amino-acid">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Table of all 20 amino acids</span><a class="headerlink" href="#amino-acid" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>3 letter code</p></th>
<th class="head"><p>1 letter code</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>alanine</p></td>
<td><p>ala</p></td>
<td><p>A</p></td>
</tr>
<tr class="row-odd"><td><p>arginine</p></td>
<td><p>arg</p></td>
<td><p>R</p></td>
</tr>
<tr class="row-even"><td><p>asparagine</p></td>
<td><p>asn</p></td>
<td><p>N</p></td>
</tr>
<tr class="row-odd"><td><p>aspartic acid</p></td>
<td><p>asp</p></td>
<td><p>D</p></td>
</tr>
<tr class="row-even"><td><p>cysteine</p></td>
<td><p>cys</p></td>
<td><p>C</p></td>
</tr>
<tr class="row-odd"><td><p>glutamine</p></td>
<td><p>gln</p></td>
<td><p>Q</p></td>
</tr>
<tr class="row-even"><td><p>glutamic acid</p></td>
<td><p>glu</p></td>
<td><p>E</p></td>
</tr>
<tr class="row-odd"><td><p>glycine</p></td>
<td><p>gly</p></td>
<td><p>G</p></td>
</tr>
<tr class="row-even"><td><p>histidine</p></td>
<td><p>his</p></td>
<td><p>H</p></td>
</tr>
<tr class="row-odd"><td><p>isoleucine</p></td>
<td><p>ile</p></td>
<td><p>I</p></td>
</tr>
<tr class="row-even"><td><p>leucine</p></td>
<td><p>leu</p></td>
<td><p>L</p></td>
</tr>
<tr class="row-odd"><td><p>lysine</p></td>
<td><p>lys</p></td>
<td><p>K</p></td>
</tr>
<tr class="row-even"><td><p>methionine</p></td>
<td><p>met</p></td>
<td><p>M</p></td>
</tr>
<tr class="row-odd"><td><p>phenylalanine</p></td>
<td><p>phe</p></td>
<td><p>F</p></td>
</tr>
<tr class="row-even"><td><p>proline</p></td>
<td><p>pro</p></td>
<td><p>P</p></td>
</tr>
<tr class="row-odd"><td><p>serine</p></td>
<td><p>ser</p></td>
<td><p>S</p></td>
</tr>
<tr class="row-even"><td><p>threonine</p></td>
<td><p>thre</p></td>
<td><p>T</p></td>
</tr>
<tr class="row-odd"><td><p>tryptophan</p></td>
<td><p>trp</p></td>
<td><p>W</p></td>
</tr>
<tr class="row-even"><td><p>tyrosine</p></td>
<td><p>tyr</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-odd"><td><p>valine</p></td>
<td><p>val</p></td>
<td><p>V</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">protein_cgr</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="n">AA</span> <span class="o">=</span> <span class="s1">&#39;ARNDCQEGHILKMFPSTWYVBZ&#39;</span>
    <span class="c1"># B = Aspartic acid (D) or Asparagine (N)</span>
    <span class="c1"># Z = Glutamic acid (E) or Glutamine (Q)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">dividingRateAlmeida</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">-</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">r</span>
    <span class="k">return</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Examples of CGR of protein sequences&#39;</span><span class="p">)</span>

<span class="n">human_cytochrome_b_seq</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/ASY00349.fasta&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">protein_cgr</span><span class="p">(</span><span class="n">human_cytochrome_b_seq</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;cytochrome b (mitochondrion) [Homo sapiens]&#39;</span><span class="p">)</span>

<span class="n">mouse_cytochrome_b_seq</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NP_904340.fasta&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">protein_cgr</span><span class="p">(</span><span class="n">mouse_cytochrome_b_seq</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;cytochrome b (mitochondrion) [Mus musculus]&#39;</span><span class="p">)</span>

<span class="n">major_vault_protein_seq</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NP_073206.fasta&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">protein_cgr</span><span class="p">(</span><span class="n">major_vault_protein_seq</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;major vault protein [Rattus norvegicus]&#39;</span><span class="p">)</span>

<span class="n">NADH_dehydrogenase_seq</span> <span class="o">=</span> <span class="n">parse_sequence</span><span class="p">(</span><span class="s1">&#39;../Supplementary Material/CGR/FASTA Files/NP_904340.fasta&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">protein_cgr</span><span class="p">(</span><span class="n">NADH_dehydrogenase_seq</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NADH dehydrogenase subunit 5 (mitochondrion) [Mus musculus]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_60_0.png" src="../_images/chaos-game-representation_60_0.png" />
</div>
</div>
<p>According to Basu et al. <span id="id40">[<a class="reference internal" href="../references.html#id15">Basu <em>et al.</em>, 1997</a>]</span>, there are two serious limitations for using a 20-vertex CGR to identify patterns. The first limitation the authors mentioned about using the 20-vertex is that it is hard to visualize different protein families since one would have to plot the sequences in different polygons rather than plotting a random sampling of proteins of different functions and origins in a single CGR <span id="id41">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span>. The second limitation is that there the amino acid residues in different positions are often replaced by similar amino acids <span id="id42">[<a class="reference internal" href="../references.html#id15">Basu <em>et al.</em>, 1997</a>]</span>. This means that the 20-vertex CGR cannot be used to differentiate between similar and dissimilar residues and the visualization could be different for proteins within the same family.</p>
<p>To fix the second limitation mentioned in <span id="id43">[<a class="reference internal" href="../references.html#id15">Basu <em>et al.</em>, 1997</a>]</span>, Fiser et al. <span id="id44">[<a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span> introduced using CGR to study 3D structures of proteins. A chain of amino acid is what is called a polypeptide. Due to each amino acid having a specific structure, which contributes to the amino acid’s properties, such as hydrophobicity or hydrogen-bonding, depending on the sequence of the amino acid chain, the polypeptide chain will fold into its lowest energy configuration <span id="id45">[<a class="reference internal" href="../references.html#id47">Simon <em>et al.</em>, 1991</a>]</span>.
This is known as the secondary structure. The two most common structures that appear in this stage are the <span class="math notranslate nohighlight">\(\alpha\)</span>-helices and the <span class="math notranslate nohighlight">\(\beta\)</span>-sheets. Using the chaos game on the secondary structure can indicate any non-randomness of the structural elements in proteins. One way to achieve this is to divide the 20 amino acids into 4 groups based on different properties and assign each group to a corner. Some properties that have been considered for CGR include hydrophobicity, molecular weight, isoelectric point (pI), <span class="math notranslate nohighlight">\(\alpha\)</span> propensity, and <span class="math notranslate nohighlight">\(\beta\)</span> propensity. For details, see <span id="id46">[<a class="reference internal" href="../references.html#id15">Basu <em>et al.</em>, 1997</a>, <a class="reference internal" href="../references.html#id22">Fiser <em>et al.</em>, 1994</a>]</span>.</p>
</div>
</div>
<div class="section" id="cgr-of-mathematical-sequences">
<span id="sec-math"></span><h2>CGR of Mathematical Sequences<a class="headerlink" href="#cgr-of-mathematical-sequences" title="Permalink to this headline">¶</a></h2>
<p>In the first-year course we gave in 2015 <span id="id47">[<a class="reference internal" href="../references.html#id17">Chan and Corless, 2020</a>]</span>, we applied the chaos game representation to mathematical sequences found on the Online Encyclopedia of Integer Sequences (OEIS) <span id="id48">[<a class="reference internal" href="../references.html#id43">Inc., 2019</a>]</span>. In the following, we show some CGR experiments that came from the first-year course. Some sequences that were used from the Online Encyclopedia of Integer Sequences (OEIS) included digits of <span class="math notranslate nohighlight">\(\pi\)</span> (A000796), Fibonacci Numbers (A000045), prime numbers (A000040), and some from the continued fractions section (which were introduced at the beginning of the course). We will not only look at the visualizations created in the first-year class, but we will also determine whether these experiments are considered to be good visual representations.</p>
<!-- Note that for the following 4-vertex examples, the vertices are labeled from "0" to "3" starting from the bottom left corner of the plot going clockwise (i.e. "0" corresponds to the coordinate point $(-1, -1)$, "1" corresponds to the point $(-1, 1)$, etc.).  -->
<div class="section" id="digits-of-pi">
<h3>Digits of Pi<a class="headerlink" href="#digits-of-pi" title="Permalink to this headline">¶</a></h3>
<p>We first applied CGR to the digits of <span class="math notranslate nohighlight">\(\pi\)</span> (A000796 from the <a class="reference external" href="https://oeis.org/A000796">OEIS</a>), since we believe that the sequence of the digits are random. Since we focused on the 4-vertex CGR in the course, we naïvely took the digits of <span class="math notranslate nohighlight">\(\pi\)</span> modulo 4 and applied it to the 4-vertex CGR. The result of this is shown in the left figure below. Since we assumed that the digits of <span class="math notranslate nohighlight">\(\pi\)</span> are random, this means that the visualization should be similar to the square-shaped CGR of random integer sequences from <a class="reference internal" href="#sec-polygons"><span class="std std-ref">Different Polygons</span></a>. However, we can see that this is not the case; instead of a uniform covering of the space, we can see a pattern of vertical lines occurring. Quantitatively, the DSSIM index between the CGR of the digits of <span class="math notranslate nohighlight">\(\pi\)</span> modulo 4 and the CGR of random digits is <span class="math notranslate nohighlight">\(0.9851\)</span>, which indicates that they are not similar. The reason for this is because when we take <span class="math notranslate nohighlight">\(10\bmod{4}\)</span>, the values are distributed to the corners unevenly: our 0 and 1 vertices would have one extra value each, and thus why our CGR of the digits of <span class="math notranslate nohighlight">\(\pi\)</span> does not match the CGR of random integers even though we know for a fact that the digits of <span class="math notranslate nohighlight">\(\pi\)</span> are indeed random. Due to this reason, the left figure below is not a good visual representation of the digits of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Another CGR to visualize the digits of <span class="math notranslate nohighlight">\(\pi\)</span> is shown in the right figure below. We use a 10-vertex CGR (<span class="math notranslate nohighlight">\(r = 0.763932\)</span>) where each vertex represents an integer from 0 to 9. From this figure, we can see that the points produce a fractal pattern of the decagon, which suggests that the sequence is random.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pi_digits</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))))</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">numeric_cgr</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">n_ver</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n_ver</span><span class="p">,</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n_ver</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">dividingRateAlmeida</span><span class="p">(</span><span class="n">n_ver</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="k">n_ver</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">-</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">r</span>
    <span class="k">return</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">pi_seq</span> <span class="o">=</span> <span class="n">pi_digits</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;CGRs of the first </span><span class="si">{}</span><span class="s1"> digits of pi&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">pi_seq</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">135</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digits of pi modulo 4&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">pi_seq</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digits of pi modulo 10&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_65_0.png" src="../_images/chaos-game-representation_65_0.png" />
</div>
</div>
</div>
<div class="section" id="fibonacci-sequence">
<h3>Fibonacci Sequence<a class="headerlink" href="#fibonacci-sequence" title="Permalink to this headline">¶</a></h3>
<p>We also created a visualization of the Fibonacci Sequence (A000045 from the OEIS). One example of a visualization of this sequence is a 10-vertex CGR of the Fibonacci sequence modulo 10; that is, a sequence of the final digits of <span class="math notranslate nohighlight">\(F_n\)</span>. It appears by the density of the even blocks in <a class="reference internal" href="#cgr-fibonacci-wrong"><span class="std std-numref">Fig. 14</span></a> that most (by far and away most) of the numbers of the Fibonacci sequence are even; this conclusion seems very strange, and deserves a closer look.</p>
<p>In fact the sequence is ultimately periodic (as of course it must be, because the set of decimal digits is finite), and indeed it has period <span class="math notranslate nohighlight">\(60\)</span>: The first <span class="math notranslate nohighlight">\(65\)</span> entries are <span class="math notranslate nohighlight">\(1, 1, 2, 3, 5, 8, 3, 1, \ldots, 9, 1, 0, 1, 1, 2, 3, 5\)</span> and it repeats from there.  Just by counting, <span class="math notranslate nohighlight">\(40\)</span> out of these <span class="math notranslate nohighlight">\(60\)</span> numbers are <em>odd</em>, and only <span class="math notranslate nohighlight">\(20\)</span> are even; so the conclusion that “almost all Fibonacci numbers are even” that we drew from <a class="reference internal" href="#cgr-fibonacci-wrong"><span class="std std-numref">Fig. 14</span></a> is completely wrong!</p>
<div class="figure align-default" id="cgr-fibonacci-wrong">
<a class="reference internal image-reference" href="../_images/FibonacciCGRmod10crop.png"><img alt="../_images/FibonacciCGRmod10crop.png" src="../_images/FibonacciCGRmod10crop.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 14 </span><span class="caption-text">CGR of the Fibonacci sequence calculated in floating-point arithmetic before taking the remainder mod 10 in Matlab</span><a class="headerlink" href="#cgr-fibonacci-wrong" title="Permalink to this image">¶</a></p>
</div>
<p>The correct behaviour is shown below; this shows the periodicity by its sparseness.  It is important to do the modular reduction as you go, if you are working in floating-point arithmetic; once <span class="math notranslate nohighlight">\(F_n\)</span> gets large enough it won’t be possible to compute the trailing digit correctly and all one will see is rounding error, which we see in <a class="reference internal" href="#cgr-fibonacci-wrong"><span class="std std-numref">Fig. 14</span></a> looks pretty uniform on each <em>even</em> block. In contrast, while a pair of floating-point integers (called a “flints” in some places) remains small, arithmetic with it remains perfectly accurate. What we are seeing in the figure is an effect of rounding errors in <em>large</em> floating-point integers; more, a closer look at <span class="math notranslate nohighlight">\(f_{79}\)</span> shows the <em>round-to-even</em> rule for IEEE floating-point arithmetic<a class="footnote-reference brackets" href="#id71" id="id49">6</a>. Since <span class="math notranslate nohighlight">\(f_{78}\)</span> really is even, and <span class="math notranslate nohighlight">\(f_{79}\)</span> is rounded to an even number by the round-to-even rule, all computed floating-point Fibonacci numbers thereafter are even. Of course, once they got large enough that the units place falls completely off the significand, they would all be reported as “eve” anyway.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">n_element</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mod</span><span class="p">:</span>
                <span class="n">n_element</span> <span class="o">=</span> <span class="n">n_element</span><span class="o">%</span><span class="k">10</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_element</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;CGRs of the first </span><span class="si">{}</span><span class="s1"> Fibonacci Sequence modulo 10&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">fib_seq</span> <span class="o">=</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">fib_seq</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Taking modulo 10 after creating the Fibonacci sequence&#39;</span><span class="p">)</span>

<span class="n">fib_seq_mod10</span> <span class="o">=</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">fib_seq</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Taking modulo 10 while making the Fibonacci sequence&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_70_0.png" src="../_images/chaos-game-representation_70_0.png" />
</div>
</div>
<p>Other visualizations for the Fibonacci sequence can be done, such as taking the remainder using a different divisor and using a CGR with different number of vertices.</p>
<p>However, since the Fibonacci sequence grows very quickly, like <span class="math notranslate nohighlight">\(\phi^n\)</span> where <span class="math notranslate nohighlight">\(\phi = (1+\sqrt{5})/2 \doteq 1.618\)</span> is the golden ratio, the students also learned about another limitation of floating point since they were unable to take more than the first 3000 Fibonacci numbers before the computation overflow, registering the number as infinity. Using big integers instead as is possible in Python, overflow wouldn’t happen (as seen above), but the arithmetic would get slower.</p>
</div>
<div class="section" id="prime-numbers">
<h3>Prime Numbers<a class="headerlink" href="#prime-numbers" title="Permalink to this headline">¶</a></h3>
<p>Following the visualization of the digits of <span class="math notranslate nohighlight">\(\pi\)</span> and the Fibonacci sequence using the chaos game, we looked at another popular sequence: the sequence of prime numbers (<a class="reference external" href="https://oeis.org/A000040">A000040 from the OEIS</a>). We looked at four different ways of creating the CGR for prime numbers.</p>
<p>We first visualized the prime numbers in a similar way as what we did for the digits of <span class="math notranslate nohighlight">\(\pi\)</span> and the Fibonacci numbers by taking the sequence of prime numbers modulo 10. This is shown in the top left figure below. We notice that almost all of the prime numbers ends with a 1, 3, 7, or 9. Because of this observation, we decided to create a square CGR labelling the vertices with these values. The result is shown in the top right figure below.</p>
<p>The bottom left figure is the third visualization of prime numbers: a CGR of the <span class="math notranslate nohighlight">\(103+k\)</span>th prime numbers <span class="math notranslate nohighlight">\(\bmod\ 4\)</span>, a diagonal line which spans from the “1” corner to the “3” corner. As we all know, prime numbers larger than 2 will never be even, so the corner points “0” and “2” which are representative “even” values would never occur, thus creating a straight diagonal line. If we had reassigned the values the coordinate points represent, the plot would have turned out differently; instead of a diagonal line, it could possibly be a horizontal (spanning from coordinate points <span class="math notranslate nohighlight">\((-1, -1)\)</span> to <span class="math notranslate nohighlight">\((1, -1)\)</span> or from <span class="math notranslate nohighlight">\((-1, 1)\)</span> to <span class="math notranslate nohighlight">\((1, 1)\)</span>) or vertical line (spanning from <span class="math notranslate nohighlight">\((-1, 1)\)</span> to <span class="math notranslate nohighlight">\((-1, -1)\)</span> or <span class="math notranslate nohighlight">\((1, 1)\)</span> to <span class="math notranslate nohighlight">\((1, -1)\)</span>), or a diagonal line the spanning the other two vertices. One needs to be mindful of how the coordinate points are assigned.</p>
<p>Lastly, we can visualize the prime numbers in a different way, as seen in the bottom right figure. Here, we took the sequence of prime numbers less than one million and took <span class="math notranslate nohighlight">\(\bmod\ 8\)</span> of the numbers. We thought that this would be interesting because taking any prime number larger than <span class="math notranslate nohighlight">\(2\)</span> modulo <span class="math notranslate nohighlight">\(8\)</span> will only result in the following numbers: 1, 3, 5, and 7. Because of this, we relabelled the vertices to “1”, “3”, “5”, and “7” starting from the bottom left corner, going clockwise (i.e. the coordinate point <span class="math notranslate nohighlight">\((-1, -1)\)</span> is labelled “1”, <span class="math notranslate nohighlight">\((-1, 1)\)</span> is labelled “3”, etc.), and plotted the points according to the chaos game (<span class="math notranslate nohighlight">\(r = 0.5\)</span>). Surprisingly, this gives us a pattern, apparently meaning that there is a pattern in the sequence of prime numbers <span class="math notranslate nohighlight">\(\bmod\ 8\)</span>. However, compare this to a random-populated square CGR, which, though random, showed patterns. This “evidence of pattern” is not conclusive! This is possibly simply a Procrustean effect, and we’d have to know more about the distribution of primes to say more.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">primes</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="c1"># returns list of prime numbers less than or equal to N</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">divisor</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">j</span> == 0:
                <span class="n">divisor</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">divisor</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">numeric_cgr_vertex</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="n">n_ver</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n_ver</span><span class="p">,</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">n_gon</span><span class="p">(</span><span class="n">n_ver</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">dividingRateAlmeida</span><span class="p">(</span><span class="n">n_ver</span><span class="p">)</span>
    <span class="n">dataPoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">-</span> <span class="n">dataPoints</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">r</span>
    <span class="k">return</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">dataPoints</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">50000</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Examples of CGR of prime numbers&#39;</span><span class="p">)</span>

<span class="n">prime_num</span> <span class="o">=</span> <span class="n">primes</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">prime_num</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All prime numbers less than </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">prime_num_mod10</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">%</span><span class="k">10</span> for p in prime_num]
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr_vertex</span><span class="p">(</span><span class="n">prime_num_mod10</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="o">-</span><span class="mi">135</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All prime numbers between 7 and </span><span class="si">{}</span><span class="s1"> taken mod 10, vertices = [1, 3, 7, 9]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">prime_num_mod4</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">%</span><span class="k">4</span> for p in prime_num]
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">prime_num_mod4</span><span class="p">[</span><span class="mi">102</span><span class="p">:],</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">135</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;103+kth prime number mod 4&#39;</span><span class="p">)</span>

<span class="n">prime_num_mod8</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">%</span><span class="k">8</span> for p in prime_num]
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr_vertex</span><span class="p">(</span><span class="n">prime_num_mod8</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">135</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All prime numbers between 7 and </span><span class="si">{}</span><span class="s1"> taken mod 8, vertices = [1, 3, 5, 7]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_74_0.png" src="../_images/chaos-game-representation_74_0.png" />
</div>
</div>
</div>
<div class="section" id="partial-quotients-of-continued-fractions">
<h3>Partial Quotients of Continued Fractions<a class="headerlink" href="#partial-quotients-of-continued-fractions" title="Permalink to this headline">¶</a></h3>
<p>We then explored visualizing the sequences taken from the partial quotients of continued fractions, which were taught at the beginning of the course. Continued fractions are fractions written in the following general form <span id="id50">[<a class="reference internal" href="../references.html#id3">Corless, 1992</a>, <a class="reference internal" href="../references.html#id39">Olds, 1963</a>]</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-73a44e9e-6e8d-4910-b541-88003fd03b90">
<span class="eqno">(71)<a class="headerlink" href="#equation-73a44e9e-6e8d-4910-b541-88003fd03b90" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	a_0 + \cfrac{1}{a_{1} + \cfrac{1}{a_{2} + \cfrac{1}{a_{3} + \cfrac{1}{a_{4} + \cfrac{1}{\ddots}}}}} ,
\end{equation}\]</div>
<p>which produces a sequence of numbers, <span class="math notranslate nohighlight">\(a_{0} + \left[ a_{1}, a_{2}, a_{3}, a_{4}, \cdots\right]\)</span>, called the partial quotients of the continued fraction. This can be demonstrated with an example: we can rewrite <span class="math notranslate nohighlight">\(\frac{9}{7}\)</span> in the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-e71c8e5e-5a15-46eb-b672-31705e34c4bb">
<span class="eqno">(72)<a class="headerlink" href="#equation-e71c8e5e-5a15-46eb-b672-31705e34c4bb" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	\dfrac{9}{7} = 1 + \dfrac{2}{7} = 1 + \dfrac{1}{\frac{7}{2}} = 1 + \cfrac{1}{3 + \frac{1}{2}} = 1 + \dfrac{1}{3 + \cfrac{1}{1 + \frac{1}{1}}} .
	\label{eqn:cfrac}
\end{equation}\]</div>
<p>Here, the partial quotients of <span class="math notranslate nohighlight">\(\frac{9}{7}\)</span> are the elements of <span class="math notranslate nohighlight">\(1 + \left[3, 1, 1\right]\)</span>. The students then looked at the continued fractions of other numbers, such as <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>, <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span>, where the sequences of their partial quotients were used in chaos game representations.</p>
<p>One recurring theme of the experimental mathematics course was <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>, so with this in mind, some students jumped on the opportunity to plot the chaos game representation of the quotients of the continued fraction of <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>. As we had seen in an earlier unit, the sequence goes like</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	1 + [2, 2, 2, 2, \ldots, 2] .
\end{equation*}\]</div>
<p>Because all elements of the sequence (apart from the first one) are 2’s, it is not surprising to see a (faint) diagonal line with most of the points in the upper right corner, shown in the left figure below. The students also tried the partial quotients of <span class="math notranslate nohighlight">\(e\)</span>, which is equal to</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	2 + \left[1, 2, 1, 1, 4, 1, 1, 6, \cdots \right]
\end{equation*}\]</div>
<p><span id="id51">[<a class="reference internal" href="../references.html#id40">Olds, 1970</a>]</span>, shown in the middle figure. What is seen here makes sense as the sequence mostly contains 1’s and these alternates with even values, so in this case, either 0 or 2. Therefore, it is clear that there are no points in the lower right corner since that represents the value 3. Unfortunately, these two plots do not look all that impressive; in fact, it is pretty underwhelming. Disappointed with this result, the students decided to experiment with other sequences in which all four coordinates occur.</p>
<p>The students then thought, “Why not take the partial quotients of the continued fraction of <span class="math notranslate nohighlight">\(\pi\)</span>? The results <em>must</em> be random.” As shown in the right figure, unexpectedly, there is indeed a pattern, which shows that the sequence of partial quotients of the continued fraction of <span class="math notranslate nohighlight">\(\pi\)</span> is not as random as we thought at the beginning of the course. This showed the students that the distribution is not uniform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">confrac</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">expr</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Examples of CGR for partial quotients of continued fractions&#39;</span><span class="p">)</span>

<span class="n">pq_sqrt2</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">pq_sqrt2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">135</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;sqrt(2) mod 4&#39;</span><span class="p">)</span>

<span class="n">pq_exp</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">pq_exp</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;exp(1) mod 4&#39;</span><span class="p">)</span>

<span class="n">pq_pi</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">450</span><span class="p">)</span>
<span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span> <span class="o">=</span> <span class="n">numeric_cgr</span><span class="p">(</span><span class="n">pq_pi</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;pi mod 4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chaos-game-representation_77_0.png" src="../_images/chaos-game-representation_77_0.png" />
</div>
</div>
<p>In fact, the distribution of partial quotients is very well known, owing to the results of Khinchin <span id="id52">[<a class="reference internal" href="../references.html#id34">Khinchin and Teichmann, 1964</a>]</span>. As a very startling aside, recently, Bill Gosper has remarked on an amazing identity</p>
<div class="amsmath math notranslate nohighlight" id="equation-77f961d3-68b3-4a01-9615-620e70a2b6b1">
<span class="eqno">(73)<a class="headerlink" href="#equation-77f961d3-68b3-4a01-9615-620e70a2b6b1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	\prod k!^{\Delta_{3}\ln k} = K^{\ln 2} ,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(K\)</span> is Khinchin’s constant. We did not inform our students of Khinchin’s remarkable results because CGR was only done at the end of the course. Next time, perhaps!</p>
</div>
</div>
<div class="section" id="random-vs-pseudorandom">
<span id="sec-random"></span><h2>Random vs Pseudorandom<a class="headerlink" href="#random-vs-pseudorandom" title="Permalink to this headline">¶</a></h2>
<p>The theory of probability arose much later in the development of science than the theory of dynamical systems and of exact trajectories, and therefore, it may be more difficult to grasp. There are many different works on the fundamentals of probability which discuss this difficulty; see for instance <span id="id53">[<a class="reference internal" href="../references.html#id25">Hamming, 1991</a>]</span>, but also <span id="id54">[<a class="reference internal" href="../references.html#id29">Kac, 1959</a>]</span>. We believe that combining deterministic dynamics with randomness is even more difficult; and that this, in fact, is the main business nowadays of the applied mathematician.  There have been, of course, millions of words written on the topic.  We believe that it is crucial that entering students see some of the discussions of the fundamentals; they need to have a chance to grasp the deeper, most practical aspects of the theory.  We believe that this module offers the instructor a chance to begin those discussions.</p>
<p>One important early part of the discussion is whether or not what the computer produces is “really” random, and whether entries in a sequence are “really” independent.  We alluded earlier to the fact that the poor quality of some early bad random number generators was detected by patterns arising in two-dimensional pictures.  How are the patterns arising in the pictures in this paper different?  Would they arise if “really” random numbers were used instead of the pseudorandom numbers generated by computer? [The answer is yes.]  And what is the difference, anyway?  There are knots here that the students (and professors) can tie themselves in: once a sequence of numbers is written down, however randomly it was generated, how can it be random, any more?  It’s now perfectly predictable!  The most comforting words that we know about this come from Kolmogorov himself (quoted in full at the end of this paper) which we paraphrase as “it’s only a model”. Indeed see <span id="id55">[<a class="reference internal" href="../references.html#id36">Kolmogorov, 1983</a>]</span> for a brief discussion of a <em>mathematical</em> foundation for probability. This applies whether your sequence is “really” random, or only “pseudo” random.</p>
<p>These discussions are important, in a situation such as that of this paper, where we are trying to tease out deterministic aspects of <em>apparently</em> random sequences (or of sequences such as that of DNA which is surely influenced both by random events (mutation, horizontal gene transfer) and very non-random events (selection).  We have used some “clearly” non-random (in some sense) sequences such as the digits of <span class="math notranslate nohighlight">\(\pi\)</span> to show that we can detect a signature of randomness there; we have used the same techniques to detect a signature of regularity. To be convinced, the students must be allowed to discuss these issues at some length. In particular, this may be the first time the students have encountered pseudorandom numbers.</p>
<p>There are several high-quality methods for uniform pseudorandom number generation: the most popular includes the <em>multiple-recursive method</em> and families formed by <em>shift-register methods</em> <span id="id56">[<a class="reference internal" href="../references.html#id18">Dennis <em>et al.</em>, 2015</a>]</span>. The multiple-recursive method is an extension of the linear congruential method by replacing the first-order linear recursion by one of higher order. One family in the shift-register method generates uniform pseudorandom numbers by means of linear recurring sequences modulo <span class="math notranslate nohighlight">\(2\)</span>. Another uses vector recursions modulo <span class="math notranslate nohighlight">\(2\)</span> of higher order; this family includes the very popular Mersenne twister MT19937 <span id="id57">[<a class="reference internal" href="../references.html#id37">Matsumoto and Nishimura, 1998</a>]</span>, which is the default for Matlab’s pseudorandom number generating functions, which includes <code class="docutils literal notranslate"><span class="pre">rand</span></code> (uniformly distributed random number), <code class="docutils literal notranslate"><span class="pre">randn</span></code> (normally distributed random numbers), and <code class="docutils literal notranslate"><span class="pre">randi</span></code> (uniformly distributed pseudorandom integers) <span id="id58">[<a class="reference internal" href="../references.html#id38">Moler, 2015</a>]</span>. Other pseudorandom number generators in Matlab include SIMD-oriented Fast Mersenne Twister, Combined Multiple Recursive, Multiplicative Lagged Fibonacci and Legacy MATLAB generators. Users can use Matlab’s <code class="docutils literal notranslate"><span class="pre">rng</span></code> function to control which generator to use, along with the seed for the pseudorandom number generator to produce a predictable sequence of numbers.</p>
<p>As mentioned above, one of the pseudorandom number generators Matlab’s <code class="docutils literal notranslate"><span class="pre">rand</span></code> function uses is the Mersenne twister MT19937 to generate uniform pseudorandom numbers. The MT19937 produces sequences of uniform pseudorandom numbers with period length <span class="math notranslate nohighlight">\(2^{19937} - 1\)</span> that possess 623-dimensional equidistribution up to 32 bits accuracy <span id="id59">[<a class="reference internal" href="../references.html#id18">Dennis <em>et al.</em>, 2015</a>]</span>. This would seem to create a better “random” outcome in comparison to an actual sequence of die rolls according to some measures. However, <a class="reference external" href="https://www.random.org/">random.org</a> claims that their “dice roller” is, for many purposes, better than pseudorandom number algorithms typically used in computer programs. The randomness in their program comes from atmospheric noise.</p>
<p>Using a pseudorandom number generator differs to using dice or the atmospheric-sourced generators at <a class="reference external" href="https://www.random.org/">random.org</a>. One gets different results due to the different methods that are used. Now, physically-based systems that we believe are random are sometimes more problematic than we think. For instance, rolling a die is not quite as random as one would expect. Stein’s article <span id="id60">[<a class="reference internal" href="../references.html#id42">Stein, 2012</a>]</span> in Inside Science states that dice rolls are not completely random: the initial position of the (fair) die affects the outcome of the die roll. And is anything in the atmosphere truly random?  Or is this just a statement of our ignorance?  Kolmogorov’s words—it’s only a model—are comforting here. But they help with the use of pseudorandom numbers, as well.</p>
<p>In practice, pseudorandom number generators are indispensable for working with probability, and an enormous amount of work has gone into making them of very high-quality indeed.  We know of no way to distinguish—in practice—results from these good generators from results given by physically-based generators that nearly everyone believes are “really” random.</p>
</div>
<div class="section" id="concluding-remarks">
<h2>Concluding Remarks<a class="headerlink" href="#concluding-remarks" title="Permalink to this headline">¶</a></h2>
<p>This module can be used to teach students about a useful visualization of sequences, in which case the emphasis from the instructor could be on interpreting the results, perhaps by using structural similarity or distance maps. The module can also be used to teach elementary programming techniques, in which case the instructor can emphasize programming tools, correctness, efficiency, style, or analysis.</p>
<p>Using elementary sequences of integers makes the module accessible even to first-year students, avoiding difficult biological details: but even so, students are exposed to the deep concepts of pattern and randomness more or less straight away. We have only begun a discussion of what it means to be random, and what it means to have a pattern. Randomness in a model can be a way to hide our ignorance, or it can be a profound statement of our understanding. Modelling viral evolution using randomness <span id="id61">[<a class="reference internal" href="../references.html#id44">Wahl and Pattenden, 2017</a>]</span>, where mutations occur in large populations, is clearly warranted; similarly for the vast lengths of DNA sequences. For prime numbers, in one sense clearly not: primes cannot be random, even though they behave in some ways as if they are.</p>
<blockquote class="epigraph">
<div><p>Such considerations may be repeated as often as we like, but it is clear that this procedure will never allow us to be free of the necessity, at the last stage, of referring to probabilities in the primitive imprecise sense of this term.</p>
<p>It would be quite wrong to think that difficulties of this kind are peculiar in some way to the theory of probability. In the mathematical investigation of actual events, we always make a model of them. The discrepancies between the actual course of events and the theoretical model can, in its turn, be made the subject of mathematical investigation. But for these discrepancies we must construct a model that we will use without formal mathematical analysis of the discrepancies which again would arise in it in actual experiment.</p>
<p class="attribution">—<a class="reference external" href="https://mathshistory.st-andrews.ac.uk/Biographies/Kolmogorov/">Andrey Kolmogorov</a>, <span id="id62">[<a class="reference internal" href="../references.html#id7">Aleksandrov <em>et al.</em>, 1999</a>]</span>
</p>
</div></blockquote>
<p>Indeed, much the same comments can be made about our use of the words “fractal” and “attractor” here.  All of our computations are finite, so <em>nothing</em> that we see is actually a “true fractal”, and similarly our computations show only  parts of the transients, not the attracting set (much less the attractor). This doesn’t matter: again, what matters is that fractals and attractors, in the infinite limit, provide good models for the pictures that our finite computations produce.  For more details both about the rigour and the utility of fractals, consult <span id="id63">[<a class="reference internal" href="../references.html#id12">Mandelbrot, 2004</a>]</span>.  As a final remark, what convinced us of the value of CGR for DNA sequences was nothing mathematical, but rather its wonderfully apropos placement of curious creatures on the “Map of Life”: for instance, picking out an organism mapped to a point near the border between the group of “fish” and the group  of “amphibians” we find an air-breathing fish!</p>
<p>This raises a final point. This technique really works, for DNA sequences; and it can be genuinely informative for other kinds of sequences, as we have seen.  For instance, we were able to detect the influence of rounding errors (for the Fibonacci sequence computation).  One also needs an explanation of_why_ this works; these can make good discussion points with students.  Consider the impact of short stretches of so-called “junk” or non-coding DNA, distributed throughout a long coding sequence.  Will the “junk” make a difference to the CGR representation? In some cases not, but if there is enough junk, then maybe it will.  But in many cases we could claim that one reason this works is that CGR really gives a “whole picture” of the sequence, and is relatively robust under errors such as shifts and interruptions with short insertions.  Then one should investigate that claim, to see if it was true.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id64"><span class="brackets"><a class="fn-backref" href="#id6">1</a></span></dt>
<dd><p>To be more specific, this is a <em>hyperbolic</em> iterated function system. However, the word “hyperbolic” is sometimes dropped in practice <span id="id65">[<a class="reference internal" href="../references.html#id14">Barnsley, 2014</a>]</span>(p. 82).</p>
</dd>
<dt class="label" id="id66"><span class="brackets"><a class="fn-backref" href="#id7">2</a></span></dt>
<dd><p>It can be proved that in the limit of infinite computation for a random sequence of infinite length that the picture really is that of the Sierpinski triangle <span id="id67">[<a class="reference internal" href="../references.html#id13">Barnsley and Vince, 2011</a>]</span>.</p>
</dd>
<dt class="label" id="id68"><span class="brackets"><a class="fn-backref" href="#id10">3</a></span></dt>
<dd><p>The word “game” here does not refer to an adversarial game with choices and strategies as in <em>game theory</em>, but instead treats sequences as something like the outcomes of a game of chance like tossing coins. The use of “chaos” here happened because the biologist H.J. Jeffrey used the word, likely to indicate generally from which area of mathematics the ideas were taken from.</p>
</dd>
<dt class="label" id="id69"><span class="brackets"><a class="fn-backref" href="#id14">4</a></span></dt>
<dd><p>We tried this, though not in class. We got up to 80 points on one figure, using the die roller on <a class="reference external" href="https://www.random.org/">random.org</a>. It’s kind of fun, in a physical “drawing and measuring” way, but it’s hard not to make mistakes. It could make a useful “active learning” exercise and we might try it in class in the future.</p>
</dd>
<dt class="label" id="id70"><span class="brackets"><a class="fn-backref" href="#id17">5</a></span></dt>
<dd><p>This is a loose way of thinking about it: we somehow imagine regions of the gameboard that equally attract elements of the sequence, and if these regions overlap, then we see spuriously dense regions on the gameboard.  Alternatively, we could think (more rigorously) about the <em>probability measure</em> of the attractor (now really spread over the whole gameboard).  One would want a “random” sequence to have a uniform measure across the gameboard.</p>
</dd>
<dt class="label" id="id71"><span class="brackets"><a class="fn-backref" href="#id49">6</a></span></dt>
<dd><p>The round-to-even rule is a topic that many students stumble over. As is pointed out in <span id="id72">[<a class="reference internal" href="../references.html#id8">Higham, 2002</a>]</span>(Section 1.17), rounding errors are not random; but the round-to-even rule was invented to reduce the <em>bias</em> of rounding error in long sequences of computation. This sounds paradoxical but although rounding errors are not random, or independent, there are situations where it is a useful model to assume so: see <span id="id73">[<a class="reference internal" href="../references.html#id8">Higham, 2002</a>]</span>(Section 2.8) for further discussion of this point.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Contents"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="mandelbrot.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mandelbrot Polynomials and Matrices</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Appendix/floating-point.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Bare Minimum about Floating-Point</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Neil J. Calkin, Eunice Y.S. Chan, and Robert M. Corless<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>