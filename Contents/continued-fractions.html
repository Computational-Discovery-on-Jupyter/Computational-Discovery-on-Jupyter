
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Continued Fractions &#8212; Computational Discovery on Jupyter</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.jpg"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Rootfinding, Newton’s Method, and Dynamical Systems" href="rootfinding.html" />
    <link rel="prev" title="Preamble" href="../preamble.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Discovery on Jupyter</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to Computational Discovery on Jupyter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preamble.html">
   Preamble
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Continued Fractions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rootfinding.html">
   Rootfinding, Newton’s Method, and Dynamical Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fractals-and-julia-sets.html">
   Fractals and Julia Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bohemian-matrices.html">
   Bounded Height Matrices of Integers (Bohemian Matrices)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mandelbrot.html">
   Mandelbrot Polynomials and Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chaos-game-representation.html">
   Chaos Game Representation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/floating-point.html">
   The Bare Minimum about Floating-Point
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/binomials-factorials-combinatorics.html">
   Binomials, Factorials, and other Combinatorial Things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/complex-numbers.html">
   Complex Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/symbolic-computation.html">
   Symbolic Computation: The Pitfalls
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Continued%20Fraction%20Exercises.html">
   Solutions to Continued Fractions Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20the%20Rootfinding%20Chapter%20Exercises.html">
   Solutions to the Rootfinding Chapter Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20the%20Julia%20Set%20Exercises.html">
   Solutions to the Julia Set Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Exercises%20%28not%20Activities%29%20in%20the%20Bohemian%20Unit.html">
   Solutions to Exercises (not Activities) in the Bohemian Unit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Solutions/Solutions%20to%20Mandelbrot%20Exercises.html">
   Solutions to Mandelbrot Polynomials and Matrices Exercises
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Back Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about.html">
   About the authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Contents/continued-fractions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Computational-Discovery-on-Jupyter/Computational-Discovery-on-Jupyter"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        <a class="edit-button" href="https://github.com/Computational-Discovery-on-Jupyter/Computational-Discovery-on-Jupyter/edit/master/book/Contents/continued-fractions.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-game-of-pass-the-parcel">
   The game of
   <em>
    pass the parcel
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#another-python-program">
   Another Python Program
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#warning-the-python-arithmetic-changes-when-we-import-sympy-symbolic-python">
     Warning: the Python arithmetic changes when we import SymPy (“Symbolic Python”)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#programming-as-a-method-of-validation">
   Programming as a method of validation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-backwards">
     Working backwards
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-forwards">
     Working
     <em>
      forwards
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#games">
     Games
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-gauss-map">
     The Gauss Map
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#floating-point-issues">
   Floating-point issues
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-decimal-arithmetic-to-compute-these">
     Using Decimal Arithmetic to compute these
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-facts-about-continued-fractions">
   Random  Facts about Continued Fractions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euclid-s-algorithm-for-greatest-common-divisor">
     Euclid’s algorithm for greatest common divisor.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-continued-fraction-for-the-golden-ratio-and-its-connection-to-fibonacci-numbers">
     The continued fraction for the golden ratio and its connection to Fibonacci numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inequalities">
     Inequalities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differences-of-convergents">
     Differences of convergents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-diophantine-equations">
     Solving Diophantine equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalized-continued-fractions">
     Generalized continued fractions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambert-s-proof-of-the-irrationality-of-pi">
     Lambert’s proof of the irrationality of
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#galois-theorem">
     Galois’ Theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagrange-s-theorem">
     Lagrange’s Theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mental-estimation-of-square-roots">
     Mental estimation of square roots
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-similar-method-rmc-just-learned-which-is-apparently-current-in-some-high-schools">
       A similar method RMC just learned, which is apparently current in some high schools
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#best-approximation">
   Best Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-astonishing-continued-fractions-for-e">
     The astonishing continued fractions for e
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rational-approximation-to-the-exponential-function">
     Rational approximation to the exponential function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#randomness-in-continued-fractions">
     Randomness in Continued Fractions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notes-and-further-reading">
   Notes and further reading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practice-problems-and-exercises">
   Practice Problems and Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#open-problems-big-projects">
   Open Problems/Big Projects
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Continued Fractions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-game-of-pass-the-parcel">
   The game of
   <em>
    pass the parcel
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#another-python-program">
   Another Python Program
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#warning-the-python-arithmetic-changes-when-we-import-sympy-symbolic-python">
     Warning: the Python arithmetic changes when we import SymPy (“Symbolic Python”)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#programming-as-a-method-of-validation">
   Programming as a method of validation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-backwards">
     Working backwards
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-forwards">
     Working
     <em>
      forwards
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#games">
     Games
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-gauss-map">
     The Gauss Map
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#floating-point-issues">
   Floating-point issues
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-decimal-arithmetic-to-compute-these">
     Using Decimal Arithmetic to compute these
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-facts-about-continued-fractions">
   Random  Facts about Continued Fractions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euclid-s-algorithm-for-greatest-common-divisor">
     Euclid’s algorithm for greatest common divisor.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-continued-fraction-for-the-golden-ratio-and-its-connection-to-fibonacci-numbers">
     The continued fraction for the golden ratio and its connection to Fibonacci numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inequalities">
     Inequalities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differences-of-convergents">
     Differences of convergents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-diophantine-equations">
     Solving Diophantine equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalized-continued-fractions">
     Generalized continued fractions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambert-s-proof-of-the-irrationality-of-pi">
     Lambert’s proof of the irrationality of
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#galois-theorem">
     Galois’ Theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagrange-s-theorem">
     Lagrange’s Theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mental-estimation-of-square-roots">
     Mental estimation of square roots
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-similar-method-rmc-just-learned-which-is-apparently-current-in-some-high-schools">
       A similar method RMC just learned, which is apparently current in some high schools
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#best-approximation">
   Best Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-astonishing-continued-fractions-for-e">
     The astonishing continued fractions for e
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rational-approximation-to-the-exponential-function">
     Rational approximation to the exponential function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#randomness-in-continued-fractions">
     Randomness in Continued Fractions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notes-and-further-reading">
   Notes and further reading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practice-problems-and-exercises">
   Practice Problems and Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#open-problems-big-projects">
   Open Problems/Big Projects
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="continued-fractions">
<h1>Continued Fractions<a class="headerlink" href="#continued-fractions" title="Permalink to this headline">¶</a></h1>
<p>This Open Educational Resource (OER) or book is about using a computer <em>to explore mathematical concepts</em> and <em>to generate questions</em>. However, we’re going to start with hand computation and go slow for a while, first. Humour us, for a bit, and think of it as brushing up on arithmetic with fractions.</p>
<p>In the next unit, “Rootfinding, Newton’s Method, and Dynamical Systems”, the following mysterious sequence will arise naturally; here, we just throw it down.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	1, \frac{3}{2}, \frac{17}{12}, \frac{577}{408}, \frac{665857}{470832}, \cdots
\end{equation*}\]</div>
<p>We could suggest that you <em>try</em> to guess what the rule is for generating these numbers (“guessing the next term” is a common kind of puzzle, see e.g. <a class="reference external" href="https://www.mathsisfun.com/algebra/sequences-finding-rule.html">https://www.mathsisfun.com/algebra/sequences-finding-rule.html</a>), but unless you’ve seen it before, this example is actually pretty difficult (out of the blue like this, and unmotivated).  Soon, we will show a powerful tool (the <a class="reference external" href="http://oeis.org/">Online Encyclopedia of Integer Sequences</a> OEIS) which makes this sequence, and many others, accessible. But without either experience or a powerful tool, this sequence is (in our opinion) too difficult to guess just now, because the rule is <em>nonlinear</em>.</p>
<p>Since we have mentioned it, go to the OEIS at the link above, and enter the <em>subsequence</em> of numerators <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(3\)</span>, <span class="math notranslate nohighlight">\(17\)</span>, <span class="math notranslate nohighlight">\(577\)</span>. The program at the server will then suggest that the sequence is <a class="reference external" href="http://oeis.org/A001601">A001601</a>, which indeed it is; look at the next number at that link, which is 665857, the next term above.  One of the rules given at that link (there are several) is indeed how we generated these numbers.  The OEIS is a very powerful kind of index of examples from a wide cross-section of mathematics; it is a professional tool.  Notice that this sequence has <em>several</em> explanations: it occurs in more than one context.  This is part of the power of the OEIS.</p>
<p>By entering only a <em>subsequence</em> of the data, we are employing <em>Jon Borwein’s Rule</em> mentioned in the Preamble: “don’t blow all your data on your conjecture”.  Seeing the fifth entry, which we knew but held back, gives us some confidence that this is right.</p>
<p>This is not a mathematical proof, of course: but it is evidence.  We will talk more about this.</p>
<p>Here is our first Python program: all it does is draw some squares.  If you want to modify it, and you are reading this as a Jupyter Book,  click on the icon up in the top corner to download the Jupyter notebook.  We don’t think you’ll need the Python documentation just yet (although the code might look a bit mysterious, its intentions are straightforward), but you can find the <a class="reference external" href="https://docs.python.org/3/">Python 3 documentation here</a> for when you do need it. One thing you <em>will</em> need is that to modify this code you need to be working with a Jupyter notebook, not the Jupyter Book; again, if you are reading the Jupyter Book, and you want to switch to the notebook, click the download icon in the top right corner.  <a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/">Documentation for Jupyter notebooks can be found here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">sq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">17.0</span><span class="o">/</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">577.0</span><span class="o">/</span><span class="mf">408.0</span><span class="p">]</span>  <span class="c1"># The first four terms of our mysterious sequence, as floating-point numbers</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Draw a square of side length sq[0] = 1 # &#39;r&#39; means &quot;red&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>    <span class="s1">&#39;r&#39;</span> <span class="p">)</span> <span class="c1"># line from origin to top left corner</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>    <span class="p">[</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r&#39;</span> <span class="p">)</span> <span class="c1"># line from top left to top right</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span>     <span class="s1">&#39;r&#39;</span> <span class="p">)</span> <span class="c1"># line from top right to bottom right</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">sq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span>     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>         <span class="s1">&#39;r&#39;</span> <span class="p">)</span> <span class="c1"># line from bottom right to the origin</span>

<span class="c1"># Now do a square of length sq[1] = 3/2 # &#39;k&#39; means &quot;black&quot; (use shorter code, this time)</span>
<span class="c1"># We list all x-values first, then all y-values.  We have five points because we want to </span>
<span class="c1"># draw all around the square, including back to the origin (0,0) where we started</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>  <span class="c1"># all at once: all x, all y</span>

<span class="c1"># Now do a square of length sq[2] = 17/12 # &#39;b&#39; means &quot;blue&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sq</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sq</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sq</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>  <span class="c1"># all at once: all x, all y</span>

<span class="c1"># Now do a square of length sq[3] = 577/408 # &#39;g&#39; means &quot;green&quot; (uncomment the line below to see)</span>
<span class="c1"># plt.plot( [0, sq[3], sq[3], 0, 0 ], [0, 0, sq[3], sq[3], 0], &#39;g&#39;)  # all at once: all x, all y</span>

<span class="c1"># Scale them all and draw them</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">]</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/continued-fractions_5_0.png" src="../_images/continued-fractions_5_0.png" />
</div>
</div>
<p>The code above just draws three squares (if you uncomment the “green” block and run it, it will draw four squares; but the fourth one really looks like the third one so it’s hard to see).  You should look carefully at the code to see what it is doing (pretty simple really, but programming is very fussy: missing brackets, commas, etc, can all cause headaches).  First Python notes: the comment character is <code class="docutils literal notranslate"><span class="pre">#</span></code>, and lists start indexing at 0, so <code class="docutils literal notranslate"><span class="pre">sq[0]</span></code> is the first element.  This might seem weird, but you get used to it. The other thing is one has to “import” various packages in order to do common things.  We’ll see a lot of the matplotlib package; it is very useful.</p>
<p>The squares have side lengths equal to the numbers in the sequence above.  What are the <em>areas</em> of the squares? Work out the first few, at least, by hand, and see if you can spot a pattern.  We’ll do this down below, so if you don’t feel like doing arithmetic just now, that’s ok. But, some arithmetic is coming, so you might do well with a warm-up.</p>
<p>We now return to the mysterious sequence <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(3/2\)</span>, <span class="math notranslate nohighlight">\(17/12\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span> .</p>
<p>In fact, each term <span class="math notranslate nohighlight">\(x_n\)</span> is generated from its predecessor<a class="footnote-reference brackets" href="#id9" id="id1">1</a> by the rule <span class="math notranslate nohighlight">\(x_n = \frac{1}{2}\left(x_{n-1} + \frac{2}{x_{n-1}}\right)\)</span>. This kind of thing is sometimes called a <em>recurrence relation</em> or <em>iteration</em> or <em>discrete dynamical system</em>.</p>
<p>We give a first exercise at the bottom of this unit that uses this rule to give you practice in the following three things:</p>
<ol class="simple">
<li><p>The use of mathematical subscripts to indicate a sequence</p></li>
<li><p>How to implement such a sequence “semi-manually” by using Python as a calculator</p></li>
<li><p>How to make that more efficient by using <em>ranges</em> and <em>loops</em> in Python</p></li>
</ol>
<p>Even if you can already program in Python we suggest you at least read the exercise, to make sure we’re on the same page.</p>
<p>Coming back to the iteration rule <span class="math notranslate nohighlight">\(x_n = \frac{1}{2}\left(x_{n-1} + \frac{2}{x_{n-1}}\right)\)</span>, which works for arbitrary real (or complex!) numbers <span class="math notranslate nohighlight">\(x_{n-1}\)</span>, we specialize this to the case when <span class="math notranslate nohighlight">\(x_{n-1}\)</span> is just a <em>rational</em> number, say <span class="math notranslate nohighlight">\(p_{n-1}/q_{n-1}\)</span>.  What means the same thing, if we label the numerators and denominators by <span class="math notranslate nohighlight">\(x_{n-1} = \frac{p_{n-1}}{q_{n-1}}\)</span> and <span class="math notranslate nohighlight">\(x_n = \frac{p_n}{q_n}\)</span>, we find by using rational arithmetic</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{p_n}{q_n} &amp;= \frac12\left( \frac{p_{n-1}}{q_{n-1}} + \frac{2}{p_{n-1}/q_{n-1}}\right) \\ 
                &amp;= \frac12\left( \frac{p_{n-1}}{q_{n-1}} + \frac{2q_{n-1}}{p_{n-1}}\right) \\
                &amp;= \frac{ p_{n-1}^2 + 2q_{n-1}^2}{2p_{n-1}q_{n-1}}\&gt;,
\end{align*}\]</div>
<p>after putting them over a common denominator.  This gives the following two separate equations for the numerators and denominators:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	p_n &amp;= p_{n-1}^2 + 2q_{n-1}^2\\
	q_n &amp;= 2p_{n-1}q_{n-1}.
\end{align}
\end{split}\]</div>
<p>There are a lot of questions that can be asked about this sequence, and we’ll list some below. By the end of this section, we hope that you’ll already be more comfortable asking your own. Feel free to copy that sequence on a piece of paper, “close the book” (or look away from the screen, whatever), and take ten minutes or so and write as many questions as you can, and don’t worry about the answers.</p>
<p>After having written that sentence, one of us (RMC) did that exercise, and wrote down fourteen questions in a few minutes. Two of those questions are sort of leading questions for this chapter, so we’ll reproduce them here.</p>
<ol class="simple">
<li><p>What do the numbers <span class="math notranslate nohighlight">\(x_n = \frac{p_n^2}{q_n^2}\)</span> do as <span class="math notranslate nohighlight">\(n\)</span> gets large?</p></li>
<li><p>What do the expansions in <a class="reference external" href="https://en.wikipedia.org/wiki/Continued_fraction">continued fractions</a> look like?</p></li>
</ol>
<p>Another question we’ll give away: where did this sequence and rule come from? If you really can’t wait, you can start the next chapter, where that question is given an answer. This chapter and the next are independent enough that you can do that without losing the thread of the argument. <strong>Using the “back” button works, in Jupyter Book, to get you back here when you’ve read that, if you want to</strong>.  Or, you can give us a bit more trust, and keep reading here.</p>
<blockquote class="epigraph">
<div><p>At first glance, nothing seems simpler or less significant than writing a number, say <span class="math notranslate nohighlight">\(\frac{9}{7}\)</span>, in the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\frac{9}{7} = 1 + \frac{2}{7} = 1 + \cfrac{1}{\frac{7}{2}} = 1 + \frac{1}{3 + \frac{1}{2}} = 1 + \cfrac{1}{3 + \cfrac{1}{1 + \frac{1}{1}}}.
\end{equation*}\]</div>
<p>It turns out, however, that fractions of this form, called <em>continued fractions</em> provide much insight…</p>
<p class="attribution">—from p. 3 of C. D. Olds, “Continued Fractions”, published in 1963 by The Mathematical Association of America <span id="id2">[<a class="reference internal" href="../references.html#id2">Olds, 1963</a>]</span></p>
</div></blockquote>
<p>Carl Douglas Olds won the 1973 Chauvenet Prize, the highest award for mathematical exposition, for his paper “The Simple Continued Fraction for <span class="math notranslate nohighlight">\(e\)</span>.” The book cited above is likewise a model of lucidity, and reads very well today.</p>
<p>What’s happening there? You can see that we haven’t really <em>done</em> anything, by working backwards: <span class="math notranslate nohighlight">\(1+1/1\)</span> is <span class="math notranslate nohighlight">\(2\)</span>, so <span class="math notranslate nohighlight">\(3+1/2 = 7/2\)</span>, so <span class="math notranslate nohighlight">\(1 + 2/7 = 9/7\)</span> which is what we started with. So this is just a way to rewrite a rational number.  What, exactly, did we do to get there?  What’s the process?  And what does it look like for our sequence <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(3/2\)</span>, <span class="math notranslate nohighlight">\(17/12\)</span>, and so on?</p>
<p>First, we take out the integer part. For our first two numbers, nothing much happens:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	1 &amp;= 1 \quad \text{already} \\
	\dfrac{3}{2} &amp;= 1 + \dfrac{1}{2} = 1 + \cfrac{1}{1 + \frac{1}{1}} \&gt;,
\end{align}
\end{split}\]</div>
<p>but this last isn’t much obvious use.  From now on, we’ll try to avoid ending the continued fraction with + 1/1.  In almost all cases, we will be able to do that.</p>
<p>The next number is more interesting:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	\dfrac{17}{12} &amp;= \dfrac{12 + 5}{12} \\
    &amp;= 1 + \dfrac{5}{12} \\
	&amp;= 1 + \cfrac{1}{\frac{12}{5}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \frac{2}{5}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{\frac{5}{2}}} \\
	&amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \frac{1}{2}}} \&gt;.
\end{align}
\end{split}\]</div>
<p>It looks like a pattern is emerging.</p>
<p>The crucial step in this process is writing the fractional part that we get, after taking out the integer part, as a reciprocal of another fraction:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{5}{12} = \cfrac{1}{\frac{12}{5}}.
\end{equation*}\]</div>
<p>Now a longer example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	\dfrac{577}{408} &amp;= \dfrac{408 + 169}{408} \\ 
    &amp;= 1 + \dfrac{169}{408} \\ 
    &amp;= 1 + \dfrac{1}{\frac{408}{169}} \\
	&amp;= 1 + \cfrac{1}{2 + \frac{70}{169}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{\frac{169}{70}}} \\
	&amp;= 1 + \cfrac{1}{2+\cfrac{1}{2 + \frac{29}{70}}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{\frac{70}{29}}}} \\
	&amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \frac{12}{29}}}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{\frac{29}{12}}}}} \\
	&amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \frac{5}{12}}}}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{\frac{12}{5}}}}}} \\
	&amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \frac{2}{5}}}}}} \\ 
    &amp;= 1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \frac{1}{2}}}}}}} \\
	&amp;= 1 + [2 \&gt;, 2 \&gt;, 2\&gt;, 2\&gt;, 2 \&gt;, 2 \&gt;, 2] \quad \text{for short.}
\end{align}
\end{split}\]</div>
<p>At this point, you may feel like sticking out your tongue and giving us a raspberry for such obvious cheating. Think of it like “television wrestling” and give the entertainment a chance!</p>
<div class="section" id="the-game-of-pass-the-parcel">
<h2>The game of <em>pass the parcel</em><a class="headerlink" href="#the-game-of-pass-the-parcel" title="Permalink to this headline">¶</a></h2>
<p>Who can play:
Initiator and any number<a class="footnote-reference brackets" href="#id10" id="id3">2</a> of players.</p>
<p>Initiator “0” chooses a real (decimal) number, takes the integer part (which might be <span class="math notranslate nohighlight">\(0\)</span> or even negative, this one time) and keeps it, and separates out the fractional part which should be in <span class="math notranslate nohighlight">\([0, 1)\)</span>, and passes the fractional part to the first player, call them <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Example: suppose the number chosen was <span class="math notranslate nohighlight">\(5.318309886184\)</span>; the initiator takes the integer part, <span class="math notranslate nohighlight">\(5\)</span>, and computes the fractional part <span class="math notranslate nohighlight">\(x_0 = 0.318309886184\)</span> and passes it to the first player, <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p><span class="math notranslate nohighlight">\(A\)</span> takes the number, <em>inverts it</em>, removes and keeps the integer part, and passes the new fractional part on to the next player, call them <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>In this example, <span class="math notranslate nohighlight">\(\frac{1}{0.318309886184} = 3.14159265359\)</span> and the player <span class="math notranslate nohighlight">\(A\)</span> keeps <span class="math notranslate nohighlight">\(\boxed{3}\)</span> and passes <span class="math notranslate nohighlight">\(0.14159265359\)</span> on to the next player, <span class="math notranslate nohighlight">\(B\)</span>. Each player follows these rules: 1) invert, 2) take &amp; keep integer part, 3) pass fractional part on. The game ends if the received number is zero or repeats an earlier fractional part exactly. Mostly, it won’t end! So, in practice, stop when you feel like it.</p>
<p>Here, player <span class="math notranslate nohighlight">\(B\)</span> gets <span class="math notranslate nohighlight">\(0.14159265359\)</span>, inverts to <span class="math notranslate nohighlight">\(7.06251330592\)</span>, removes and keeps <span class="math notranslate nohighlight">\(\boxed{7}\)</span> and passes <span class="math notranslate nohighlight">\(0.06251330592\)</span> to player <span class="math notranslate nohighlight">\(C\)</span>. <span class="math notranslate nohighlight">\(C\)</span> gets <span class="math notranslate nohighlight">\(0.06251330592\)</span>, inverts to <span class="math notranslate nohighlight">\(15.9965944095\)</span>, keeps <span class="math notranslate nohighlight">\(\boxed{15}\)</span>, passes <span class="math notranslate nohighlight">\(0.9965944095\)</span> to <span class="math notranslate nohighlight">\(D\)</span>. <span class="math notranslate nohighlight">\(D\)</span> inverts to <span class="math notranslate nohighlight">\(1.00341722818\)</span>, keeps <span class="math notranslate nohighlight">\(\boxed{1}\)</span> and passes <span class="math notranslate nohighlight">\(0.00341722818\)</span> to <span class="math notranslate nohighlight">\(E\)</span>. <span class="math notranslate nohighlight">\(E\)</span> inverts to <span class="math notranslate nohighlight">\(292.63483365\)</span>, keep <span class="math notranslate nohighlight">\(\boxed{292}\)</span> and passes <span class="math notranslate nohighlight">\(0.6483365\)</span> to <span class="math notranslate nohighlight">\(F\)</span>. <span class="math notranslate nohighlight">\(F\)</span> inverts to <span class="math notranslate nohighlight">\(1.57521580653\)</span>, keeps <span class="math notranslate nohighlight">\(\boxed{1}\)</span>. At this point, looking back, this means that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	5 + \dfrac{1}{\pi} = 5 + \cfrac{1}{3 + \cfrac{1}{7 + \cfrac{1}{15 + \cfrac{1}{1 + \cfrac{1}{292 + \cfrac{1}{1 + \substack{\ \\ \ \\ \ddots}}}}}}} .
\end{equation*}\]</div>
<p>Exercise: compute the difference between your starting number and the final rational number you get.  You should see that each <em>partial quotient</em> (which is what the kept integers are called) will give you at least one decimal digit of accuracy.</p>
<p><strong>Surprises</strong> Rational <span class="math notranslate nohighlight">\(x_0\)</span> always stop with 0 remainder at some point, while irrational <span class="math notranslate nohighlight">\(x_0\)</span> will never stop.  Compare with Olds’ rational example:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{355}{113} = 3 + \cfrac{1}{7 + \cfrac{1}{15 + \cfrac{1}{1}}}
\end{equation*}\]</div>
<p>which stops as claimed.</p>
<p>Several questions can arise here.  It’s a good place for the reader to pause, and write some of them down.  Here’s a few from us.  Some of them are interesting, but to be honest we’re more interested in what your questions will be.</p>
<ol class="simple">
<li><p>Do rational numbers stop after a fixed number of iterations?  Or can the game go arbitrarily long?</p></li>
<li><p>If we start with an unreduced fraction, like 18/15, does it make a difference?</p></li>
<li><p>Can we draw a picture of this process?</p></li>
<li><p>What happens if you make an arithmetic mistake somewhere in the middle?</p></li>
<li><p>Can we use negative numbers?</p></li>
<li><p>Can we use noninteger entries in the continued fraction?</p></li>
<li><p>Can we use symbols (variables)?  What does <span class="math notranslate nohighlight">\(1 + [x, 2x, x, 2x, x, 2x]\)</span> look like as a function of <span class="math notranslate nohighlight">\(x\)</span>?, for instance?</p></li>
</ol>
</div>
<div class="section" id="another-python-program">
<h2>Another Python Program<a class="headerlink" href="#another-python-program" title="Permalink to this headline">¶</a></h2>
<p>Consider the small program below, which uses a list and a loop (see the exercises at the end of this section for an introduction) to encode this process.  We have “hardwired” the loop to compute five “partial quotients” of the continued fractions; you may change that, of course, if you are reading this as a Jupyter notebook and not as a Jupyter Book. (Click on the icon up in the top corner to download the Jupyter notebook, if you are reading this as a Jupyter Book).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mf">1.414213562373095</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">f</span>
    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 2, 2, 2, 2]
</pre></div>
</div>
</div>
</div>
<p>As an exercise, you should re-type every line of that (maybe it won’t hurt to copy-and-paste the decimal approximation to <span class="math notranslate nohighlight">\(\sqrt2\)</span>—wait, what’s root 2 doing here?) and write out a comment for each line explaining what it does.  The math.floor function computes the <em>largest integer less than or equal</em> to whatever it gets called with.  The variable names (r, a, k, f) are all single-letter, which is ok for a short math program; they are sort of meaningful, even: r for root 2, ok “a” doesn’t mean much, f for “fractional part”, and then the index variable k because of the old Fortran convention: variables whose names start with the letters <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span></code>, <code class="docutils literal notranslate"><span class="pre">ell</span></code>, <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> (i.e. the letters I–N ) are commonly thought of as INtegers.  This is not part of Python—you could call your variables whatever you wanted—but it makes your programs easier to read by people who share that convention.</p>
<p>One thing we are skating past for the moment, whistling: that program uses floating point, and sometimes the behaviour is a bit weird.  To see what we mean, replace the first line with <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">17/12</span></code>, and run the program: we expect it to terminate at [1,2,2,2], but in fact it generates [1, 2, 2, 1, 1, 70368744177664].  We will not explain that at this time, but merely wave our hands and say “rounding errors”.</p>
<p>We now return to thinking about the sequence <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(3/2\)</span>, <span class="math notranslate nohighlight">\(17/12\)</span>, <span class="math notranslate nohighlight">\(577/408\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>.</p>
<p>When you think about it, it <em>is</em> a bit mysterious that the simple rule</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x_n = \dfrac1{2}{\left(x_{n-1} + \frac{2}{x_{n-1}}\right)}
\end{equation*}\]</div>
<p>can generate the continued fractions</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	1, 1 + [2], 1 + [2, 2, 2], \text{and } 1 + [2, 2, 2, 2, 2, 2, 2].
\end{equation*}\]</div>
<p>The next one,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{665857}{470832} = 1 + [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
\end{equation*}\]</div>
<p>apparently has fifteen 2’s in it; don’t worry, we’ll check that by computer, later. That’s one, three, seven, and fifteen twos. What’s next? That is an example of a puzzle sequence that is much easier for humans to get unaided, by the way. We’ll leave that for now and go back to the first question, about <span class="math notranslate nohighlight">\(x_n^2 = \frac{p_n^2}{q_n^2}\)</span>.</p>
<p>The squares of our sequence are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
    1 &amp;\&gt;, \\
    \dfrac{9}{4} &amp;= 2\dfrac{1}{4} \&gt;, \\
    \left(\dfrac{17}{12}\right)^2 &amp;= \dfrac{289}{144} = \dfrac{288 + 1}{144} = 2 + \dfrac{1}{144} = 2 + \dfrac{1}{12^2} \&gt;,\\
    \left(\dfrac{577}{408}\right)^2 &amp;= \dfrac{332929}{166464} = \dfrac{332928 + 1}{166464} = 2 + \dfrac{1}{166464} = 2 + \dfrac{1}{408^2}
\end{align}
\end{split}\]</div>
<p>and at this point, we might be prepared to bet that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x_4^2 = \left(\dfrac{665857}{470832}\right)^2 = 2 + \dfrac{1}{470832^2} \approx 2 + 4.5\cdot10^{-12}.
\end{equation*}\]</div>
<p>Checking using RMC’s phone (a Nexus 5), we see that this is, in fact, true. But what does it mean?</p>
<p>One thing it means is that our sequence can be written as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	1 = \sqrt{1},\&gt;\&gt; \dfrac32 = \sqrt{1 + \dfrac{1}{2^2}},\&gt;\&gt; \dfrac{17}{12} = \sqrt{2 + \dfrac{1}{12^2}},\&gt;\&gt; \dfrac{577}{408}=\sqrt{2 + \dfrac{1}{408^2}},\&gt;\&gt; \dfrac{665857}{470832}=\sqrt{2 + \dfrac{1}{470832^2}} \approx \sqrt{2 + 4.5\cdot10^{-12}},
\end{equation*}\]</div>
<p>that is, apart from <span class="math notranslate nohighlight">\(x_0\)</span>, a sequence of square roots of numbers that rapidly approach <span class="math notranslate nohighlight">\(2\)</span>. The denominator of <span class="math notranslate nohighlight">\(x_5\)</span> is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	q_5 = 2p_4q_4 = 2\cdot 470832 \cdot 665857 \approx 2 \cdot 500,000 \cdot 650,000 = 6.5\cdot 10^{11};
\end{equation*}\]</div>
<p>the next</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\left(\dfrac{p_5}{q_5}\right)^2 = 2 + \dfrac{1}{q_5^2} \approx 2 + 2\cdot 10^{-24},
\end{equation*}\]</div>
<p>which makes a difference from <span class="math notranslate nohighlight">\(2\)</span> by about as much as adding one molecule to a mole of material makes <a class="footnote-reference brackets" href="#id11" id="id4">3</a>. For reference, one mole of water weighs about 18.01528 grams; one molecule of water is going to be hard to detect!</p>
<p>Some more question present themselves. Does this continue? Is <span class="math notranslate nohighlight">\(x_5 = 1 + [2 \&gt;, 2 \&gt;, \ldots, 2]\)</span> with thirty-one 2’s in the continued fraction? Does <span class="math notranslate nohighlight">\(x_6\)</span> have sixty-three 2’s in it? Is <span class="math notranslate nohighlight">\(x_n^2 = 2 + \frac{1}{q_n^2}\)</span> always? Does this mean that <span class="math notranslate nohighlight">\(x_n \approx \sqrt{2}\)</span>?</p>
<!-- The techniques of the calculus answer that last. The binomial theorem says (if $a > 0$) that

$$
\begin{align}
	\left(a^2 + b\right)^{\frac{1}{2}} &= a\left(1 + \dfrac{b}{a^2}\right)^{\frac{1}{2}} \\
	&\approx a\cdot\left(1 + \dfrac{1}{2}\cdot\left(\dfrac{b}{a^2}\right) + \mathcal{O}\left(\dfrac{b}{a^2}\right)^2\right)
\end{align}
$$

where the $\mathcal{O}$ symbol means here "about the same size as." Therefore

$$
\begin{align}
	\sqrt{2 + \dfrac{1}{q_n^2}} &= \sqrt{2}\left(1 + \dfrac{1}{2q_n^2}\right)^{\frac{1}{2}} \nonumber \\
	&\approx \sqrt{2}\left(1 + \dfrac{1}{4q_n^2} + \mathcal{O}\left(\dfrac{1}{q_n^2}\right)^2\right)\>.
\end{align}
$$

In other words, $\sqrt{\ \ }$ is a continuous function: if you change its argument only a little, then its output is only a little different. Thus, $\frac{17}{12}$, being the square root of $2 + \frac{1}{144}$, ought to be close to $\sqrt{2}\left(1 + \frac{1}{288}\right)$ or different to $\sqrt{2}$ only in the third decimal place.
 -->
<p>We could use techniques from calculus to answer that last question, but let’s try just using inequalities (it’s good practice, anyway).  Suppose that <span class="math notranslate nohighlight">\(x^2 = 2+s\)</span> for some <span class="math notranslate nohighlight">\(s&gt;0\)</span>, and <span class="math notranslate nohighlight">\(y^2=2\)</span> exactly; so <span class="math notranslate nohighlight">\(y=\sqrt{2}\)</span> but we’ll try not to use any knowledge of that more than <span class="math notranslate nohighlight">\(1 &lt; y &lt; 2 \)</span>.  Then</p>
<div class="amsmath math notranslate nohighlight" id="equation-1d578dad-7df1-447d-bfac-e4f609a8984f">
<span class="eqno">(1)<a class="headerlink" href="#equation-1d578dad-7df1-447d-bfac-e4f609a8984f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
 x^2 - y^2 = (2+s) - 2 = s
\end{equation}\]</div>
<p>and, factoring the difference of squares,</p>
<div class="amsmath math notranslate nohighlight" id="equation-5095e85e-927a-4d84-9e94-9190f3b9f710">
<span class="eqno">(2)<a class="headerlink" href="#equation-5095e85e-927a-4d84-9e94-9190f3b9f710" title="Permalink to this equation">¶</a></span>\[\begin{equation}
 x - y = \frac{s}{x+y} &lt; \frac{s}{2y} &lt; \frac{s}{2}
\end{equation}\]</div>
<p>where we have used the facts that <span class="math notranslate nohighlight">\(x&gt;y\)</span> (which is because <span class="math notranslate nohighlight">\(x^2\)</span> is greater than <span class="math notranslate nohighlight">\(2\)</span>, so naturally <span class="math notranslate nohighlight">\(x\)</span> must be greater than the square root of <span class="math notranslate nohighlight">\(2\)</span>) and <span class="math notranslate nohighlight">\(y &gt; 1\)</span>, and the ordinary rules for manipulating inequalities (which, admittedly, you might not have had a lot of practice with; they are a bit annoying and fussy).</p>
<p>What does this <em>mean</em>?  We now know <span class="math notranslate nohighlight">\(0 &lt; x - \sqrt{2} &lt; s/2\)</span> if <span class="math notranslate nohighlight">\(x^2=2+s\)</span> with <span class="math notranslate nohighlight">\(s&gt;0\)</span>.  That is, if the square of your estimate is nearly <span class="math notranslate nohighlight">\(2\)</span>, then your estimate is nearly the square root of <span class="math notranslate nohighlight">\(2\)</span>.  This in technical terms establishes the <em>continuity</em> of the square root function, at least on one side.</p>
<p>Exercise: go through the steps in the case when <span class="math notranslate nohighlight">\(x^2 = 2 - s\)</span> is smaller than <span class="math notranslate nohighlight">\(2\)</span> and see if you can reach a similar conclusion.</p>
<p>Or, we can just draw it.  The following figure shows the case where <span class="math notranslate nohighlight">\(x^2 = 2 + s\)</span> is bigger than <span class="math notranslate nohighlight">\(2\)</span>.  As an exercise, alter the plot so it shows the case where <span class="math notranslate nohighlight">\(s\)</span> is negative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">501</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">17</span><span class="o">/</span><span class="mi">12</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">two</span><span class="o">=</span> <span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>  <span class="c1"># The black line is y=x^2.  On the tiny scale plotted it looks pretty linear.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">r2</span><span class="p">,</span><span class="n">r2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">two</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">r2</span><span class="p">],</span> <span class="p">[</span><span class="n">two</span><span class="p">,</span><span class="n">two</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="c1"># Scale them all and draw them</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="p">[</span><span class="mf">1.40</span><span class="p">,</span> <span class="mf">1.42</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="p">[</span><span class="mf">1.99</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span> <span class="s1">&#39;$x^2 = 2+s$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.125</span><span class="p">,</span><span class="mf">0.87</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;figure fraction&#39;</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span> <span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.92</span><span class="p">,</span><span class="mf">0.075</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;figure fraction&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.775</span><span class="p">,</span><span class="mf">0.075</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;figure fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/continued-fractions_14_0.png" src="../_images/continued-fractions_14_0.png" />
</div>
</div>
<p>Looking back at that plot, we see that the horizontal distance from <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> is pretty clearly less than half the vertical distance from <span class="math notranslate nohighlight">\(2+s\)</span> to <span class="math notranslate nohighlight">\(2\)</span>.  That is the graphical interpretation of the inequality that we derived up above.  You can also see the source of our “could have used calculus” remark, because it is <em>the slope of the curve</em> (which looks pretty linear on this scale) at <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> that determines the relationship of the horizontal width to the vertical width.  Well, actually, that’s kind of the start of <em>real analysis</em>; we will leave things at that.</p>
<p>Exercise: What happens with <span class="math notranslate nohighlight">\([1,2,2]\)</span>, <span class="math notranslate nohighlight">\([1,2,2,2,2]\)</span>, <span class="math notranslate nohighlight">\([1,2,2,2,2,2,2,2,2]\)</span> instead?  That is, with two 2s, four 2s, eight 2s, etc?
With any even number of twos?  With any odd number of twos?  If you see a pattern emerging, can you prove it?</p>
<!--  Can we get them to guess that an odd number means x^2 > 2 and an even number means x^2 < 2, we are a long way towards proof of convergence; but even a bracketing theorem is valuable
  -->
<p>Indeed for example we have <span class="math notranslate nohighlight">\((17/12)^2 = 2 + 1/144\)</span> so we expect that the difference between <span class="math notranslate nohighlight">\(17/12\)</span> and <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> should be smaller than <span class="math notranslate nohighlight">\(1/288\)</span>.  By direct computation,</p>
<div class="amsmath math notranslate nohighlight" id="equation-748087c5-5852-45f2-a4a7-1e1d4d2500cb">
<span class="eqno">(3)<a class="headerlink" href="#equation-748087c5-5852-45f2-a4a7-1e1d4d2500cb" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	\dfrac{17}{12} = 1.416666\ldots
\end{equation}\]</div>
<p>while</p>
<div class="amsmath math notranslate nohighlight" id="equation-d94eac21-5d30-455c-8fc3-70ce7c75e893">
<span class="eqno">(4)<a class="headerlink" href="#equation-d94eac21-5d30-455c-8fc3-70ce7c75e893" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	\sqrt{2} \approx 1.4142\ldots
\end{equation}\]</div>
<p>and <span class="math notranslate nohighlight">\(17/12-\sqrt{2} = 0.002453\ldots\)</span> while <span class="math notranslate nohighlight">\(1/288=0.00347\dot{2}\)</span> in agreement with our theorizing.</p>
<p>Here’s another question. What is</p>
<div class="amsmath math notranslate nohighlight" id="equation-4a8cafa6-79df-447a-8a1c-b6490af8eb8f">
<span class="eqno">(5)<a class="headerlink" href="#equation-4a8cafa6-79df-447a-8a1c-b6490af8eb8f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	1 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \cfrac{1}{2 + \substack{\ \ \\ \\ \ddots}}}}}
\end{equation}\]</div>
<p>where the 2’s continue forever? Does this make sense? At this point, many people are surprised at the perfect predictability, and repeating nature, of this continued fraction, because it is indeed true that with quite natural definitions, this infinite continued fraction can only be <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>.</p>
<p>But “everybody knows” that the decimal expansion for <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> does not repeat, because <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> is irrational! Why is this different? Is it something special about <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>? (Of course a continued fraction is not a decimal expansion.)</p>
<p>To answer that, we do some more examples. At this point, it’s helpful if everyone in the class takes a different starting point, i.e. a different number. We’ll do <span class="math notranslate nohighlight">\(\sqrt{3}\)</span> here, but people should try lots of things: <span class="math notranslate nohighlight">\(\sqrt{4}\)</span> is boring, but <span class="math notranslate nohighlight">\(\sqrt{5}\)</span> is interesting, <span class="math notranslate nohighlight">\(\frac{\left(1 + \sqrt{5}\right)}{2}\)</span> even more so. It’s a bold move to think about cube roots, or <span class="math notranslate nohighlight">\(\ln(2)\)</span>.  How about <span class="math notranslate nohighlight">\(e\)</span>, or <span class="math notranslate nohighlight">\(\pi = 3.14159\ldots\)</span>?</p>
<p>Now <span class="math notranslate nohighlight">\(\sqrt{3} \approx 1.732\ldots\)</span> (All we needed was that <span class="math notranslate nohighlight">\(1 &lt; \sqrt{3} &lt; 2\)</span> so the integer part of <span class="math notranslate nohighlight">\(\sqrt{3}\)</span> is <span class="math notranslate nohighlight">\(1\)</span>.) Thus</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\sqrt{3} = 1 + \left(\sqrt{3} - 1\right) = 1 + \cfrac{1}{\cfrac{1}{\sqrt{3} - 1}}.
\end{equation*}\]</div>
<p>Now</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	\dfrac{1}{\sqrt{3}-1} &amp;= \dfrac{1}{\sqrt{3} - 1} \cdot \left(\dfrac{\sqrt{3} + 1}{\sqrt{3} + 1}\right) \\ 
    &amp;= \dfrac{\sqrt{3} + 1}{\left(\sqrt{3}\right)^2 - 1^2} \\ 
    &amp;= \dfrac{\sqrt{3} + 1}{2} \\
	&amp;= \dfrac{2 + \left(\sqrt{3}-1\right)}{2} \\ 
    &amp;= 1 + \dfrac{\left(\sqrt{3} - 1\right)}{2} \\ 
    &amp;= 1 + \cfrac{1}{\cfrac{2}{\sqrt{3} - 1}}
\end{align}
\end{split}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{2}{\sqrt{3} - 1} = \dfrac{2}{\sqrt{3} - 1}\left(\dfrac{\sqrt{3} + 1}{\sqrt{3} + 1}\right) = \dfrac{2\cdot \left(\sqrt{3} + 1\right)}{\left(\sqrt{3}\right)^2 - 1^2} = \sqrt{3} + 1
\end{equation*}\]</div>
<p>by the same trick;</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	= 2 + \left(\sqrt{3} - 1\right).
\end{equation*}\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	\sqrt{3} - 1 &amp;= \dfrac{1}{1 + \frac{1}{2}\left(\sqrt{3} - 1\right)} \\
    &amp;= \dfrac{1}{1 + \cfrac{1}{2 + \left(\sqrt{3} - 1\right)}} \\
	&amp;= \cfrac{1}{1 + \cfrac{1}{2 + \cfrac{1}{1 + \cfrac{1}{2 + \left(\sqrt{3} - 1\right)}}}}
\end{align}
\end{split}\]</div>
<p>by repeating the substitution. This suggests that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\sqrt{3} = 1 + [1, 2, 1, 2, 1, 2, 1, 2, 1, 2, \ldots],
\end{equation*}\]</div>
<p>which is, indeed, true<a class="footnote-reference brackets" href="#id12" id="id5">4</a>. So we can have repeating continued fractions from other things besides <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>.</p>
<p>Here are some others to try: <span class="math notranslate nohighlight">\(e = 2.7182818284\ldots\)</span>, <span class="math notranslate nohighlight">\(\sqrt{13}\)</span>, <span class="math notranslate nohighlight">\(3^{\frac{1}{3}}\)</span>, <span class="math notranslate nohighlight">\(5^{\frac{1}{5}}\)</span>, <span class="math notranslate nohighlight">\(\gamma = 0.577\ldots\)</span> (the Euler-Mascheroni constant), <span class="math notranslate nohighlight">\(\pi\)</span>, <span class="math notranslate nohighlight">\(\pi^2\)</span>, <span class="math notranslate nohighlight">\(\sqrt{\pi}\)</span>, <span class="math notranslate nohighlight">\(e^{\frac{1}{e}}\)</span>, <span class="math notranslate nohighlight">\(\pi^{\pi}\)</span>, <span class="math notranslate nohighlight">\(e^{\pi}\)</span>.</p>
<div class="section" id="warning-the-python-arithmetic-changes-when-we-import-sympy-symbolic-python">
<h3>Warning: the Python arithmetic changes when we import SymPy (“Symbolic Python”)<a class="headerlink" href="#warning-the-python-arithmetic-changes-when-we-import-sympy-symbolic-python" title="Permalink to this headline">¶</a></h3>
<p>SymPy has a class <code class="docutils literal notranslate"><span class="pre">Rational</span></code> which allows us to perform exact rational arithmetic, and also exact arithmetic on some exact numbers like <span class="math notranslate nohighlight">\(\sqrt{3}\)</span>.  We also import a pretty fancy piece of code called a “continued fraction iterator”.  It’s a power tool; go ahead and use it if you like.  We didn’t write it, though—better give you <a class="reference external" href="https://docs.sympy.org/latest/modules/ntheory.html">a link to the docs</a> (some of us haven’t read them, so we could hardly blame you if you don’t).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="kn">import</span> <span class="n">continued_fraction_iterator</span>

<span class="k">def</span> <span class="nf">confrac</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">expr</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the first 7 partial quotients of the continued fraction of sqrt(3)</span>
<span class="n">confrac</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 1, 2, 1, 2, 1, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the first 10 partial quotients of the continued fraction of 1/pi</span>
<span class="n">confrac</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">pi</span><span class="p">)),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 3, 7, 15, 1, 292, 1, 1, 1, 2]
</pre></div>
</div>
</div>
</div>
<p>Question: Is that code correct?  Does it actually produce an approximation to <span class="math notranslate nohighlight">\(1/\pi\)</span>?  Let’s see.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">292</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="p">)))))))))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3183098861846737
0.318309886183791
</pre></div>
</div>
</div>
</div>
<p>A little different, but believably within tolerance.</p>
</div>
</div>
<div class="section" id="programming-as-a-method-of-validation">
<h2>Programming as a method of validation<a class="headerlink" href="#programming-as-a-method-of-validation" title="Permalink to this headline">¶</a></h2>
<p>Consider the assertion about that <span class="math notranslate nohighlight">\(\sqrt{3} = 1 + \overline{[1 \&gt;, 2]}\)</span> where <span class="math notranslate nohighlight">\(\overline{[1 \&gt;, 2]}\)</span> means the infinite repeating continued fraction</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\cfrac{1}{1 + \cfrac{1}{2 + \cfrac{1}{1 + \cfrac{1}{2 + \cfrac{1}{\ddots}}}}}.
\end{equation*}\]</div>
<p>We will show in a moment a Python program to compute the successive truncations of  this fraction, namely <span class="math notranslate nohighlight">\([1]\)</span>, <span class="math notranslate nohighlight">\([1 \&gt;, 2]\)</span>, <span class="math notranslate nohighlight">\([1 \&gt;, 2 \&gt;, 1]\)</span>, and so on.</p>
<!-- The program we exhibit below is intended to show some features of Maple programming, but not to be the "best possible'' program for this particular computation. Here, simplest is best.

The basic idea of the program is that we will convert at each step
\begin{equation}
	1 + \left[1 \>, 2 \>, 1 \>, 2 \>, \ldots, \frac{a_{n-1}}{(a_n + s)}\right]
\end{equation}
to
\begin{equation}
	1 + \left[1 \>, 2 \>, 1 \>, 2 \>, \ldots, a_{n-1} + \frac{1}{(a_n + s)}\right]
\end{equation}
because
\begin{equation}
	\cfrac{\ddots}{a_{n-1} + \cfrac{1}{(a_n + s)}}
\end{equation}
can be written in our $\left[ \ \ \right]$ notation in either way. The program exhibits several useful features of Python programming: the most important of which is _assignment_, as in `a = 2;` which means the  variable named `a` is assigned the value 2, or as in `a = 1;` which means the variable `a` is assigned the value 1. The `def function():` block denotes a procedure body, intended to perform the statements contained in the body, each time the procedure is invoked. By assigning the procedure body to the name `bottomup3` we allow easy invocation, e.g. --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A program to convert a list of partial quotients to a convergent</span>
<span class="k">def</span> <span class="nf">list_to_frac</span><span class="p">(</span><span class="n">inputlist</span><span class="p">):</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">inputlist</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">expr</span> <span class="o">+=</span> <span class="n">i</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">expr</span>
    <span class="k">return</span><span class="p">(</span><span class="n">expr</span> <span class="o">+</span> <span class="n">inputlist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">cfrac1</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Partial quotients of sqrt(3) when n = &#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">cfrac1</span><span class="p">)</span>
<span class="n">list_to_frac</span><span class="p">(</span><span class="n">cfrac1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Partial quotients of sqrt(3) when n =  1 : [1, 1]
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 2\]</div>
</div>
</div>
<p>which results in the answer 2, which is <span class="math notranslate nohighlight">\(1 + \frac{1}{1}\)</span>, the depth <span class="math notranslate nohighlight">\(n=1\)</span> continued fraction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">cfrac2</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Partial quotients of sqrt(3) when n = &#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">cfrac2</span><span class="p">)</span>
<span class="n">list_to_frac</span><span class="p">(</span><span class="n">cfrac2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Partial quotients of sqrt(3) when n =  2 : [1, 1, 2]
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{5}{3}\]</div>
</div>
</div>
<p>yields <span class="math notranslate nohighlight">\(\frac{5}{3}\)</span>, which is <span class="math notranslate nohighlight">\(1 + \frac{1}{(1 + \frac{1}{2})}\)</span>. the depth 2 continued fraction. We can now ask for as many <em>convergents</em> (as they are called) as we wish, or have patience for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">cfrac</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cfrac</span><span class="p">)</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="n">list_to_frac</span><span class="p">(</span><span class="n">cfrac</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result of continued fraction:&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n =  1
[1, 1]
Result of continued fraction: 2 or 2.00000000000000
n =  2
[1, 1, 2]
Result of continued fraction: 5/3 or 1.66666666666667
n =  3
[1, 1, 2, 1]
Result of continued fraction: 7/4 or 1.75000000000000
n =  4
[1, 1, 2, 1, 2]
Result of continued fraction: 19/11 or 1.72727272727273
n =  5
[1, 1, 2, 1, 2, 1]
Result of continued fraction: 26/15 or 1.73333333333333
</pre></div>
</div>
</div>
</div>
<p>This loop produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	2  &amp;\\
	\dfrac{5}{3} &amp;= 1.66\ldots \\
	\dfrac{7}{4} &amp;= 1.75 \\
	\dfrac{19}{11} &amp;= 1.72727 \ldots \\
	\dfrac{26}{15} &amp;= 1.733 \ldots 
\end{align}
\end{split}\]</div>
<p>The noticing sort of person might see that these are alternating larger and smaller than <span class="math notranslate nohighlight">\(\sqrt{3}\)</span>. These don’t seem to be approaching <span class="math notranslate nohighlight">\(\sqrt{3}\)</span> all that fast, compared to our memory of the <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> example. But when we go back and look again, we see that it took <em>fifteen</em> 2’s to get us to <span class="math notranslate nohighlight">\(12\)</span> decimal place accuracy, so we try</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">cfrac15</span> <span class="o">=</span> <span class="n">confrac</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Partial quotients of sqrt(3) when n = &#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">cfrac15</span><span class="p">)</span>
<span class="n">list_to_frac</span><span class="p">(</span><span class="n">cfrac15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Partial quotients of sqrt(3) when n =  15 : [1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1]
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{18817}{10864}\]</div>
</div>
</div>
<p>To evaluate this to floating-point, <code class="docutils literal notranslate"><span class="pre">sympy.N()</span></code>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">list_to_frac</span><span class="p">(</span><span class="n">cfrac15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 1.73205081001473\]</div>
</div>
</div>
<p>Now, let’s express <span class="math notranslate nohighlight">\(\sqrt{3}\)</span> in decimals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 1.73205080756888\]</div>
</div>
</div>
<p>These should be comparable; we see that the error is <span class="math notranslate nohighlight">\(\mathcal{O}(10^{-9})\)</span>, not as good as that for <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> but not bad.</p>
<div class="section" id="working-backwards">
<h3>Working backwards<a class="headerlink" href="#working-backwards" title="Permalink to this headline">¶</a></h3>
<p>What is <span class="math notranslate nohighlight">\(1 + \left[3 \&gt;, 3 \&gt;, 3\&gt;, \ldots \right]\)</span>?</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x = 1 + \dfrac{1}{y}
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(y = 3 + \frac{1}{y}\)</span> <em>i.e.</em> <span class="math notranslate nohighlight">\(y^2 - 3y - 1 = 0\)</span> <em>i.e.</em> <span class="math notranslate nohighlight">\(y = \frac{3 \pm \sqrt{9 + 4}}{2} = \frac{3 + \sqrt{13}}{2}\)</span> because negative sign gives negative answer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	x &amp;= 1 + \dfrac{2}{3 + \sqrt{13}} \\
	&amp;= \dfrac{5 + \sqrt{13}}{3 + \sqrt{13}} \\ 
    &amp;= \dfrac{\left(5 + \sqrt{13}\right)\left(-3 + \sqrt{13}\right)}{-3^2 + 13} \\ 
    &amp;= \dfrac{\left(-15 + 2\sqrt{13} + 13\right)}{4} \\
	&amp;= \dfrac{-2 + 2\sqrt{13}}{4} \\ 
    &amp;= \dfrac{\sqrt{13} - 1}{2} \approx 1.30277563773\ldots
\end{align}
\end{split}\]</div>
<p>One can check on a calculator.</p>
</div>
<div class="section" id="working-forwards">
<h3>Working <em>forwards</em><a class="headerlink" href="#working-forwards" title="Permalink to this headline">¶</a></h3>
<p>If you try to compute a continued fraction from the bottom up, and the continued fraction is infinite, you have to decide where to truncate and then work backwards as we have been doing above.  If you decide at the end that you aren’t happy with the accuracy you obtained, you have to go back, truncate the continued fraction farther down, and do it again.  This is annoying.</p>
<p>There is also a better way.  If the simple continued fraction is [<span class="math notranslate nohighlight">\(a_0\)</span>; <span class="math notranslate nohighlight">\(a_1\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span> ] then the first two approximants are <span class="math notranslate nohighlight">\(a_0/1\)</span> and <span class="math notranslate nohighlight">\((a_0a_1 + 1)/a_1\)</span>, so we at least have something to start with.  Call the <span class="math notranslate nohighlight">\(n\)</span>th approximant <span class="math notranslate nohighlight">\(x_n\)</span> and write it as the rational number <span class="math notranslate nohighlight">\(p_n/q_n\)</span>.  So <span class="math notranslate nohighlight">\(x_0 = a_0/1\)</span> and so <span class="math notranslate nohighlight">\(p_0=a_0\)</span> and <span class="math notranslate nohighlight">\(q_0=1\)</span>.  Then <span class="math notranslate nohighlight">\(p_1 = a_1a_0 + 1\)</span> and <span class="math notranslate nohighlight">\(q_1 = a_1\)</span>.  “It can be shown that”</p>
<div class="amsmath math notranslate nohighlight" id="equation-65cbf6df-65c7-416a-81bf-2b1a418892df">
<span class="eqno">(6)<a class="headerlink" href="#equation-65cbf6df-65c7-416a-81bf-2b1a418892df" title="Permalink to this equation">¶</a></span>\[\begin{align}
 p_{n+1} &amp;= a_{n+1}p_n + p_{n-1} \\
 q_{n+1} &amp;= a_{n+1}q_n + q_{n-1}
\end{align}\]</div>
<p>and this allows us to work <em>forward</em> until we are happy with our approximation.  In the typical unit on continued fractions, one proves that the true answer is <em>trapped between</em> successive convergents, and so the error is less than the difference between two successive convergents.</p>
<p>If you want a mathematical proof, you can find one <em>very</em> clearly written out in Olds’ book on pages 21-24. The <a class="reference external" href="https://en.wikipedia.org/wiki/Continued_fraction">Wikipedia article</a> has the theorems but not the proofs.  The proof in Olds is by induction, and we do recommend that you try to prove it yourself.</p>
<p>But if you don’t want to prove it, you should at least program it.  Here’s our program. Once we finished debugging, it successfully computed the value of the list of the partial quotients of the continued fraction for <span class="math notranslate nohighlight">\(e\)</span>.</p>
<p><strong>Remark on Indexing</strong> Above we have used <span class="math notranslate nohighlight">\(x_0 = p_0/q_0\)</span> to start, indexing from <span class="math notranslate nohighlight">\(0\)</span> like Python; Olds uses <span class="math notranslate nohighlight">\(x_1 = p_1/q_1\)</span> to start, indexing from <span class="math notranslate nohighlight">\(1\)</span> like Maple.  There are a variety of conventions in place, and one must be careful.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute and return successive elements of the continued fraction.</span>
<span class="c1"># For the base case with just one entry, return the correct a[1]/1 and 0 (could have been &quot;undefined&quot;)</span>
<span class="c1"># Code translated by Maple&#39;s CodeGeneration[Python]</span>
<span class="k">def</span> <span class="nf">forward</span> <span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p1</span> <span class="o">+</span> <span class="n">p0</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">q1</span> <span class="o">+</span> <span class="n">q0</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="n">p1</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="n">p</span>
            <span class="n">q0</span> <span class="o">=</span> <span class="n">q1</span>
            <span class="n">q1</span> <span class="o">=</span> <span class="n">q</span>
        <span class="k">return</span><span class="p">(</span><span class="n">p1</span> <span class="o">/</span> <span class="n">q1</span><span class="p">,</span> <span class="n">p0</span> <span class="o">/</span> <span class="n">q0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ex1</span><span class="p">,</span><span class="n">ex0</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">ex1</span><span class="p">,</span> <span class="n">ex0</span><span class="p">,</span> <span class="n">ex1</span><span class="o">-</span><span class="n">ex0</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.7182818284585633 2.718281828470584 -1.2020606732221495e-11
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="games">
<h3>Games<a class="headerlink" href="#games" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Who can find <span class="math notranslate nohighlight">\(x_0 \in (0, 1)\)</span> that gives the biggest partial quotients? The longest transient? The longest period? In the first 5, 10? Obviously taking <span class="math notranslate nohighlight">\(x_0 = [1, N]\)</span> for <span class="math notranslate nohighlight">\(N\)</span> arbitrarily large works–but a quadratic? a cubic? How about a root of an equation with only coefficients <span class="math notranslate nohighlight">\(\pm 1\)</span>? How about the smallest partial quotients?</p></li>
<li><p>Who can write the shortest code? The fastest? the most general?</p></li>
</ol>
</div>
<div class="section" id="the-gauss-map">
<h3>The Gauss Map<a class="headerlink" href="#the-gauss-map" title="Permalink to this headline">¶</a></h3>
<p>The pass the parcel map from the game can be expressed mathematically as follows, where <code class="docutils literal notranslate"><span class="pre">frac</span></code> means “take the fractional part”:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x_0 \to \mathrm{frac}\left(\frac{1}{x_0}\right)
\end{equation*}\]</div>
<p>Define</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	G(x) =
	\begin{cases}
	\mathrm{frac}\left(\frac{1}{x}\right) &amp; x \neq 0 \\
	0 &amp; x = 0
	\end{cases}
\end{equation*}\]</div>
<p>then the 1st parcel is <span class="math notranslate nohighlight">\(G(x_0)\)</span> <em>i.e.</em> <span class="math notranslate nohighlight">\(x_1 = G(x_0)\)</span>, 2nd parcel is <span class="math notranslate nohighlight">\(G(x_1)\)</span> <em>i.e.</em> <span class="math notranslate nohighlight">\(x_2 = G(x_1)\)</span>, etc.</p>
<p><em>Draw <span class="math notranslate nohighlight">\(G(x)\)</span></em> (This is harder to do nicely than it seems it ought to be).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">G</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vecG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10001</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">vecG</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k,&#39;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/continued-fractions_45_0.png" src="../_images/continued-fractions_45_0.png" />
</div>
</div>
<p>However, from the figure above, we can observe that the lines become increasing unclear as <span class="math notranslate nohighlight">\(x\)</span> approaches 0. Therefore, instead of computing the corresponding <span class="math notranslate nohighlight">\(y\)</span>-values for linearly spaced <span class="math notranslate nohighlight">\(x\)</span>-values, we can plot this problem by computing the inverse.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
    y &amp;= G(x) = \frac{1}{x} \\
    \frac{1}{x} &amp;= n + y \\
    x &amp;= \frac{1}{n+y}
\end{align}
\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(n = 0, 1, 2, 3, \ldots\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">recip</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">t</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span> <span class="n">recip</span> <span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/continued-fractions_47_0.png" src="../_images/continued-fractions_47_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="floating-point-issues">
<h2>Floating-point issues<a class="headerlink" href="#floating-point-issues" title="Permalink to this headline">¶</a></h2>
<p>If one tries to do continued fractions with floating-point arithmetic (e.g. on a calculator) then some “interesting” issues arise. Many instructors won’t know how to handle them, either—they’re not in any book that we know of, just some papers. But if the student is <em>not</em> interested, the facts may seem dull as well as confusing.  Almost no-one likes dealing with rounding error.  <em>In this particular case</em> though, there is a uniform <a class="reference external" href="https://en.wikipedia.org/wiki/Shadowing_lemma">“shadowing”</a> theorem: if one is working in arithmetic with unit roundoff <span class="math notranslate nohighlight">\(\mu\)</span> (for IEEE double precision, <span class="math notranslate nohighlight">\(\mu = 2^{-53} \approx 10^{-16}\)</span>) then the computed <span class="math notranslate nohighlight">\(x_k\)</span> from the pass-the-parcel game are the <em>exact</em> <span class="math notranslate nohighlight">\(x_k\)</span> for some slightly different starting point <span class="math notranslate nohighlight">\(x_0^*\)</span> which differs <em>at most</em> from <span class="math notranslate nohighlight">\(x_0\)</span> by <span class="math notranslate nohighlight">\(4\mu\)</span>.  There are still subtleties lying around here, because in floating-point, orbits must ultimately be periodic; and by Lagrange’s theorem, these can only be from quadratic irrational <span class="math notranslate nohighlight">\(x_0\)</span>.  These are a set of <em>measure zero</em> in the reals; so we have the paradoxical result that floating-point simulation gives us results that almost surely can’t arise if one chooses a true real number <span class="math notranslate nohighlight">\(x_0\)</span> “at random”.  This might be an interesting point of departure for a discussion with the students.  The link above is to some fairly deep mathematics, but for the Gauss map, everything can be constructed explicitly.</p>
<p>We start with an example.</p>
<div class="section" id="using-decimal-arithmetic-to-compute-these">
<h3>Using Decimal Arithmetic to compute these<a class="headerlink" href="#using-decimal-arithmetic-to-compute-these" title="Permalink to this headline">¶</a></h3>
<p>Start “pass the parcel” with <span class="math notranslate nohighlight">\(3.14\)</span>. The originator keeps <span class="math notranslate nohighlight">\(\boxed{3}\)</span> and passes <span class="math notranslate nohighlight">\(0.14\)</span> to <span class="math notranslate nohighlight">\(A\)</span>. <span class="math notranslate nohighlight">\(A\)</span> inverts on a <span class="math notranslate nohighlight">\(3\)</span> digit calculator (yes, we have one that can be set that way!) to get <span class="math notranslate nohighlight">\(7.143\)</span>; <span class="math notranslate nohighlight">\(A\)</span> keeps <span class="math notranslate nohighlight">\(\boxed{7}\)</span> and passes <span class="math notranslate nohighlight">\(0.143\)</span> to <span class="math notranslate nohighlight">\(B\)</span>. <span class="math notranslate nohighlight">\(B\)</span> inverts to get <span class="math notranslate nohighlight">\(7.000\)</span>, keeps <span class="math notranslate nohighlight">\(\boxed{7}\)</span>, and the game stops<a class="footnote-reference brackets" href="#id13" id="id6">5</a>. This suggests</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	3.14 = 3 + \cfrac{1}{7 + \cfrac{1}{7}},
\end{equation*}\]</div>
<p>but is it? Using rational arithmetic, <span class="math notranslate nohighlight">\(3 + \left[7 \&gt;, 7\right]\)</span> is <span class="math notranslate nohighlight">\(3\frac{7}{50} = 3\frac{14}{100}\)</span> which is <span class="math notranslate nohighlight">\(3.14\)</span>. So, it worked!</p>
<p>This kind of thing can get annoying. It’s not <em>much</em> of a problem if there are only human players, because they can argue a bit about when to stop, and reach sensible conclusions. The calculator if <em>it’s</em> playing can’t do that, and might return</p>
<div class="amsmath math notranslate nohighlight" id="equation-4f6384e7-edd0-4ab0-bd55-1aaa3cc9831b">
<span class="eqno">(7)<a class="headerlink" href="#equation-4f6384e7-edd0-4ab0-bd55-1aaa3cc9831b" title="Permalink to this equation">¶</a></span>\[\begin{equation}
	3 + \left[7, 6, 1, 7142857142, 1, 6, 6, 1, 125313283, \ldots\right]
\end{equation}\]</div>
<p>and keep going from there, with the really large numbers indicating that something unexpected happened; to explain this, we’ll need a bit more theory. But first another example. We compute <span class="math notranslate nohighlight">\(\frac{10}{3}\)</span> on our calculator (an HP48G+, vintage 1995 or so: there are free simulators available, so you can play along):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
	\frac{10}{3} =\ &amp;3.33333333333 \to \boxed{3} \\
	\text{invert} &amp;\phantom{0}.333333333333 \text{ get } 3.00000000003 \to \boxed{3} \\
	\text{invert} &amp;\phantom{0}.00000000003 \text{ get } 33333333333.3 \to \boxed{33333333333} \\
	\text{invert} &amp;\phantom{0}.3 \text{ get } 3.33333333333 \to \boxed{3} \\
	\text{invert} &amp;\phantom{0}.33333333333 \text{ get } 3.00000000003 \to \boxed{3}
\end{align*}
\end{split}\]</div>
<p>and the game ends because of the <em>repeat</em> rule. So instead of</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{10}{3} = 3\dfrac{1}{3}
\end{equation*}\]</div>
<p>the calculator got</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\dfrac{10}{3} \stackrel{?}{=} 3 + \cfrac{1}{3 + \cfrac{1}{33333333333 + \cfrac{1}{3 + \cfrac{1}{3 + \cfrac{1}{33\ldots3 + \substack{\ \\ \ \\ \ddots}}}}}}.
\end{equation*}\]</div>
<p>Because it’s repeating, we can actually figure out what that number is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x = 3 + \cfrac{1}{3 + \cfrac{1}{N + \cfrac{1}{x}}}
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(N = 33333333333\)</span> (We’ve used this trick without comment: it is a bit suspicious, but we assure you it’s okay here and can be rigourously justified). Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	x &amp;= 3 + \cfrac{1}{3 + \cfrac{x}{Nx + 1}} = 3 + \dfrac{Nx + 1}{3Nx + 3 + x} \\
	&amp;= \dfrac{9Nx + 9 + 3x + Nx + 1}{3Nx + x + 3}
\end{align}
\end{split}\]</div>
<p>so</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x(3Nx + x + 3) = (9N + N + 3)x + 10
\end{equation*}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	(3N + 1)x^2 - (10N)x - 10 = 0
\end{equation*}\]</div>
<p>so</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x = \dfrac{10N \pm \sqrt{100N^2 + 40(3N+1)}}{2(3N + 1)} .
\end{equation*}\]</div>
<p>If we compute this to <span class="math notranslate nohighlight">\(30\)</span> Digits in Python, like so, we can understand what’s happening</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">33333333333</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">eqn</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">10</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqn</span><span class="p">)</span>
<span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.00000000000299999999997600000e-11, 3.33333333333000000000003000000]
</pre></div>
</div>
</div>
</div>
<p>We ignore the negative root. We see the problem more clearly: <span class="math notranslate nohighlight">\(x\)</span> is <em>not</em> <span class="math notranslate nohighlight">\(\frac{10}{3}\)</span> but instead is very close to it. We have computed not the continued fraction for <span class="math notranslate nohighlight">\(\frac{10}{3}\)</span>, but rather the continued fraction for a number that is very close to <span class="math notranslate nohighlight">\(\frac{10}{3}\)</span>, because of rounding error.</p>
<p>[Computing continued fractions this way <em>always</em> get the exact continued fraction for a number very close—depending on the precision used—to the one we wanted. In the language of the numerical analyst, this algorithm is <em>numerically stable</em>.]<span id="id7">[<a class="reference internal" href="../references.html#id3">Corless, 1992</a>]</span></p>
<p>Notice how different the continued fractions are, though</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	3 + [3]
\end{equation*}\]</div>
<p>versus</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	3 + \left[3, N, 3, 3, N, 3, 3, N, \ldots \right]
\end{equation*}\]</div>
<p>Nearby numbers will have continued fractions that agree only for a short initial segment (here, only two partial quotients). You should try to convince yourself that, say</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	x = 1 + \left[2, 2, 2, 2, 2 \right]
\end{equation*}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	y = 1 + \left[2, 2, 2, 2, 2, M \right]
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(M = 1000\)</span>, say, are quite close; <span class="math notranslate nohighlight">\(x \approx y\)</span>. They’ll be closer yet if <span class="math notranslate nohighlight">\(M = 10^6\)</span>, and closer yet again if <span class="math notranslate nohighlight">\(M = 10^{10}\)</span>. Try it and see.</p>
</div>
</div>
<div class="section" id="random-facts-about-continued-fractions">
<h2>Random  Facts about Continued Fractions<a class="headerlink" href="#random-facts-about-continued-fractions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euclid-s-algorithm-for-greatest-common-divisor">
<h3>Euclid’s algorithm for greatest common divisor.<a class="headerlink" href="#euclid-s-algorithm-for-greatest-common-divisor" title="Permalink to this headline">¶</a></h3>
<p>Suppose we compute the continued fraction for a rational number, <span class="math notranslate nohighlight">\(p/q\)</span>. It turns out the steps of the algorithm above—that is, applying the Gauss map and remembering the integer parts that arise—is exactly Euclid’s algorithm for finding the greatest common divisor of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.  Take for instance <span class="math notranslate nohighlight">\(16/10\)</span>. The integer part is <span class="math notranslate nohighlight">\(1\)</span> and we have <span class="math notranslate nohighlight">\(6/10\)</span> as the fractional part; invert it to get <span class="math notranslate nohighlight">\(10/6\)</span> which has integral part <span class="math notranslate nohighlight">\(1\)</span> again and fractional part <span class="math notranslate nohighlight">\(4/6\)</span>; invert that to get <span class="math notranslate nohighlight">\(6/4\)</span> with integral part <span class="math notranslate nohighlight">\(1\)</span> again and fractional part <span class="math notranslate nohighlight">\(2/4\)</span>; invert again to get <span class="math notranslate nohighlight">\(4/2\)</span> and now we have an exact division to get <span class="math notranslate nohighlight">\(2\)</span> (which is the GCD).  We can also (according to our rule, we don’t do this, but this time we say that we can) write <span class="math notranslate nohighlight">\(2\)</span> as <span class="math notranslate nohighlight">\(1+1/1\)</span>.  This gives <span class="math notranslate nohighlight">\(16/10 = [1;1,1,2] = [1;1,1,1,1]\)</span>.  Working backwards, we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-9d05f7bc-48a0-4794-934f-7e05153fad96">
<span class="eqno">(8)<a class="headerlink" href="#equation-9d05f7bc-48a0-4794-934f-7e05153fad96" title="Permalink to this equation">¶</a></span>\[\begin{equation}
1 + \cfrac{1}{1+ \cfrac{1}{1 + \cfrac{1}{2}}} = 1 + \cfrac{1}{1+ \cfrac{2}{3}} = 1 + \cfrac{3}{5} = \frac{8}{5}
\end{equation}\]</div>
<p>which is obviously right.</p>
</div>
<div class="section" id="the-continued-fraction-for-the-golden-ratio-and-its-connection-to-fibonacci-numbers">
<h3>The continued fraction for the golden ratio and its connection to Fibonacci numbers<a class="headerlink" href="#the-continued-fraction-for-the-golden-ratio-and-its-connection-to-fibonacci-numbers" title="Permalink to this headline">¶</a></h3>
<p>The continued fraction with all partial quotients equal to <span class="math notranslate nohighlight">\(1\)</span> gives the <em>golden ratio</em> <span class="math notranslate nohighlight">\(\phi = (1+\sqrt{5})/2 = 1.618\ldots\)</span>. This is so because</p>
<div class="amsmath math notranslate nohighlight" id="equation-96533cea-9ff8-496a-9ff3-514cf9ed309c">
<span class="eqno">(9)<a class="headerlink" href="#equation-96533cea-9ff8-496a-9ff3-514cf9ed309c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\phi = 1 + \frac{1}{\phi}
\end{equation}\]</div>
<p>and recursively substituting the equation into its own right hand side produces nothing but</p>
<div class="amsmath math notranslate nohighlight" id="equation-c1e6674e-047c-4253-bec8-03c7fb302ac3">
<span class="eqno">(10)<a class="headerlink" href="#equation-c1e6674e-047c-4253-bec8-03c7fb302ac3" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\phi = [1;1,1,1,1,1,1\ldots]
\end{equation}\]</div>
<p>Truncating these gives approximations to <span class="math notranslate nohighlight">\(\phi\)</span> as ratios of Fibonacci numbers.  This continued fraction is interesting for several reasons, including the notion of “noble” numbers, which are all those numbers which have continued fractions <em>ending</em> in <span class="math notranslate nohighlight">\([\ldots, 1, 1, 1, \ldots]\)</span>, that is, ending with an infinite sequence of <span class="math notranslate nohighlight">\(1\)</span>s.  These somehow are the “least sensitive” to perturbations, and they show up in physical situations involving resonance (such as the rings around Saturn and Jupiter).</p>
</div>
<div class="section" id="inequalities">
<h3>Inequalities<a class="headerlink" href="#inequalities" title="Permalink to this headline">¶</a></h3>
<p>Because the partial quotients <span class="math notranslate nohighlight">\(a_k\)</span> of a simple continued fraction are positive integers, something interesting happens with sequential convergents <span class="math notranslate nohighlight">\(p_{2k-1}/q_{2k-1}\)</span>, <span class="math notranslate nohighlight">\(p_{2k}/q_{2k}\)</span>, and <span class="math notranslate nohighlight">\(p_{2k+1}/q_{2k+1}\)</span>.  Let’s consider it carefully.  We are indexing from zero for the first entry: suppose <span class="math notranslate nohighlight">\(x = [a_0; a_1, a_2, a_3, \ldots ]\)</span>. Then <span class="math notranslate nohighlight">\(x_0 = p_0/q_0 = a_0/1\)</span> is an integer. The next iterate <span class="math notranslate nohighlight">\(x_1 = a_0 + 1/a_1\)</span> is a positive quantity larger: <span class="math notranslate nohighlight">\(x_0 &lt; x_1\)</span>.  But then <span class="math notranslate nohighlight">\(x_2 = a_0 + 1/(a_1 + 1/a_2)\)</span> and (because the denominator is <em>bigger</em>) <span class="math notranslate nohighlight">\(1/(a_1+1/a_2) &lt; 1/a_1\)</span>.  But it’s still positive.  So <span class="math notranslate nohighlight">\(x_0 &lt; x_2 &lt; x_1\)</span>.</p>
<p>Now it begins to get a little hairy, but <span class="math notranslate nohighlight">\(x_3 = a_0 + 1/(a_1 + 1/(a_2 + 1/a_3))\)</span>; now <span class="math notranslate nohighlight">\(a_2 + 1/a_3 &gt; a_2\)</span> so its reciprocals flip the inequality: <span class="math notranslate nohighlight">\(1/(a_2 + 1/a_3) &lt; 1/a_2\)</span> (this is just what we did with <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a_2\)</span> before); now adding <span class="math notranslate nohighlight">\(a_1\)</span> we have <span class="math notranslate nohighlight">\(a_1 + 1/(a_2 + 1/a_3) &lt; a_1 + 1/a_2\)</span>.  Okay.  Now reciprocate again, and this flips the sign of the inequality again, and when we add <span class="math notranslate nohighlight">\(a_0\)</span> to both sides we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-0b97dd1f-bef2-40d3-a3f8-341b00492aac">
<span class="eqno">(11)<a class="headerlink" href="#equation-0b97dd1f-bef2-40d3-a3f8-341b00492aac" title="Permalink to this equation">¶</a></span>\[\begin{equation}
a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3}}} &gt; a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2}}\&gt;.
\end{equation}\]</div>
<p>We don’t know any “easy” way to just <em>see</em> that; we had to work it through.  But once we believe it, then we find <span class="math notranslate nohighlight">\(x_3 &gt; x_2\)</span>. What we have now is</p>
<div class="amsmath math notranslate nohighlight" id="equation-7bb68890-cd2e-471e-a0be-dff97d78e2c6">
<span class="eqno">(12)<a class="headerlink" href="#equation-7bb68890-cd2e-471e-a0be-dff97d78e2c6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x_0 &lt; x_2 &lt; x_3 &lt; x_1
\end{equation}\]</div>
<p>and perhaps you will believe that this process can be continued and <em>all</em> the even-numbered convergents will be smaller than <em>all</em> the odd-numbered convergents, and that <em>all</em> the even-numbered convergents increase and <em>all</em> the odd-numbered convergents decrease. We have</p>
<div class="amsmath math notranslate nohighlight" id="equation-d1cc08c6-93f5-4b13-ad1a-0f33be8b12b4">
<span class="eqno">(13)<a class="headerlink" href="#equation-d1cc08c6-93f5-4b13-ad1a-0f33be8b12b4" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x_0 &lt; x_2 &lt; x_4 &lt; x_6 &lt; \cdots &lt; x &lt; \cdots &lt; x_7 &lt; x_5 &lt; x_3 &lt; x_1 \&gt;.
\end{equation}\]</div>
<p>Can you <em>prove</em> this?</p>
</div>
<div class="section" id="differences-of-convergents">
<h3>Differences of convergents<a class="headerlink" href="#differences-of-convergents" title="Permalink to this headline">¶</a></h3>
<p>Theorem 1.4 of Olds (p. 27) states that</p>
<div class="amsmath math notranslate nohighlight" id="equation-2fa32d96-4231-4362-a941-edfd3616dfa2">
<span class="eqno">(14)<a class="headerlink" href="#equation-2fa32d96-4231-4362-a941-edfd3616dfa2" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p_{n+1}q_n - p_nq_{n+1} = (-1)^{n}
\end{equation}\]</div>
<p>where we have changed the formula so it indexes from zero.  Let us verify this for <span class="math notranslate nohighlight">\(p_0/q_0 = a_0/1\)</span> and <span class="math notranslate nohighlight">\(p_1/q_1 = (a_0a_1+1)/a_1\)</span>: the case <span class="math notranslate nohighlight">\(n=0\)</span> gives</p>
<div class="amsmath math notranslate nohighlight" id="equation-c55e7746-5d64-41a1-a7fc-0b4459120902">
<span class="eqno">(15)<a class="headerlink" href="#equation-c55e7746-5d64-41a1-a7fc-0b4459120902" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p_1q_0 - p_0q_1 = (a_0a_1+1)\cdot 1 - a_0a_1 = 1 = (-1)^0
\end{equation}\]</div>
<p>so we have the indexing correct there, anyway.</p>
<p>Dividing both sides of that equation by <span class="math notranslate nohighlight">\(q_nq_{n+1}\)</span> we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-264f24d4-68c4-4aef-b49c-763e70093d02">
<span class="eqno">(16)<a class="headerlink" href="#equation-264f24d4-68c4-4aef-b49c-763e70093d02" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{p_{n+1}}{q_{n+1}} - \frac{p_n}{q_n} = \frac{(-1)^n}{q_nq_{n+1}}\&gt;,
\end{equation}\]</div>
<p>which tells us something quite important: because the denominators <em>grow exponentially</em> with <span class="math notranslate nohighlight">\(n\)</span> (they grow at least as fast as Fibonacci numbers do), then the <em>difference between successive continued fractions</em> can be made as small as we please by taking <span class="math notranslate nohighlight">\(n\)</span> large enough.</p>
<p>Let’s look at an example, with <span class="math notranslate nohighlight">\(n=2\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9abfcd30-dfdb-4f7e-acd7-7e428fdac811">
<span class="eqno">(17)<a class="headerlink" href="#equation-9abfcd30-dfdb-4f7e-acd7-7e428fdac811" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x_3-x_2 = 1 + \cfrac{1}{2 + \cfrac{1}{3 + \cfrac{1}{4}}} - \left( 1 + \cfrac{1}{2 + \cfrac{1}{3}} \right)
\end{equation}\]</div>
<p>The code below shows that this is positive, and it should be <span class="math notranslate nohighlight">\(1/(30\cdot 7) = 1/210\)</span>. Computation shows that it is.</p>
<p><strong>Remark</strong> Using this theorem it is fairly easy to prove the inequalities in the cell above this one.</p>
<p><strong>Another Remark</strong> Going back and looking at the code <code class="docutils literal notranslate"><span class="pre">list_to_frac</span></code>, we see that the <em>code</em> indexes the lists from <span class="math notranslate nohighlight">\(0\)</span>, and the variables are named as if the indexing starts from zero, but then abandons that connection for space reasons and just re-uses variables instead of keeping all convergents.  “Off-by-one” errors are extremely common in computing, and while—after many years of practice—we now can make our programs work relatively quickly, such indexing issues don’t make it easier.  In the Maple version of this book, all the indexing is from one, and in some ways that makes it harder; but then there are issues with “off by one” errors in termination in Python, too, so it’s kind of “six of one, half a dozen of the other”.  Indeed the newer programming language Julia indexes from <span class="math notranslate nohighlight">\(1\)</span>, like Maple, for much this reason.  We have no advice except to be careful and to check.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ex1</span><span class="p">,</span><span class="n">ex0</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span> <span class="n">ex1</span><span class="p">,</span> <span class="n">ex0</span><span class="p">,</span> <span class="n">ex1</span><span class="o">-</span><span class="n">ex0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">210</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4333333333333333 1.4285714285714286 0.004761904761904745 0.004761904761904762
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-diophantine-equations">
<h3>Solving Diophantine equations<a class="headerlink" href="#solving-diophantine-equations" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Diophantine_equation">Diophantine equation</a> is an ancient type of equation, one where the solutions are desired to be <em>integers</em> (and usually <em>positive</em> integers).  They are named for <a class="reference external" href="https://en.wikipedia.org/wiki/Diophantus">Diophantus</a> who wrote a book about them.  Continued fractions (or, equivalently, Euclid’s algorithm) can be used to solve <em>linear</em> Diophantine equations in two variables, and can also be used to solve <em>Pell’s equation</em></p>
<div class="amsmath math notranslate nohighlight" id="equation-c84c8262-a854-4994-9c19-4264d0d6a367">
<span class="eqno">(18)<a class="headerlink" href="#equation-c84c8262-a854-4994-9c19-4264d0d6a367" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x^2 - Ny^2 = 1
\end{equation}\]</div>
<p>Perhaps the most famous of this kind of equation is <a class="reference external" href="https://en.wikipedia.org/wiki/Archimedes%27s_cattle_problem">Archimedes’ “Cattle of the Sun”</a> problem from antiquity.</p>
</div>
<div class="section" id="generalized-continued-fractions">
<h3>Generalized continued fractions<a class="headerlink" href="#generalized-continued-fractions" title="Permalink to this headline">¶</a></h3>
<p>Continued fractions don’t have to have just the “simple” form used above, but can also have different things in the numerator. For example, <a class="reference external" href="https://en.wikipedia.org/wiki/William_Brouncker,_2nd_Viscount_Brouncker">Lord Brouncker</a> found the following continued fraction for <span class="math notranslate nohighlight">\(4/\pi\)</span>, at some time prior to 1656 when it was reported in a book by the mathematician <a class="reference external" href="https://en.wikipedia.org/wiki/John_Wallis">John Wallis</a>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-deb0270b-88b8-4725-bef3-7bcecb58baf6">
<span class="eqno">(19)<a class="headerlink" href="#equation-deb0270b-88b8-4725-bef3-7bcecb58baf6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{4}{\pi} = 1+ \cfrac{1^2}{2 + \cfrac{3^2}{2 + \cfrac{5^2}{2 + \cfrac{7^2}{2 + \cfrac{9^2}{\ddots}}}}}.
\end{equation}\]</div>
</div>
<div class="section" id="lambert-s-proof-of-the-irrationality-of-pi">
<h3>Lambert’s proof of the irrationality of <span class="math notranslate nohighlight">\(\pi\)</span><a class="headerlink" href="#lambert-s-proof-of-the-irrationality-of-pi" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Johann_Heinrich_Lambert">Johann Heinrich Lambert</a> used the following continued fraction to prove that <span class="math notranslate nohighlight">\(\pi\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Proof_that_%CF%80_is_irrational#Lambert%27s_proof">is irrational</a>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-99851b81-52b8-4215-a007-3f913ec1d285">
<span class="eqno">(20)<a class="headerlink" href="#equation-99851b81-52b8-4215-a007-3f913ec1d285" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\tan(x) = \cfrac{x}{1+\cfrac{x^{2}}{-3+\cfrac{x^{2}}{5+\cfrac{x^{2}}{-7+\cfrac{x^{2}}{9-\cfrac{x^{2}}{\ddots}}}}}}
\end{equation}\]</div>
<p>He first proved that if <span class="math notranslate nohighlight">\(x\)</span> was rational then <span class="math notranslate nohighlight">\(\tan(x)\)</span> must be irrational using this fraction; since <span class="math notranslate nohighlight">\(\tan(\pi/4) = 1\)</span> is rational, it must then be true that <span class="math notranslate nohighlight">\(\pi/4\)</span> is irrational, and hence <span class="math notranslate nohighlight">\(\pi\)</span> must be irrational.</p>
</div>
<div class="section" id="galois-theorem">
<h3>Galois’ Theorem<a class="headerlink" href="#galois-theorem" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/%C3%89variste_Galois">Évariste Galois</a> discovered and proved that all <em>purely periodic</em> continued fractions (like <span class="math notranslate nohighlight">\(1+\sqrt{2}\)</span>) are special quadratic irrationals: they are the positive roots of quadratic equations with integer coefficients, and the <em>other root</em> of the quadratic must lie in the interval <span class="math notranslate nohighlight">\((-1,0)\)</span>.  This might be fun for people to explore or argue over.</p>
</div>
<div class="section" id="lagrange-s-theorem">
<h3>Lagrange’s Theorem<a class="headerlink" href="#lagrange-s-theorem" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Joseph-Louis_Lagrange">Joseph Louis Lagrange</a> discovered and proved that all <em>ultimately periodic</em> continued fractions are quadratic irrationals; that is, they are the roots of quadratic equations with integer coefficients.</p>
<p>This has startling implications: cube roots will not be periodic (is there any pattern, though?)  Transcendental numbers will not be periodic (but the number <span class="math notranslate nohighlight">\(e\)</span> and its relatives have <em>amazing</em> patterns in them).  There is a lot to play with, here.</p>
<p>Proving that an ultimately periodic continued fraction is a quadratic irrational is not so hard; proving that <em>all</em> quadratic irrationals are ultimately periodic is harder.  The proofs are in Olds’ book, however, if students are interested.</p>
<p>Here is a graphical representation of one “orbit” of the game of pass the parcel if one starts with <span class="math notranslate nohighlight">\(x_0 = \frac{14981}{19661}-\frac{\sqrt{46}}{19661} \approx 0.761620348406331\)</span>.    The game proceeds as in the table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_n\)</span></p></th>
<th class="head"><p>approximation</p></th>
<th class="head"><p>aₙ</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{14981}{19661}-\frac{\sqrt{46}}{19661}\)</span></p></td>
<td><p>0.761620348406331</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{3566}{11415}+\frac{\sqrt{46}}{11415}\)</span></p></td>
<td><p>0.312990129652485</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{112}{557}-\frac{\sqrt{46}}{1114}\)</span></p></td>
<td><p>0.194988931792527</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{1}{45}+\frac{\sqrt{46}}{45}\)</span></p></td>
<td><p>0.128496221847228</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{46}-6\)</span></p></td>
<td><p>0.782329983125264</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{2}{5}+\frac{\sqrt{46}}{10}\)</span></p></td>
<td><p>0.278232998312525</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{5}{3}+\frac{\sqrt{46}}{3}\)</span></p></td>
<td><p>0.594109994375093</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{2}{7}+\frac{\sqrt{46}}{7}\)</span></p></td>
<td><p>0.683189997589324</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{2}{3}+\frac{\sqrt{46}}{6}\)</span></p></td>
<td><p>0.463721663854212</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{6}{5}+\frac{\sqrt{46}}{5}\)</span></p></td>
<td><p>0.156465996625053</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p><span class="math notranslate nohighlight">\(-3+\frac{\sqrt{46}}{2}\)</span></p></td>
<td><p>0.391164991562646</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{4}{5}+\frac{\sqrt{46}}{5}\)</span></p></td>
<td><p>0.556465996625050</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{1}{3}+\frac{\sqrt{46}}{6}\)</span></p></td>
<td><p>0.797054997187546</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{4}{3}+\frac{\sqrt{46}}{3}\)</span></p></td>
<td><p>0.927443327708428</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p><span class="math notranslate nohighlight">\(-\frac{3}{5}+\frac{\sqrt{46}}{10}\)</span></p></td>
<td><p>0.0782329983125263</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{46}-6\)</span></p></td>
<td><p>0.782329983125292</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>and because <span class="math notranslate nohighlight">\(x_{16} = x_4\)</span> the game ends.  That table is a bit hard to read; it’s easier in graphical form.  We see the initial transient, and then the loop.  Once on the loop, the game loops forever.  What Lagrange’s theorem says is that <em>every</em> quadratic irrational has such a graph: a possibly very long transient followed by a possibly long loop.  Moreover, every such graph gives the continued fraction of a quadratic irrational.</p>
<a class="reference internal image-reference" href="../_images/nicetransient.png"><img alt="Frequency distribution for five thousand partial quotients of pi" class="align-center" src="../_images/nicetransient.png" style="height: 300px;" /></a>
</div>
<div class="section" id="mental-estimation-of-square-roots">
<h3>Mental estimation of square roots<a class="headerlink" href="#mental-estimation-of-square-roots" title="Permalink to this headline">¶</a></h3>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\sqrt{a^2 + b} \doteq a + \dfrac{b}{2a}
\end{equation*}\]</div>
<p>E.g.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\sqrt{65} = \sqrt{64 + 1} \doteq 8 + \dfrac{1}{16}
\end{equation*}\]</div>
<p>Check</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\left(8 + \dfrac{1}{16}\right)^2 = 8^2 + 2\cdot 8 \cdot \dfrac{1}{16} + \dfrac{1}{16^2} = 65 + \dfrac{1}{16^2}
\end{equation*}\]</div>
<p>Also, <span class="math notranslate nohighlight">\(1/16 = 0.0625\)</span> so <span class="math notranslate nohighlight">\(8 + 1/16 = 8.0625\)</span> so when we square that, either by hand multiplication or by calculator, we get <span class="math notranslate nohighlight">\(65.00390625\)</span> which is more convincing because decimals are more intelligible.</p>
<p>Now it turns out there is a general formula, with a (slightly) generalized kind of continued fraction, namely</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	\sqrt{a^2 + b} = a + \cfrac{b}{2a + \cfrac{b}{2a + \cfrac{b}{2a + \substack{\ \\ \ \\ \ddots}}}}
\end{equation*}\]</div>
<p>(see page 137 of <span id="id8">[<a class="reference internal" href="../references.html#id2">Olds, 1963</a>]</span>) so</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	8 + \cfrac{1}{16 + \cfrac{1}{16 + \cfrac{1}{16 + \substack{\ \\ \ \\ \ddots}}}}
\end{equation*}\]</div>
<p>ought to give <em>better</em> estimate of <span class="math notranslate nohighlight">\(\sqrt{65}\)</span>.  Taking just two of the “16”s we get <span class="math notranslate nohighlight">\(8.0622568093\)</span> whereas the true square root of <span class="math notranslate nohighlight">\(65\)</span> starts out <span class="math notranslate nohighlight">\(8.0622577483\)</span> which is about six decimals of agreement.</p>
<div class="section" id="a-similar-method-rmc-just-learned-which-is-apparently-current-in-some-high-schools">
<h4>A similar method RMC just learned, which is apparently current in some high schools<a class="headerlink" href="#a-similar-method-rmc-just-learned-which-is-apparently-current-in-some-high-schools" title="Permalink to this headline">¶</a></h4>
<p>Instead of estimating <span class="math notranslate nohighlight">\(\sqrt{a^2+b}\)</span> by <span class="math notranslate nohighlight">\(a + \frac{b}{2a}\)</span>, consider instead the following (rather strange-looking at first) trick.  Take <span class="math notranslate nohighlight">\(\sqrt{73}\)</span> for example.  The squares that we know that surround this number are <span class="math notranslate nohighlight">\(64\)</span> and <span class="math notranslate nohighlight">\(81\)</span>.  We have by plain subtraction that <span class="math notranslate nohighlight">\(64 + 9 = 73 = 81 - 8\)</span>. So the distance between the two square numbers is <span class="math notranslate nohighlight">\(81 - 64 = 9 + 8 = 17\)</span>.  Obviously the square root of <span class="math notranslate nohighlight">\(73\)</span> must lie between <span class="math notranslate nohighlight">\(8\)</span> and <span class="math notranslate nohighlight">\(9\)</span>. So, think about the number <span class="math notranslate nohighlight">\(8\)</span> plus something in between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span> as an approximation to <span class="math notranslate nohighlight">\(\sqrt{73}\)</span>; why not <span class="math notranslate nohighlight">\(8 + \frac{9}{17}\)</span>?  This is the average distance, in some weird way.  This method has the advantage that it is also <span class="math notranslate nohighlight">\(9 - \frac{8}{17}\)</span> so you get the same answer no matter which end of the interval you start from.</p>
</div>
</div>
</div>
<div class="section" id="best-approximation">
<h2>Best Approximation<a class="headerlink" href="#best-approximation" title="Permalink to this headline">¶</a></h2>
<p>This section “steals a bit of thunder” from the typical entry-level number theory course; but since most students won’t take any number theory, this may not be a problem.  But it’s such a lovely bit of mathematics (which we just talk about here, without proofs) that perhaps the reader will be induced to take the number theory course, later.</p>
<p>One application of continued fractions is to find “nice” approximate fractions for decimals. This is harder than merely writing, say, 3.1416 as <span class="math notranslate nohighlight">\(\frac{31416}{10000} = \frac{3927}{1250}\)</span> after cancelling <span class="math notranslate nohighlight">\(2^{3}\)</span> from top and bottom. Playing “pass the parcel” gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
	3 + \left[7, 16, 11, 6835269.99316 \right]
\end{equation*}\]</div>
<p>which suggest <span class="math notranslate nohighlight">\(3 + \left[7 \&gt;, 16 \&gt;, 11\right]\)</span> is the continued fraction for <span class="math notranslate nohighlight">\(\frac{3927}{1250}\)</span>. [It feels weird to throw out large numbers, but remember it’s <span class="math notranslate nohighlight">\(+\frac{1}{\left(M + \cdots\right)}\)</span>, which will be very small, that we are really throwing out.]</p>
<p>What happens if we throw out the <span class="math notranslate nohighlight">\(11\)</span>, also?</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
	3 + \left[7 \&gt;, 16 \right] &amp;= 3 + \cfrac{1}{7 + \cfrac{1}{16}} \\ &amp;= 3\dfrac{16}{113} \\ &amp;= \dfrac{355}{113} \\
	&amp;\doteq 3.14159292036 \&gt;.
\end{align}
\end{split}\]</div>
<p>Something interesting has happened: this is a <em>better</em> approximation to <span class="math notranslate nohighlight">\(\pi\)</span> than <span class="math notranslate nohighlight">\(3.1416\)</span> is! This has six correct decimal places, unlike the four we started with! This kind of thing does <em>not</em> always happen, but it happens enough that Derive, a CAS that now lives on certain TI calculators, used (uses) this algorithm and sometimes gets exact answers even when such can’t be guaranteed. The underlying theorem is one of best approximation by rational numbers, and it turns out that the convergents of infinite continued fractions give in a certain sense these “best” approximation.</p>
<p>In essence, continued fractions are “economical” best approximations. If <span class="math notranslate nohighlight">\(\left|x - \frac{p}{q}\right| &lt; \frac{1}{2q^2}\)</span>, then necessarily <span class="math notranslate nohighlight">\(\frac{p}{q}\)</span> is one of the convergents of the continued fraction. This means that shorter <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> can be used—that is, the fractions are nicer.</p>
<div class="section" id="the-astonishing-continued-fractions-for-e">
<h3>The astonishing continued fractions for e<a class="headerlink" href="#the-astonishing-continued-fractions-for-e" title="Permalink to this headline">¶</a></h3>
<p>We need to talk about <a class="reference external" href="https://en.wikipedia.org/wiki/Leonhard_Euler">Leonhard Euler</a>, pronounced in English more like “Oiler” but the Russians, who have a great claim to him because of his years at St. Petersburg, say “euh-ler” with a vowel more like the French “oeuf”.  Euler was one of the greatest mathematicians—it’s sort of pointless to argue who was greater, Archimedes, Newton, Gauss, Euler, or Einstein; Leonardo da Vinci is a contender, too, and how could we compare them? We claim it is impossible to rank people who were clearly smarter than we are. We couldn’t even <em>see</em> the differences between them, much less judge them accurately.  And, all of them were rich and privileged in their own ways, and without doubt this list of the “greatest” is entirely Eurocentric; where does <a class="reference external" href="https://en.wikipedia.org/wiki/Nasir_al-Din_al-Tusi">Nasir al-Din al-Tusi</a> (who was the academic ancestor of almost every modern mathematics PhD holder, according to the <a class="reference external" href="https://genealogy.math.ndsu.nodak.edu/id.php?id=217509">Mathematics Geneology</a>) fit on this list, or Brahmagupta or Aryabhata or Liu Hui?  Anyway, pointless.  For any list of top ten, one could make a case that Euler belonged there.  His achievements and impact were astounding; one of the “minor” things is that he revolutionized mathematical notation and writing, and not just in English—he wrote mostly in Latin.  Reading mathematics before Euler is painful because everyone tried to put things into words; after Euler we are all comfortable reading equations as if they are part of the language, which they <em>are</em>.</p>
<p>One of Euler’s “minor” technical achievements (well, in comparison to things like the Euler equations for fluid flow, or Euler’s method for solving differential equations, or the Euler–Lagrange equations of the calculus of variations) was unlocking many of the secrets of the number <span class="math notranslate nohighlight">\(e\)</span>, the base of the natural logarithms.  Euler defined this as</p>
<div class="amsmath math notranslate nohighlight" id="equation-6548c1de-700f-44b4-8339-6ba49d50c369">
<span class="eqno">(21)<a class="headerlink" href="#equation-6548c1de-700f-44b4-8339-6ba49d50c369" title="Permalink to this equation">¶</a></span>\[\begin{equation}
e := \lim_{n\to\infty} \left( 1 + \frac{1}{n}\right)^n
\end{equation}\]</div>
<p>but we are not going to pursue that here because that is properly part of modern Calculus.  Instead, we will display one of Euler’s continued fractions:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9baa2960-f418-4fb9-9810-46daca366fd5">
<span class="eqno">(22)<a class="headerlink" href="#equation-9baa2960-f418-4fb9-9810-46daca366fd5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\nu = \frac{e+1}{e-1} = 2 + \cfrac{1}{6 + \cfrac{1}{10 + \cfrac{1}{14 + \cfrac{1}{18 + \cfrac{1}{\ddots}}}}}
\end{equation}\]</div>
<p>If we know <span class="math notranslate nohighlight">\(\nu\)</span>, then because <span class="math notranslate nohighlight">\((e-1)\nu = e+1\)</span> or <span class="math notranslate nohighlight">\(e(\nu-1) = \nu+1\)</span> we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-17ac7f4f-f9d6-4e5b-a3be-a88b67ec08f4">
<span class="eqno">(23)<a class="headerlink" href="#equation-17ac7f4f-f9d6-4e5b-a3be-a88b67ec08f4" title="Permalink to this equation">¶</a></span>\[\begin{equation}
e = \frac{\nu + 1}{\nu - 1}\&gt;.
\end{equation}\]</div>
<p>Because the partial quotients in <span class="math notranslate nohighlight">\(\nu\)</span> grow so predictably—they increase by <span class="math notranslate nohighlight">\(4\)</span> every time—one gets very accurate approximations for <span class="math notranslate nohighlight">\(\nu\)</span> very quickly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evenfrac</span> <span class="o">=</span> <span class="n">list_to_frac</span><span class="p">(</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span>
<span class="n">oddfrac</span> <span class="o">=</span> <span class="n">list_to_frac</span><span class="p">(</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">22</span><span class="p">])</span>
<span class="c1">#evenfrac,evalf(evenfrac),oddfrac,evalf(oddfrac), evalf(oddfrac-evenfrac), evalf( (exp(1)+1)/(exp(1)-1));</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">evenfrac</span><span class="p">,</span> <span class="n">oddfrac</span><span class="p">,</span> <span class="n">oddfrac</span><span class="o">-</span><span class="n">evenfrac</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.1639534135512517 2.1639534137389793 1.8772761123386772e-10 2.163953413738653
</pre></div>
</div>
</div>
</div>
<p>Experiments show that the even-ending lists are always <em>increasing</em> while the odd-ending lists are always <em>decreasing</em>.  This means that</p>
<div class="amsmath math notranslate nohighlight" id="equation-56645610-9cab-42b3-bfcc-e931e482d11c">
<span class="eqno">(24)<a class="headerlink" href="#equation-56645610-9cab-42b3-bfcc-e931e482d11c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{p_0}{q_0} &lt; \frac{p_2}{q_2} &lt; \frac{p_4}{q_4} &lt; \cdots &lt; \frac{p_5}{q_5} &lt;\frac{p_3}{q_3} &lt;\frac{p_1}{q_1}
\end{equation}\]</div>
<p>and our previous experiment suggested (which turns out to be true) that <em>all</em> odd-ending continued fractions are larger than <em>all</em> even-ending continued fractions, and moreover that the difference between them goes rapidly to zero.  This is the basis for the proof that the number <span class="math notranslate nohighlight">\(\nu\)</span> really is represented by the continued fraction.  We <em>won’t</em> fill in the details, although we are so very close: instead we will just claim that these experiments are pointing at true facts.</p>
<p>The <em>practical</em> fact that comes out of this theorem is that</p>
<div class="amsmath math notranslate nohighlight" id="equation-f9b0c2e8-80e3-466c-924d-7334f1972188">
<span class="eqno">(25)<a class="headerlink" href="#equation-f9b0c2e8-80e3-466c-924d-7334f1972188" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{33630}{15541} &lt; \nu &lt;  \frac{741721}{342762}
\end{equation}\]</div>
<p>which, when translated into much more intelligible decimals, says that <span class="math notranslate nohighlight">\(\nu = 2.163953413_{55}^{74}\)</span> where the curious subscripts/superscripts mean that the true answer is trapped somewhere between <span class="math notranslate nohighlight">\(2.163953413{55}\)</span> and <span class="math notranslate nohighlight">\(2.163953413{74}\)</span>. Welcome to the somewhat niche world of <a class="reference external" href="https://en.wikipedia.org/wiki/Interval_arithmetic">interval arithmetic</a>.</p>
<p>This translates to a similar “trapping” of the value of <span class="math notranslate nohighlight">\(e\)</span>: we put the too-big rational in the numerator and the too-small rational in the denominator and get an <em>overestimate</em> of <span class="math notranslate nohighlight">\(e\)</span>, and put the too-small rational in the numerator and the too-big rational in the denominator and get an <em>underestimate</em> of <span class="math notranslate nohighlight">\(e\)</span>.  When we do this we get the <em>very curious</em> estimate, which surely would have pleased Euler,</p>
<div class="amsmath math notranslate nohighlight" id="equation-6f6b04c9-9513-404b-9c19-4c63fd13c011">
<span class="eqno">(26)<a class="headerlink" href="#equation-6f6b04c9-9513-404b-9c19-4c63fd13c011" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{16853950302}{6200221819} &lt; e &lt; \frac{16853950303}{6200221818}\&gt;.
\end{equation}\]</div>
<p>Translating this to decimals gives <span class="math notranslate nohighlight">\(e = 2.718281828_{29}^{89}\)</span> which again traps <span class="math notranslate nohighlight">\(e\)</span>.  Using <em>one</em> more partial quotient improves this to</p>
<div class="amsmath math notranslate nohighlight" id="equation-c27f980f-ece5-4f4e-ac9c-cb6ebaa1da37">
<span class="eqno">(27)<a class="headerlink" href="#equation-c27f980f-ece5-4f4e-ac9c-cb6ebaa1da37" title="Permalink to this equation">¶</a></span>\[\begin{equation}
{\frac{9681562563498}{3561647825527}} &lt; e &lt; {\frac{9681562563499}{3561647825526}}
\end{equation}\]</div>
<p>or <span class="math notranslate nohighlight">\(e = 2.71828182845_{82}^{94}\)</span>, which has two more decimal digits nailed down.</p>
</div>
<div class="section" id="rational-approximation-to-the-exponential-function">
<h3>Rational approximation to the exponential function<a class="headerlink" href="#rational-approximation-to-the-exponential-function" title="Permalink to this headline">¶</a></h3>
<p>Lambert apparently discovered in 1766 that, if <span class="math notranslate nohighlight">\(x \ne 0\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-51f2d195-bbd8-4766-9754-786ae2e32aaf">
<span class="eqno">(28)<a class="headerlink" href="#equation-51f2d195-bbd8-4766-9754-786ae2e32aaf" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\nu(x) = \frac{e^x+1}{e^x-1} = \frac{2}{x} + \cfrac{1}{\frac{6}{x} + \cfrac{1}{\frac{10}{x} + \cfrac{1}{\frac{14}{x} + \cfrac{1}{\frac{18}{x} + \cfrac{1}{\ddots}}}}}
\end{equation}\]</div>
<p>Again, if we know <span class="math notranslate nohighlight">\(\nu(x)\)</span>, then</p>
<div class="amsmath math notranslate nohighlight" id="equation-d0271ec8-42a7-43ce-b4d0-049e1b61bc67">
<span class="eqno">(29)<a class="headerlink" href="#equation-d0271ec8-42a7-43ce-b4d0-049e1b61bc67" title="Permalink to this equation">¶</a></span>\[\begin{equation}
e^x = \frac{\nu(x) + 1}{\nu(x) - 1}\&gt;.
\end{equation}\]</div>
<p>These give rather effective approximations of <span class="math notranslate nohighlight">\(e^x\)</span> by rational functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">nu4</span> <span class="o">=</span> <span class="n">list_to_frac</span><span class="p">(</span> <span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">14</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">18</span><span class="o">/</span><span class="n">x</span> <span class="p">])</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">nu4</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/(1/(1/(x/18 + 14/x) + 10/x) + 6/x) + 2/x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e4</span> <span class="o">=</span> <span class="p">(</span><span class="n">nu4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nu4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">e4</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">),</span> 
                         <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0e-15</span><span class="p">,</span><span class="mf">1.0e-6</span><span class="p">),</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nb_of_points</span><span class="o">=</span><span class="mi">300</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/continued-fractions_70_0.png" src="../_images/continued-fractions_70_0.png" />
</div>
</div>
</div>
<div class="section" id="randomness-in-continued-fractions">
<h3>Randomness in Continued Fractions<a class="headerlink" href="#randomness-in-continued-fractions" title="Permalink to this headline">¶</a></h3>
<p>One of the “generic good questions” in the Preamble was “What does a random choice look like?”  For continued fractions, this opens a <em>huge</em> collection of questions.  For instance, if we choose an <span class="math notranslate nohighlight">\(x_0\)</span> “at random” in the interval <span class="math notranslate nohighlight">\([0,1)\)</span>, what does its continued fraction look like?  And what does that even mean, “look like”?  A very great Russian mathematician, <a class="reference external" href="https://en.wikipedia.org/wiki/Aleksandr_Khinchin">A. Y. Khinchin</a> (there are about half-a-dozen different ways to transliterate his name to English), solved important problems in this area, and looking at his solutions gives a very good introduction to the deep mathematics known as <em>ergodic theory</em>.</p>
<p>One answer (Khinchin’s answer, with help from Gauss and from Kuzmin) to what continued fractions “look like” is to look at a frequency distribution of the partial quotients that arise.  This is related to the distribution of the <span class="math notranslate nohighlight">\(x_n\)</span> that arise from the dynamical system <span class="math notranslate nohighlight">\(x_n = G(x_{n-1})\)</span> starting from a “random” <span class="math notranslate nohighlight">\(x_0\)</span>; this is an instance of the previously-mentioned ergodic theory.  It turns out the <span class="math notranslate nohighlight">\(x_n\)</span> are distributed not uniformly but according to a known distribution, the so-called <em>Gauss measure</em>.  We will see more of this in the “Bohemian matrices” unit (actually in the solution to one of the exercises).</p>
<p>Back to partial quotients <span class="math notranslate nohighlight">\(a_n\)</span> and their distribution. We’ve been working with <span class="math notranslate nohighlight">\(\pi\)</span> here, so we know its first few partial quotients: <span class="math notranslate nohighlight">\([3,7,15,1,292,\ldots]\)</span>.  R. William Gosper computed several <em>million</em> partial quotients for <span class="math notranslate nohighlight">\(\pi\)</span> in the 1970s, and nowadays many more are known: see <a class="reference external" href="http://oeis.org/A001203">A001203</a>.  At this time of writing, the record holder is Syed Fahad, with 30 <em>billion</em> partial quotients. Okay, then. So we ought to be able to study the statistics of this particular continued fraction, and in particular we can draw a frequency distribution.  Below, we use only 5000 partial quotients, and drew the resulting frequency distribution.  About 40% of the time, the partial quotient is a <span class="math notranslate nohighlight">\(1\)</span>.  Next most common is a <span class="math notranslate nohighlight">\(2\)</span>.  The relative likelihood of a partial quotient appearing seems to diminish with its size.  This is indeed what happens if one chooses <span class="math notranslate nohighlight">\(x_0\)</span> “at random”; But!</p>
<p><em>It is not known if the distribution of the partial quotients of <span class="math notranslate nohighlight">\(\pi\)</span></em> are “typical” (everyone thinks so, but there is no proof). What <em>is</em> known, which Khinchin proved, is that the distribution is the same (the <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Kuzmin_distribution">Gauss–Kuzmin distribution</a>) for <em>almost all</em> initial numbers <span class="math notranslate nohighlight">\(x_0\)</span> in the interval (in a technical sense, for a set of measure 1); and that the geometric mean of the partial quotients tends to a constant, now called <a class="reference external" href="https://en.wikipedia.org/wiki/Khinchin%27s_constant">Khinchin’s constant</a>.</p>
<a class="reference internal image-reference" href="../_images/fivethousand.png"><img alt="Frequency distribution for five thousand partial quotients of pi" class="align-center" src="../_images/fivethousand.png" style="height: 300px;" /></a>
<p>There are other kinds of “random continued fractions” questions that could be asked.  We invite you to pose some!  We take up this challenge in the exercises for the “Bohemian Matrices” unit, where we again see the Gauss–Kuzmin distribution.</p>
</div>
</div>
<div class="section" id="notes-and-further-reading">
<h2>Notes and further reading<a class="headerlink" href="#notes-and-further-reading" title="Permalink to this headline">¶</a></h2>
<p>We have scattered several links throughout this unit.  Here are some more.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sacred-geometry.es/?q=en/content/continued-fractions">Sacred Geometry</a></p></li>
<li><p><a class="reference external" href="http://oeis.org/search?q=continued+fraction&amp;language=english&amp;go=Search">The results on the OEIS you get when you search for “Continued Fraction”</a></p></li>
<li><p><a class="reference external" href="https://www.jstor.org/stable/2318113">Carl Douglas Olds’ Chauvenet Prize-winning paper</a> (JSTOR has free memberships available; but  you can go in through your library, if you have one, by using <a class="reference external" href="http://libkey.io/">libkey.io/</a> instead of https:// for that link).</p></li>
<li><p><a class="reference external" href="https://w3.pppl.gov/~hammett/work/2009/AIM-239-ocr.pdf">Bill Gosper’s original work described in the famous MIT HAKMEM</a> Bill Gosper used Möbius transformations to perform arithmetic on <em>infinite</em> continued fractions.  You should read it for Bill’s language alone (he still talks like that, and is simply wonderful to be around).  There are also astonishing facts about continued fractions in there: for instance, <em>every</em> continued fraction where the partial quotients are in arithmetic progression has a known closed form involving Bessel functions.</p></li>
<li><p><a class="reference external" href="https://www.jstor.org/stable/10.4169/amer.math.monthly.121.05.391">A lovely paper on the geometry of continued fractions by Alan Beardon and Ian Short</a> which makes some beautiful diagrams of <em>horocircles</em> and makes use of Möbius transformations.</p></li>
<li><p><a class="reference external" href="https://www.jstor.org/stable/10.4169/math.mag.88.4.272">A shorter and even more lovely paper by Alan Beardon</a> again using Möbius maps.</p></li>
</ul>
</div>
<div class="section" id="practice-problems-and-exercises">
<h2>Practice Problems and Exercises<a class="headerlink" href="#practice-problems-and-exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>Write down as many questions as you can, about this section.</p></li>
<li><p>Open a fresh Jupyter notebook and type in a code cell the following three lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
<p>and press and hold the control key and the Enter key.  There, you have just used Python to compute the first Newton iterate for the square root of two; the computer should have printed out <code class="docutils literal notranslate"><span class="pre">1.5</span></code>.</p>
</li>
<li><p>Now copy the final two lines of that cell (not the <code class="docutils literal notranslate"><span class="pre">x0=1</span></code>) and put them in a fresh code cell, and change <code class="docutils literal notranslate"><span class="pre">x0</span></code> to <code class="docutils literal notranslate"><span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code> to <code class="docutils literal notranslate"><span class="pre">x2</span></code> everywhere.  Run it again. The notebook should print <code class="docutils literal notranslate"><span class="pre">1.4166666666666665</span></code>.  Do it again 4 more times, changing <code class="docutils literal notranslate"><span class="pre">x2</span></code> to <code class="docutils literal notranslate"><span class="pre">x3</span></code>, and <code class="docutils literal notranslate"><span class="pre">x3</span></code> to <code class="docutils literal notranslate"><span class="pre">x4</span></code>, and <code class="docutils literal notranslate"><span class="pre">x4</span></code> to <code class="docutils literal notranslate"><span class="pre">x5</span></code>, and <code class="docutils literal notranslate"><span class="pre">x5</span></code> to <code class="docutils literal notranslate"><span class="pre">x6</span></code> in their newly copied lines. You should find after running the program that <em>both</em> <code class="docutils literal notranslate"><span class="pre">x5</span></code> and <code class="docutils literal notranslate"><span class="pre">x6</span></code> are <code class="docutils literal notranslate"><span class="pre">1.414213562373095</span></code>; no matter how many more times you do this (<code class="docutils literal notranslate"><span class="pre">x7</span></code>, <code class="docutils literal notranslate"><span class="pre">x8</span></code>, whatever) it won’t change any more.</p></li>
<li><p>Now go back and modify your print statements to be <code class="docutils literal notranslate"><span class="pre">print(x1,</span> <span class="pre">x1**2-2)</span></code>, <code class="docutils literal notranslate"><span class="pre">print(x2,</span> <span class="pre">x2**2-2)</span></code>, and so on, all the way up to <code class="docutils literal notranslate"><span class="pre">print(x6,</span> <span class="pre">x6**2-2)</span></code> and run all the cells again (in order).  You should see that the second numbers printed get smaller each time, until the line for <code class="docutils literal notranslate"><span class="pre">x5</span></code>. This says that <code class="docutils literal notranslate"><span class="pre">x5</span></code> squared is only about -4.4 times ten to the minus 16 smaller than 2 (we will see in a moment that this is not a very trustworthy statement).  That is, Python says that <code class="docutils literal notranslate"><span class="pre">x5</span></code> is the exact square root of a number only a proton’s width away from two (see the appendix on floating point numbers).</p></li>
<li><p>Now we are going to do the same in <em>rational arithmetic</em> by looking after the numerators and denominators <span class="math notranslate nohighlight">\(p_n\)</span> and <span class="math notranslate nohighlight">\(q_n\)</span> ourselves.  Either by going back and changing all your previous cells, or by writing fresh cells, enter the following (it can all be in one cell)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">p0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">q0</span><span class="o">**</span><span class="mi">2</span>
<span class="n">q1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">p0</span><span class="o">*</span><span class="n">q0</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">p1</span><span class="o">/</span><span class="n">q1</span><span class="p">,</span> <span class="p">(</span><span class="n">p1</span><span class="o">/</span><span class="n">q1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">p1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">q1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<span class="o">...</span> <span class="p">(</span><span class="n">these</span> <span class="n">dots</span> <span class="n">mean</span> <span class="n">do</span> <span class="n">the</span> <span class="n">case</span> <span class="n">p2</span><span class="o">/</span><span class="n">q2</span><span class="p">,</span> <span class="n">p3</span><span class="o">/</span><span class="n">q3</span><span class="p">,</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">way</span> <span class="n">up</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span><span class="p">)</span>
<span class="n">p6</span> <span class="o">=</span> <span class="n">p5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">q5</span><span class="o">**</span><span class="mi">2</span>
<span class="n">q6</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">p5</span><span class="o">*</span><span class="n">q5</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">p6</span><span class="p">,</span> <span class="n">q6</span><span class="p">,</span> <span class="n">p6</span><span class="o">/</span><span class="n">q6</span><span class="p">,</span> <span class="p">(</span><span class="n">p6</span><span class="o">/</span><span class="n">q6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">p6</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">q6</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">q6</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
</pre></div>
</div>
<p>You should be a little tired of cutting-and-pasting and changing 3s to 4s and 4s to 5s etc; it’s not <em>too bad</em> in such a short program (and that’s what it is, technically called a “straight-line program” because it has no loops), but it’s clearly repetetive and error-prone unless you are very finicky (we are very finicky).  We’ll start using loops in a moment, but right now there are two other puzzles that should appear when you run this program.  First, the pn/qn ratios should be giving the (apparently) same numbers as the xn before, and similarly the difference between squaring the ratio and 2.  But the last two entries give (as a ratio) the <em>exact</em> numbers for <code class="docutils literal notranslate"><span class="pre">(pn/qn)**2</span> <span class="pre">-</span> <span class="pre">2</span></code> (if we have done our algebra right).  Our program generates the ratios <span class="math notranslate nohighlight">\(1/4\)</span>, <span class="math notranslate nohighlight">\(1/144\)</span>, <span class="math notranslate nohighlight">\(1/166464\)</span>, and so on until</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
        x_6 = p_6/q_6 = \frac{1572584048032918633353217}{1111984844349868137938112}.
    \end{equation*}\]</div>
<p>(If you did not get those numbers, go look for your typos)<br>
Python says that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
        \left( \frac{p_6}{q_6} \right)^2 - 2 = \frac{1}{1236510294063800469693771621893337765354742124544}.
    \end{equation*}\]</div>
<p>That’s about <span class="math notranslate nohighlight">\(8.0\times 10^{-49}\)</span>, not the <span class="math notranslate nohighlight">\(-4.4\times 10^{-16}\)</span> from before.  The sign isn’t even the same.  What happened? The puzzles are resolved by thinking about floating-point arithmetic versus exact integer arithmetic.  Write out a paragraph describing your understanding of the differences, and then read the symbolic algebra appendix and the floating-point appendix. <br>
One final point of this exercise: we did not ever compare <code class="docutils literal notranslate"><span class="pre">p3/q3</span></code> to <code class="docutils literal notranslate"><span class="pre">p2/q2</span></code>, or any iterate to its previous one; instead, we tried to decide how good any iterate was (as an approximation to the square root of two) by checking to see how close its square was to two.  This is a kind of error analysis called “backward error analysis” and we will see that it is very useful.</p>
</li>
<li><p><em>Lists</em> in Python.  Lists are enclosed in square brackets, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="c1"># x is a list with just one element, namely the floating-point number 1.0</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="c1"># the first element has index zero; Python counts from 0</span>
</pre></div>
</div>
<p>Type the above two lines into a fresh cell (don’t just copy-and-paste, really type; it’s practice for your fingers).  You don’t have to type the comments (The hashtag and everything after that on each line) but you may.</p>
</li>
<li><p>You can use a single list to store all the numbers <code class="docutils literal notranslate"><span class="pre">x0</span></code>, <code class="docutils literal notranslate"><span class="pre">x1</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, and so on; type these lines in</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span> <span class="c1"># This appends an element to the list &quot;x&quot;  (if the list was called y, you would say y.append( nxt ))</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The list x is &quot;</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The first element of x is &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The second element of x is &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>That doesn’t look very different to using two variables <code class="docutils literal notranslate"><span class="pre">x0</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code>, but it is: we can now automatically increment the indices.</p>
</li>
<li><p>Type in the following and execute them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="c1"># We reproduce our iteration using the list and indices into the list so we don&#39;t have new variable names</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The list x is &quot;</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The fifth element of x is &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The sixth element of x is &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The seventh element of x is &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><em>Loops at last</em> Type in the following and execute it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">nxt</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># We don&#39;t really need &quot;nxt&quot; but it&#39;s a little more readable this way</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nxt</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
</pre></div>
</div>
<p>The indentation is important there.  More concisely, without the extra variable “nxt”,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Write a loop that uses two lists of integers, say <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>, and computes the exact integer numerators and denominators for the first six iterates.  Our answer: When we print <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> we get the following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{gather*}
        [1, 3, 17, 577, 665857, 886731088897, 1572584048032918633353217] \\
        [1, 2, 12, 408, 470832, 627013566048, 1111984844349868137938112]
    \end{gather*}
    \end{split}\]</div>
</li>
<li><p>Which method gives a better approximation to <span class="math notranslate nohighlight">\(\sqrt{73}\)</span>, the <span class="math notranslate nohighlight">\(a + b/(2a)\)</span> formula or the “blending” formula taught in some high schools and mentioned above?</p></li>
<li><p>Which method would be easier to teach to high school students, do you think?  Why do you think so?</p></li>
<li><p>Write a Python program that plots the Gauss map on a <em>torus</em>.  Think of it as wrapping the top and bottom of the unit square around a cylinder, and then bending the cylinder around to make a torus.  Compare to the graph on the cover of the March 1992 issue of the American Mathematical Monthly, that is, Volume 99, no. 3.</p></li>
</ol>
</div>
<div class="section" id="open-problems-big-projects">
<h2>Open Problems/Big Projects<a class="headerlink" href="#open-problems-big-projects" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>math wasn’t invented or discovered, math was manifested</p>
<p class="attribution">—<a class="reference external" href="https://twitter.com/djmansib/status/1486205992140476417?s=20&amp;t=JJ1YOr3N2adjFCBubzwiew">Mansi Bezbaruah</a></p>
</div></blockquote>
<ol class="simple">
<li><p>Open the Online Encyclopedia of Integer Sequences, and choose a sequence to work with (say, <a class="reference external" href="http://oeis.org/A010060">The Thue–Morse sequence A010060</a>.  Turn it into a continued fraction any way you like (e.g. make a decimal out of the sequence and compute its continued fraction; but do as you please!).  Discover something about that continued fraction. Do not, and we repeat, do not get distracted and explore the OEIS for its own sake.  Really, don’t do that. Wait! Stop! Come back!</p></li>
<li><p>Are the elements (partial quotients) in the CF for Stark’s number bounded?  Some references: <a class="reference external" href="https://doi.org/10.1007/3-540-61581-4_39">A paper on algorithms to compute continued fractions</a> and <a class="reference external" href="http://www.numericana.com/answer/fractions.htm">a page of Arcana including Continued Fractions</a>.</p></li>
<li><p>Is there any pattern in the simple continued fraction for <span class="math notranslate nohighlight">\(\pi\)</span>?</p></li>
<li><p>What can you say about continued fractions of bounded height?</p></li>
<li><p>Implement a “rounded rational” arithmetic package (in whatever language you like). Try to give an “IEEE-like” guarantee:
rr<span class="math notranslate nohighlight">\((a\ op\ b) = (a\ op\ b)(1 + \delta)\)</span> where <span class="math notranslate nohighlight">\(\left|\delta\right|\)</span> is as small as possible given the restriction.  RMC did this years ago in a now-vanished language (which might come back).  You can find that source code in Chapter 22 of <a class="reference external" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.196.3360&amp;rep=rep1&amp;type=pdf">The Aldor Manual</a>.</p></li>
<li><p>Does the continued fraction for <a class="reference external" href="https://en.wikipedia.org/wiki/Khinchin%27s_constant">Khinchin’s constant</a> follow the Gauss–Kuzmin distribution? It’s a pretty puzzle to compute the constant quickly, by the way. See <a class="reference external" href="http://oeis.org/A002210">http://oeis.org/A002210</a>.</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-b6d75996-e889-4a15-bfea-c91a063b6da6">
<span class="eqno">(30)<a class="headerlink" href="#equation-b6d75996-e889-4a15-bfea-c91a063b6da6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
K = \prod_{k\ge 1} \left( 1 + \frac{1}{k(k+2)}\right)^{\log_2 k} \approx 2.685452001\ldots
\end{equation}\]</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Here, <span class="math notranslate nohighlight">\(x_0 = 1\)</span>, <span class="math notranslate nohighlight">\(x_1 = \frac{3}{2}\)</span>, so on and so forth.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>In English as opposed to mathematics, zero is not a number. If we say that, we have a number of things to talk about, we don’t mean there’s nothing to say!</p>
</dd>
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Avogadro’s number is <span class="math notranslate nohighlight">\(6.022\cdot 10^{23}\)</span>, about.</p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>There is for sure a possibility that you will doubt this, at this moment. No proof will be provided here just yet, because not everyone likes proofs.</p>
</dd>
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Except when we subtract 7 from 7.000 we got—<span class="math notranslate nohighlight">\(1.40\cdot10^{-8}\)</span>, not zero! So the 7 for <span class="math notranslate nohighlight">\(B\)</span> should have been 6, the game <em>didn’t</em> stop, and <span class="math notranslate nohighlight">\(C\)</span> gets something that displays as <span class="math notranslate nohighlight">\(1.000\)</span>, take <span class="math notranslate nohighlight">\(\boxed{1}\)</span>, and the fractional part is <span class="math notranslate nohighlight">\(1.400\cdot10^{-10}\)</span>. <em>oops</em>.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Contents"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../preamble.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Preamble</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="rootfinding.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Rootfinding, Newton’s Method, and Dynamical Systems</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Neil J. Calkin, Eunice Y.S. Chan, and Robert M. Corless<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>